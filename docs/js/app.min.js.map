{"version":3,"sources":["docs/js/app.js","../../src/app/gtm/gtm.service.js","../../src/app/advanced-search/advanced-search.controller.js","../../src/app/collections/collections-01.controller.js","../../src/app/collections/collections.controller.js","../../src/app/contacts/contacts.controller.js","../../src/app/directives/appear.directive.js","../../src/app/directives/has-dropdown.directive.js","../../src/app/directives/autocomplete.directive.js","../../src/app/directives/cookies.directive.js","../../src/app/directives/glsl-canvas.directive.js","../../src/app/shared/shader.js","../../src/app/directives/hilight.directive.js","../../src/app/directives/href.directive.js","../../src/app/directives/last-item.directive.js","../../src/app/directives/lazy-script.directive.js","../../src/app/shared/rect.js","../../src/app/directives/lazy.directive.js","../../src/app/directives/media.directive.js","../../src/app/directives/muuri.directive.js","../../src/app/directives/object-fit.directive.js","../../src/app/directives/over-on.directive.js","../../src/app/directives/parallax.directive.js","../../src/app/directives/scroll-to.directive.js","../../src/app/directives/scroll.directive.js","../../src/app/directives/sticky.directive.js","../../src/app/directives/swiper.directive.js","../../src/app/directives/thron.directive.js","../../src/app/directives/video.directive.js","../../src/app/directives/visibility.directive.js","../../src/app/directives/wishlist.directive.js","../../src/app/directives/world.directive.js","../../src/app/directives/zoomable.directive.js","../../src/app/effects/effects.controller.js","../../src/app/faq/faq.controller.js","../../src/app/forms/control-messages.directive.js","../../src/app/forms/control.directive.js","../../src/app/forms/validate.directive.js","../../src/app/galleries/galleries.controller.js","../../src/app/gtm/gtm-collection.directive.js","../../src/app/gtm/gtm-dealerlocator.directive.js","../../src/app/gtm/gtm-form.directive.js","../../src/app/services/dom.service.js","../../src/app/highway/custom-renderer.js","../../src/app/highway/page-transition.js","../../src/app/highway/highway.directive.js","../../src/app/magazine/magazine.controller.js","../../src/app/moodboard/moodboard-dropdown.directive.js","../../src/app/moodboard/moodboard-search.directive.js","../../src/app/moodboard/moodboard-section.controller.js","../../src/app/moodboard/moodboard.controller.js","../../src/app/news/news.controller.js","../../src/app/references/references.controller.js","../../src/app/root.controller.js","../../src/app/services/api.service.js","../../src/app/services/wishlist.service.js","../../src/app/shared/location.service.js","../../src/app/shared/promise.service.js","../../src/app/shared/state.service.js","../../src/app/shared/storage.service.js","../../src/app/store-locator/store-locator.controller.js","../../src/app/store-locator/stores.controller.js","../../src/app/wishlist/wishlist.controller.js","../../src/app/app.module.js","../../src/app/filters/image-with-features.filter.js","../../src/app/filters/notIn.filter.js","../../src/app/filters/trusted.filter.js","../../src/app/app.bootstrap.js"],"names":["global","factory","exports","module","require","define","amd","self","rxjs","operators","Highway","this","hasOwnProperty","GtmService","pageView","pathname","obj","event","title","document","href","window","location","hostname","Object","assign","dataLayerData","push_","pageViewFilters","cat","filters","values","any","_loop","key","textValue","filterValue","value","selectedOption","options","find","option","name","encodeURIComponent","push","join","console","log","dataLayer","FILTERS_SCRIPT_ID","AdvancedSearchCtrl","$scope","$timeout","LocationService","ApiService","locationService","apiService","filteredItems","selectedFilters","items","initialFilters","deserializeFilters","applyFilters","_proto","prototype","locationFilters","deserialize","forEach","filter","doFilter","item","features","indexOf","o","Boolean","placeholder","label","serializeFilters","serialize","_this","x","length","map","minimals","concat","minimal","slice","visibleItems","maxItems","updateFilterStates","brands","_this2","has","_iterator","_isArray","Array","isArray","_i","Symbol","iterator","_ref","next","done","_iterator2","_isArray2","_i2","_ref2","disabled","setFilter","$broadcast","removeFilter","removeAll","onScroll","_this3","rect","bottom","windowRect","busy","$inject","Collections01Ctrl","test","initialFilter","keys","id","unshift","_this$getFilteredBran","getFilteredBrands","filteredBrands","resultCounts","totalCounts","brand","collections","collection","size","Math","floor","random","getSortedPattern","getSortedSize","sort","a","b","order","sorted","i","splice","shift","skipFilter","_this4","filteredCollections","_this5","_this5$getFilteredBra","apply","CollectionsCtrl","reduce","total","looks","look","ContactsCtrl","$location","$http","StateService","data","model","search","email","state","getState","ready","setProvinces","provinces","idstato","country","onSubmit","post","datamodel","then","success","$emit","error","onInvalid","AppearDirective","DomService","domService","restrict","link","scope","element","attributes","controller","node","matchMedia","matches","classList","add","section","getSection","index","call","querySelectorAll","subscription","appear$","subscribe","left","y","innerWidth","setTimeout","onBeforePrint","unsubscribe","addEventListener","$on","removeEventListener","parentNode","p","contains","HasDropdownDirective","uid","dropDownUid","opened","consumer","undefined","hasDropdownConsumer","$eval","trigger","hasDropdown","querySelector","onClick","openDropdown","closeDropdown","onDocumentClick","target","$watch","remove","addDocumentListeners","dropdown","onDroppedIn","removeDocumentListeners","onDroppedOut","AutocompleteDirective","handler","onSetItem","onRemoveItem","template","input","autocomplete","query","initialFocus","setItem","removeItem","onChange","results","toLowerCase","$parent","onClickInput","stopPropagation","CookiesDirective","StorageService","storage","get","onAcceptCookies","set","TweenMax","to","ease","Power2","easeInOut","delay","onComplete","GlslCanvasDirective","canvas","GlslCanvas","fragmentString","setTexture","glslCanvas","repeat","setUniform","withVideo","tween","pow","onOver","kill","Expo","easeOut","overwrite","onUpdate","onOut","raf$","scroll","scrollY","scrollTop","on","destroy","HilightDirective","hilight","update","innerHTML","substring","current","previous","HrefDirective","routerDisabled","getAttribute","getDomain","text","match","getMarket","LastItemDirective","$last","LazyScriptDirective","src","fetch","mode","response","code","Function","Rect","top","right","width","height","intersectRect","r1","r2","fromNode","rect_","getClientRects","boundingRect","getBoundingClientRect","setCenter","center","intersect","intersection","intersection_","dx","abs","dy","intersection___","min","LazyDirective","srcset","backgroundSrc","image","immediate","onAppearsInViewport","getThronSrc","removeAttribute","splitted","split","offsetWidth","toString","substr","setAttribute","onImagePreload","srcOrUndefined","setStyle","lazy$","rafAndRect$","pipe","datas","callback","onload","onerror","e","imageurl","pageurl","MediaDirective","WishlistService","wishlistService","transclude","img","pageTitle","onPin","preventDefault","pin","url","media","description","wish_name","coId","wish_type","typeName","type","PinUtils","pinOne","wishlistActive","wishlistActivated","wishlistDeactivated","onClickWishlist","toggle","onOverlay","btnGallery","nextElementSibling","itemNode","hasAttribute","wishlist","eval","video","sources","poster","$root","gallery","click","string","MuuriDirective","muuri","slide","onMuuri","previousItems","getItems","getElement","newItems","removeItems","Muuri","layoutDuration","layoutEasing","layout","fillGaps","horizontal","alignRight","alignBottom","rounding","addClass","edgeVersion","navigator","userAgent","edgePartialSupport","parseInt","hasSupport","documentElement","style","ObjectFitDirective","polyfill","nodeName","objectFit","complete","readyState","fit","dataset","position","objectPosition","checkParentContainer","checkMediaProperties","clientWidth","clientHeight","setPosition","marginTop","marginLeft","styles","getComputedStyle","getPropertyValue","overflow","display","className","constraints","max-width","max-height","min-width","min-height","margin-top","margin-right","margin-bottom","margin-left","property","axis","other","start","end","side","OverOnDirective","selector","overOn","ParallaxDirective","units","decimals","round","parallax$","parallax","max","distinctUntilChanged","s","ScrollToDirective","scrollTo","Number","offset","behavior","off","ScrollDirective","scrollIntersection$","differs","$event","StickyDirective","content","traverseUp","scroll$","stickyTop","sticky","tap","scroll$_","maxTop","_defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","_createClass","Constructor","protoProps","staticProps","_inheritsLoose","subClass","superClass","create","constructor","__proto__","DEFAULT_SWIPER_OPTIONS","slidesPerView","spaceBetween","centeredSlides","loop","loopAdditionalSlides","speed","autoplay","keyboardControl","mousewheelControl","onSlideClick","swiper","angular","clickedSlide","clicked","$index","pagination","el","clickable","navigation","nextEl","prevEl","keyboard","enabled","onlyInViewport","SwiperDirective","opacity","onSwiper","onResize","linked","from","swiper_","init","swiperDirectiveInit","noLoop","Swiper","_opening","SwiperGalleryDirective","_SwiperDirective","params","zoomed","initialSlide","slideTo","SwiperHeroDirective","_SwiperDirective2","element_","scope_","toggleVideo","slideChangeTransitionStart","slideChangeTransitionEnd","checkAutoplay","_proto3","play","pause","realIndex","slides","slideNext","SwiperFocusDirective","_SwiperDirective3","_this6","container","$el","tab","slideChange","activeIndex","tabs","currentTarget","SwiperProjectsDirective","_SwiperDirective4","_this7","SwiperReferencesDirective","_SwiperDirective5","_this8","SwiperTileDirective","_SwiperDirective6","_this9","dynamicBullets","SwiperTimelineDirective","_SwiperDirective7","_this10","ID","ThronDirective","THRON","THRONContentExperience","THRONPlayer","player","muted","displayLinked","noSkin","onReady","mediaContainer","onCanPlay","onPlaying","qualities","qualityLevels","highestQuality","currentQuality","status","playing","VideoDirective","progress","paused","onPlay","onPlayGtm","video_name","onPause","onEnded","onTimeUpdate","strokeDashoffset","currentTime","duration","onClickZoom","VisibilityDirective","firstVisibility$","visible","gtmEvent","visibility","classes","WishlistDirective","WorldDirective","nodePoints","stopImmediatePropagation","offices","w","h","offsetHeight","latitude","longitude","pointNode","makePoint","appendChild","point","createElement","headquarter","cta","BOMLabels","More_info","city","abstract","ZoomableDirective","triggers","onClose","zoomOut","zoomIn","addListeners","close","$id","onZoom","zoomInAnimated","zoomOutAnimated","EffectsCtrl","collectionsUrl","track","navToCollections","serialized","serialize_","queryhp","FaqCtrl","faqCategories","filteredFaqCategories","flags","Subject","search$","takeUntil","isOpen","flag","maxHeight","navTo","category","slug","fromEvent","debounceTime","fakeFilter","","hasTitle","hasAbstract","shareReplay","ControlMessagesDirective","templateUrl","message","uniqueId","errorElements","ControlDirective","$parse","control","ngModel","required","form","source","pre","linkMethod","optionLabel","prepend","expression","formatted","formatLabel","getOptions","number","field","replace","format","precision","validate","minLength","maxLength","POSITIVE_INFINITY","focus","onFilter","getType","onFocus","onBlur","scrollToError","getClasses","$valid","$invalid","$submitted","$touched","empty","$viewValue","onError","getMessages","$error","toggleVisibility","clearTimeout","array","ValidateDirective","$filter","$formatters","$parsers","valid","String","$setValidity","$modelValue","$setViewValue","doBlur","GalleriesCtrl","galleries","getFilteredItems","GtmCollectionDirective","actionField","list","product","ecommerce","products","gtmDealerLocatorDirective","action","GtmFormDirective","form_name","c","elem","contactType","contactTypes","_","contactReason","contactReasons","qualification","qualifica","secondaryScroll$_","result","traverseDown","nodeType","j","t","childNodes","hasWebglSupport","isIE","hasWebgl","ua","msie","rv","edge","getOuterHeight","computedStyle","marginBottom","borderTopWidth","borderBottomWidth","getOuterWidth","marginRight","borderLeftWidth","borderRightWidth","windowRect$","secondaryScroll$","scrollAndRect$","smoothScroll$","friction","body","outerHeight","nodeTop","rafIntersection$","rafIntersection_","scrollIntersection_","first","visibility$","addCustomRules","sheet","addCustomSheet","scrollBarWidth","rule","insertRule","createTextNode","head","getScrollTop","scrollingElement","pageYOffset","getScrollLeft","pageXOffset","scrollX","scrollLeft","interval","animationFrameScheduler","innerHeight","originalEvent","startWith","combineLatest","mainScroll$","previousTop","direction","merge","auditTime","diff","CustomRenderer","_Highway$Renderer","arguments","updateMeta","updateGTMData","updateBrand","updateSearchQuery","updateMarketsAndLanguages","page","properties","exec","root","dataSearch","marketSelector","getElementById","marketUrls","fromJson","script","onEnter","$compile","view","pop","menuOpened","menuProductOpened","$newScope","$new","onLeave","onEnterCompleted","onLeaveCompleted","$destroy","collectScopes","scopes","child","$$childHead","$$nextSibling","Renderer","PageTransition","_Highway$Transition","in","loader","minHeight","origin","scale","transformOrigin","clearProps","addthis","layers","refresh","out","headerMenu","HTMLElement","Transition","HighwayDirective","link$","onLink$","wasProduct","onProductMenu","sectionProduct","anchors","selectedAnchor","lastIndexOf","H","Core","renderers","transitions","detach","links","attach","cache","firstView","MagazineCtrl","magazine","MoodboardDropdownDirective","MoodboardSearchDirective","html","innerText","contents","animateUnderlines","animateOff","animated","scaleX","animate","u","Power3","MoodboardSectionCtrl","q","getSerialization","MOOD_TYPES","freeze","Tile","Horizontal","Vertical","Card","Decor","MoodboardCtrl","moodTypes","me","anyFilter","v","moodboard","NewsCtrl","news","categoryId","year","ReferencesCtrl","references","countryId","filteredReferences","RootCtrl","count$","count","wishlistCount","onSearch","searchOpened","scrolled","droppedIn","onInit","webglEnabled","droppinIn","closeNav","openNav","nav","toggleNav","Promise","resolve","reject","mh","staggerTo","stagger","toggleBrand","toggleMenuProduct","pad","hasHash","hash","API_DEV","port","host","API_HREF","http","api","advancedSearch","added","clearAll","storeLocator","all","PromiseService","promise","make","wishlist_","BehaviorSubject","keyOrValue","deserialize_","json","atob","JSON","parse","stringify","btoa","$q","deferred","defer","promises","State","$rootScope","idle","isBusy","isError","isErroring","isSuccess","isSuccessing","button","errors","addons","isReady","successing","errorring","errorMessage","labels","defaults","extend","submitClass","CookieService","delete","setter","exist","cookie","cookieName","ca","charAt","decodeURIComponent","elapsed","checkCookie","days","expires","date","Date","setTime","getTime","toGMTString","LocalStorageService","_proto2","localStorage","newValue","isLocalStorageSupported","supported","SessionStorageService","sessionStorage","isSessionStorageSupported","localsessionStorageStorage","GOOGLE_MAPS","StoreLocatorCtrl","apiKey","busyFind","busyLocation","visibleStores","mapBoundsChanged$","initMap","onGoogleMapsLoaded","google","maps","getElementsByTagName","bounds","findNearStores","stores","getCenter","mapOptions","zoom","LatLng","featureType","elementType","stylers","color","saturation","lightness","mapElement","Map","addListener","getBounds","calculateDistance","lat1","lon1","lat2","lon2","unit","radlat1","PI","radlat2","theta","radtheta","dist","sin","cos","acos","addMarkers","markers","store","address","zip","citta","cod_provincia","stato","store_locator_approx","distance","lat","lng","store_locator_reach_store","tel","webSite","marker","Marker","icon","importante","setMarkerWindow","scrollToStore","markerCluster","MarkerClusterer","imagePath","getStyles","textColor","setStyles","getGeolocation","geolocation","getCurrentPosition","coords","setInfoWindow","searchPosition","finally","setZoom","loadStoresByPosition","loadAllStores","fitBounds","LatLngBounds","northEast","getNorthEast","meters","geometry","spherical","computeDistanceBetween","removed","addMarker","removeMarker","panTo","geocoder","Geocoder","geocode","viewport","markerWindow","InfoWindow","pixelOffset","Size","setContent","open","storesNode","storeNode","id_SF","offsetTop","StoresCtrl","filteredStores","WishlistCtrl","load","print","app","config","$locationProvider","html5Mode","hashPrefix","$compileProvider","debugInfoEnabled","directive","images","f","$sce","trustAsResourceUrl","run","cloneNode","bootstrap"],"mappings":"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","file":"docs/js/app.min.js","sourcesContent":[null,"export default class GtmService {\n\t// Id da dare al tag script delle pagine con filtri.\n\t// Questo indica a Highway di non eseguire il PageView. Sarà il controller a farlo\n\n\tstatic pageView(pathname) {\n\n\t\tconst obj = {\n\t\t\tevent: 'PageViewCustomEvent',\n\t\t\ttitle: document.title,\n\t\t\thref: window.location.href,\n\t\t\tpathname: pathname || window.location.pathname,\n\t\t\thostname: window.location.hostname,\n\t\t};\n\n\t\tObject.assign(obj, window.dataLayerData);\n\n\t\treturn GtmService.push_(obj);\n\t}\n\n\tstatic pageViewFilters(cat, filters) {\n\n\t\tconst values = [];\n\t\tlet any = false;\n\n\t\tfor (let key in filters) {\n\t\t\tlet textValue = '';\n\n\t\t\tconst filterValue = filters[key].value;\n\t\t\tif (filterValue) {\n\t\t\t\tconst selectedOption = filters[key].options.find(option => option.value === filterValue);\n\t\t\t\tif (selectedOption) {\n\t\t\t\t\ttextValue = selectedOption.key;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (textValue) any = true;\n\n\t\t\tlet name = filters[key].key /* se array di filtri */ || key /* se oggetto filtro */ ;\n\t\t\tif (name) name = encodeURIComponent(name) + '-';\n\t\t\tvalues.push(name + encodeURIComponent(textValue));\n\t\t}\n\n\t\tconst pathname = any ? `?cat=${cat}&s=${values.join('_')}` : '';\n\n\t\tGtmService.pageView(window.location.pathname + pathname);\n\t}\n\n\tstatic push(event) {\n\t\tconsole.log('GtmService.dataLayer', event);\n\t\tconst dataLayer = window.dataLayer || [];\n\t\treturn dataLayer.push(event);\n\t}\n\n}\n\nGtmService.FILTERS_SCRIPT_ID = 'script-listing';\n","//import { of } from \"rxjs\";\n\nexport const ITEMS_PER_PAGE = 20;\n\nimport GtmService from '../gtm/gtm.service';\nconst GTM_CAT = 'ricerca-avanzata';\n\nclass AdvancedSearchCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService,\n\t\tApiService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.apiService = ApiService;\n\t\t//this.items = [];\n\t\tthis.filteredItems = [];\n\t\tthis.filters = window.filters || [];\n\t\tthis.selectedFilters = [];\n\t\tthis.items = window.items || [];\n\t\tthis.initialFilters = window.initialFilters || null;\n\t\tthis.deserializeFilters(this.initialFilters);\n\t\tthis.applyFilters(false);\n\n\t\t// !!!\n\t\t//this.apiService.advancedSearch.get().subscribe(\n\t\t//\t// this.fakeSearch$().subscribe(\n\t\t//\tsuccess => {\n\t\t//\t\tlet items = success.data;\n\t\t//\t\tthis.items = items;\n\t\t//\t\tthis.applyFilters();\n\t\t//\t}\n\t\t//);\n\t}\n\n\tdeserializeFilters() {\n\t\tconst locationFilters = this.locationService.deserialize('filters') || this.initialFilters || {};\n\t\t// console.log('AdvancedSearchCtrl.deserializeFilters', filters);\n\t\tthis.filters.forEach(filter => {\n\t\t\t//if (filter.type === 'minimal') {\n\t\t\t//\tfilter.doFilter = (item, value) => {\n\t\t\t//\t\tlet has = false;\n\t\t\t//\t\t(item.minimals || [item]).forEach(x => {\n\t\t\t//\t\t\thas = has || x.features.indexOf(value) !== -1;\n\t\t\t//\t\t});\n\t\t\t//\t\treturn has;\n\t\t\t//\t};\n\t\t\t//} else {\n\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\treturn item.features.indexOf(value) !== -1;\n\t\t\t};\n\t\t\t//}\n\t\t\t//switch (filter.key) {\n\t\t\t//\tcase 'finish':\n\t\t\t//\t\tfilter.doFilter = (item, value) => {\n\t\t\t//\t\t\tlet has = false;\n\t\t\t//\t\t\tconst size = this.filters.find(x => x.key == 'size' && x.value !== null);\n\t\t\t//\t\t\titem.minimals.forEach(x => {\n\t\t\t//\t\t\t\thas = has || (x.finish.id === value && (!size || x.size.id === size.value));\n\t\t\t//\t\t\t});\n\t\t\t//\t\t\treturn has;\n\t\t\t//\t\t};\n\t\t\t//\t\tbreak;\n\t\t\t//\tcase 'size':\n\t\t\t//\t\tfilter.doFilter = (item, value) => {\n\t\t\t//\t\t\tlet has = false;\n\t\t\t//\t\t\tconst finish = this.filters.find(x => x.key == 'finish' && x.value !== null);\n\t\t\t//\t\t\titem.minimals.forEach(x => {\n\t\t\t//\t\t\t\thas = has || (x.size.id === value && (!finish || x.finish.id === finish.value));\n\t\t\t//\t\t\t});\n\t\t\t//\t\t\treturn has;\n\t\t\t//\t\t};\n\t\t\t//\t\tbreak;\n\t\t\t//\tdefault:\n\t\t\t//\t\tfilter.doFilter = (item, value) => {\n\t\t\t//\t\t\treturn item.features.indexOf(value) !== -1;\n\t\t\t//\t\t};\n\t\t\t//}\n\t\t\t/*\n\t\t\tfilter.options.unshift({\n\t\t\t\tlabel: filter.placeholder,\n\t\t\t\tvalue: null,\n\t\t\t});\n\t\t\t*/\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[filter.key] || null)));\n\t\t\tif (selectedOption) {\n\t\t\t\tfilter.value = selectedOption.value;\n\t\t\t\tfilter.placeholder = selectedOption.label;\n\t\t\t} else {\n\t\t\t\tfilter.value = null;\n\t\t\t\tfilter.placeholder = null;\n\t\t\t}\n\t\t\t// console.log(x, filters[x], filter.value);\n\t\t});\n\t\treturn this.filters;\n\t}\n\n\tserializeFilters() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tthis.filters.forEach(filter => {\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[filter.key] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\t// console.log('AdvancedSearchCtrl.serializeFilters', filters);\n\t\tthis.locationService.serialize('filters', filters);\n\t\treturn filters;\n\t}\n\n\tapplyFilters(serialize) {\n\t\t// console.log('AdvancedSearchCtrl.applyFilters', this.filters);\n\t\tif (serialize !== false) this.serializeFilters();\n\t\tconst selectedFilters = this.filters.filter(x => x.value !== null);\n\t\t//const finishFilter = this.filters.find(x => x.key == 'finish' && x.value !== null);\n\t\t//const sizeFilter = this.filters.find(x => x.key == 'size' && x.value !== null);\n\t\tlet filteredItems;\n\t\tif (selectedFilters.length) {\n\t\t\tfilteredItems = this.items\n\t\t\t\t.map(x => {\n\t\t\t\t\t// duplico i prodotti e minimal\n\t\t\t\t\tconst item = Object.assign({}, x);\n\t\t\t\t\titem.minimals = [...x.minimals];\n\t\t\t\t\treturn item;\n\t\t\t\t})\n\t\t\t\t.filter(item => {\n\t\t\t\t\t// filtro tutti i minimal con tutti i filtri contemporeamente\n\t\t\t\t\tselectedFilters.forEach(filter => {\n\t\t\t\t\t\titem.minimals = item.minimals.filter(minimal => {\n\t\t\t\t\t\t\treturn filter.doFilter(minimal, filter.value);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\treturn item.minimals.length > 0;\n\t\t\t\t})\n\t\t\t//item.minimals = item.minimals.filter(x => {\n\t\t\t//\tlet has = true;\n\t\t\t//\thas = has && (!finishFilter || x.finish.id === finishFilter.value) && (!sizeFilter || x.size.id === sizeFilter.value);\n\t\t\t//\treturn has;\n\t\t\t//});\n\t\t} else {\n\t\t\tfilteredItems = this.items.slice();\n\t\t}\n\t\tthis.selectedFilters = selectedFilters;\n\t\tthis.filteredItems = [];\n\t\tthis.visibleItems = [];\n\t\tthis.maxItems = ITEMS_PER_PAGE;\n\t\tthis.$timeout(() => {\n\t\t\tthis.filteredItems = filteredItems;\n\t\t\tthis.visibleItems = filteredItems.slice(0, this.maxItems);\n\t\t\tthis.updateFilterStates(filteredItems);\n\t\t}, 50);\n\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\n\t}\n\n\tupdateFilterStates(brands) {\n\n\t\tthis.filters.forEach(filter => {\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tlet has = false;\n\t\t\t\tif (option.value) {\n\n\t\t\t\t\tfor (const item of this.filteredItems) {\n\t\t\t\t\t\tfor (const minimal of item.minimals) {\n\t\t\t\t\t\t\tif (filter.doFilter(minimal, option.value)) {\n\t\t\t\t\t\t\t\thas = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (has) break;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thas = true;\n\t\t\t\t}\n\n\t\t\t\toption.disabled = !has;\n\t\t\t});\n\t\t\t// console.log(filter.options);\n\t\t});\n\t}\n\n\tsetFilter(item, filter) {\n\t\tfilter.value = item.value;\n\t\tfilter.placeholder = item.label;\n\t\tthis.applyFilters();\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t}\n\n\tremoveFilter(filter) {\n\t\tfilter.value = null;\n\t\tfilter.placeholder = null;\n\t\tthis.applyFilters();\n\t}\n\n\tremoveAll() {\n\t\tthis.filters.forEach(filter => {\n\t\t\tfilter.value = null;\n\t\t\tfilter.placeholder = null;\n\t\t});\n\t\tthis.applyFilters();\n\t}\n\n\tonScroll(event) {\n\t\tif (event.rect.bottom < event.windowRect.bottom) {\n\t\t\t// console.log('more!');\n\t\t\tif (!this.busy && this.maxItems < this.filteredItems.length) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tthis.busy = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tthis.maxItems += ITEMS_PER_PAGE;\n\t\t\t\t\t\tthis.visibleItems = this.filteredItems.slice(0, this.maxItems);\n\t\t\t\t\t\tthis.busy = false;\n\t\t\t\t\t\t// console.log(this.visibleItems.length);\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\t//fakeSearch$(count = 2000) {\n\t//\tconst items = [];\n\t//\tconst collections = ['Marvel Dream', 'Marvel Edge', 'Boost'];\n\t//\tconst tiles = ['Imperial White', 'Royal Calacatta', 'Elegant Sable', 'Gris Supreme', 'Absolute Brown', 'Agata Azul', 'Gold Onyx', 'Red Luxury', 'Gris Clair'];\n\t//\tconst finishes = this.filters.find(x => x.key === 'finish').options;\n\t//\tconst sizes = this.filters.find(x => x.key === 'size').options;\n\t//\tlet UID = 1;\n\t//\twhile (items.length < count) {\n\t//\t\tconst collectionIndex = Math.floor(Math.random() * collections.length);\n\t//\t\tconst collectionName = collections[collectionIndex];\n\t//\t\tconst tileIndex = Math.floor(Math.random() * tiles.length);\n\t//\t\tconst tileName = tiles[tileIndex];\n\t//\t\tconst tileImage = `img/advanced-search/tile-0${tileIndex+1}.jpg`;\n\t//\t\tconst minimals = [];\n\t//\t\tconst count = 1 + Math.floor(Math.random() * 15);\n\t//\t\twhile (minimals.length < count) {\n\t//\t\t\tconst finish = finishes[Math.floor(Math.random() * finishes.length)];\n\t//\t\t\tconst size = sizes[Math.floor(Math.random() * sizes.length)];\n\t//\t\t\tminimals.push({\n\t//\t\t\t\tid: minimals.length + 1,\n\t//\t\t\t\turl: '#',\n\t//\t\t\t\tfinish: {\n\t//\t\t\t\t\tid: finish.value,\n\t//\t\t\t\t\tname: finish.label\n\t//\t\t\t\t},\n\t//\t\t\t\tsize: {\n\t//\t\t\t\t\tid: size.value,\n\t//\t\t\t\t\tname: size.label\n\t//\t\t\t\t},\n\t//\t\t\t});\n\t//\t\t}\n\t//\t\tconst features = [];\n\t//\t\tthis.filters.forEach(filter => {\n\t//\t\t\tif (filter.key !== 'finish' && filter.key !== 'size') {\n\t//\t\t\t\tfeatures.push(filter.options[Math.floor(Math.random() * filter.options.length)].value);\n\t//\t\t\t}\n\t//\t\t});\n\t//\t\titems.push({\n\t//\t\t\tid: UID++,\n\t//\t\t\tcollection: {\n\t//\t\t\t\tid: collectionIndex + 1,\n\t//\t\t\t\tname: collectionName,\n\t//\t\t\t},\n\t//\t\t\ttile: {\n\t//\t\t\t\tid: tileIndex + 1,\n\t//\t\t\t\tname: tileName,\n\t//\t\t\t\timage: tileImage\n\t//\t\t\t},\n\t//\t\t\tminimals,\n\t//\t\t\tfeatures,\n\t//\t\t});\n\t//\t}\n\t//\t// console.log(JSON.stringify(items));\n\t//\treturn of({ data: items });\n\t//}\n}\n\nAdvancedSearchCtrl.$inject = ['$scope', '$timeout', 'LocationService', 'ApiService'];\n\nexport default AdvancedSearchCtrl;\n","import GtmService from '../gtm/gtm.service';\nconst GTM_CAT = 'collezioni';\n\nclass Collections01Ctrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.filters = window.filters || {};\n\t\tthis.brands = window.brands || [];\n\t\tthis.initialFilters = window.initialFilters || null;\n\t\tthis.deserializeFilters(this.initialFilters);\n\t\tthis.applyFilters(false);\n\t\t// this.filteredReferences = this.references.slice();\n\t\t// this.updateFilterStates();\n\t\t// console.log(this.filters);\n\t\t// console.log(this.brands);\n\t}\n\n\ttest() {\n\t\tthis.test = true;\n\t\tthis.applyFilters(false);\n\t}\n\n\tdeserializeFilters(initialFilter) {\n\t\tconst locationFilters = this.locationService.deserialize('filters') || initialFilter || {};\n\t\t// console.log('CollectionsCtrl.deserializeFilters', filters);\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tswitch (x) {\n\t\t\t\tcase 'collections':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.id === value;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.features.indexOf(value) !== -1;\n\t\t\t\t\t};\n\t\t\t}\n\t\t\tfilter.options.unshift({\n\t\t\t\tlabel: filter.placeholder,\n\t\t\t\tvalue: null,\n\t\t\t});\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[x] || null)));\n\t\t\tfilter.value = selectedOption.value;\n\t\t\tfilter.placeholder = selectedOption.label;\n\t\t});\n\t\treturn filters;\n\t}\n\n\tserializeFilters() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[x] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\t// console.log('CollectionsCtrl.serializeFilters', filters);\n\t\tthis.locationService.serialize('filters', filters);\n\t\treturn filters;\n\t}\n\n\tapplyFilters(serialize) {\n\t\t/*\n\t\tconst filters = Object.keys(this.filters).map((x) => {\n\t\t\treturn Object.assign({ type: x }, this.filters[x]);\n\t\t}).filter(x => x.value !== null);\n\t\t*/\n\t\tif (serialize !== false) this.serializeFilters();\n\t\tconst { filteredBrands, resultCounts, totalCounts } = this.getFilteredBrands();\n\t\t// console.log(filteredBrands, filters);\n\t\tif (this.test) {\n\t\t\tfilteredBrands.forEach(brand => brand.collections.forEach(collection => {\n\t\t\t\tcollection.size = (1 + Math.floor(Math.random() * 6));\n\t\t\t\tif (collection.size < 4) {\n\t\t\t\t\tcollection.size = 1;\n\t\t\t\t} else if (collection.size < 6) {\n\t\t\t\t\tcollection.size = 2;\n\t\t\t\t} else {\n\t\t\t\t\tcollection.size = 3;\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\t/*\n\t\tconst order = [3, 2, 2, 1, 1, 1];\n\t\tlet i = 0;\n\t\tfilteredBrands.forEach(brand => {\n\t\t\tbrand.collections.sort((a, b) => {\n\t\t\t\tconst size = order[i % order.length];\n\t\t\t\tconsole.log(size);\n\t\t\t\tif (a.size === size) {\n\t\t\t\t\ti++;\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\tif (b.size === size) {\n\t\t\t\t\ti++;\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t\t// console.log(brand.collections.map(x => x.size).join(','));\n\t\t});\n\t\t*/\n\n\t\tfilteredBrands.forEach(brand => {\n\t\t\tbrand.collections = this.getSortedPattern(brand.collections);\n\t\t});\n\n\t\tthis.filteredBrands = [];\n\t\tthis.$timeout(() => {\n\t\t\tthis.filteredBrands = filteredBrands;\n\t\t\tthis.resultCounts = resultCounts;\n\t\t\tthis.totalCounts = totalCounts;\n\t\t\tthis.updateFilterStates();\n\t\t\t// delayer for image update\n\t\t}, 50);\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\n\t}\n\n\tgetSortedSize(items) {\n\t\titems.sort((a, b) => {\n\t\t\treturn b.size - a.size;\n\t\t});\n\t\t// console.log(items.map(x => x.size).join(','));\n\t\treturn items;\n\t}\n\n\tgetSortedPattern(items) {\n\t\tconst order = [3, 2, 1, 2, 1, 1, 1, 2, 3, 1, 2, 1];\n\t\tlet sorted = [],\n\t\t\ti = 0;\n\t\twhile (items.length) {\n\t\t\tconst size = order[i % order.length];\n\t\t\tconst item = items.find(x => x.size === size);\n\t\t\tif (item) {\n\t\t\t\titems.splice(items.indexOf(item), 1);\n\t\t\t\tsorted.push(item);\n\t\t\t} else {\n\t\t\t\tsorted.push(items.shift());\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\tconsole.log(sorted.map(x => x.size).join(','));\n\t\treturn sorted;\n\t}\n\n\tgetFilteredBrands(skipFilter) {\n\t\tconst filters = Object.keys(this.filters).map((x) => this.filters[x]).filter(x => x.value !== null);\n\t\tconst filteredBrands = filters.length ? [] : this.brands;\n\t\tlet resultCounts = 0,\n\t\t\ttotalCounts = 0;\n\t\tif (filters.length) {\n\t\t\tthis.brands.map(x => Object.assign({}, x)).forEach(brand => {\n\t\t\t\tconst filteredCollections = [];\n\t\t\t\tbrand.collections.forEach(collection => {\n\t\t\t\t\tlet has = true;\n\t\t\t\t\tfilters.forEach(filter => {\n\t\t\t\t\t\tif (filter !== skipFilter) {\n\t\t\t\t\t\t\thas = has && filter.doFilter(collection, filter.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (has) {\n\t\t\t\t\t\tfilteredCollections.push(collection);\n\t\t\t\t\t\tresultCounts++;\n\t\t\t\t\t}\n\t\t\t\t\ttotalCounts++;\n\t\t\t\t});\n\t\t\t\t// console.log(has, collection, filters);\n\t\t\t\tif (filteredCollections.length) {\n\t\t\t\t\tbrand.collections = filteredCollections;\n\t\t\t\t\tfilteredBrands.push(brand);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn { filteredBrands, resultCounts, totalCounts };\n\t}\n\n\tupdateFilterStates() {\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tconst { filteredBrands, resultCounts, totalCounts } = this.getFilteredBrands(filter);\n\t\t\tconst collections = [].concat.apply([], filteredBrands.map(x => x.collections));\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tlet has = false;\n\t\t\t\tif (option.value) {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\twhile (i < collections.length && !has) {\n\t\t\t\t\t\tconst collection = collections[i];\n\t\t\t\t\t\thas = filter.doFilter(collection, option.value);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thas = true;\n\t\t\t\t}\n\t\t\t\toption.disabled = !has;\n\t\t\t});\n\t\t\t// console.log(filter.options);\n\t\t});\n\t}\n\n\tsetFilter(item, filter) {\n\t\titem = item || filter.options[0];\n\t\tfilter.value = item.value;\n\t\tfilter.placeholder = item.label;\n\t\tthis.applyFilters();\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t}\n\n\tremoveFilter(filter) {\n\t\tthis.setFilter(null, filter);\n\t}\n\n}\n\nCollections01Ctrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default Collections01Ctrl;\n","import GtmService from '../gtm/gtm.service';\n\nconst GTM_CAT = 'collezioni';\n\nclass CollectionsCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.filters = window.filters || {};\n\t\tthis.brands = window.brands || [];\n\t\t// sorting alphabetically\n\t\t/*\n\t\tthis.brands.forEach(brand => {\n\t\t\tif (brand.collections) {\n\t\t\t\tbrand.collections.sort(function(a, b) {\n\t\t\t\t\tif (a.title < b.title) { return -1; }\n\t\t\t\t\tif (a.title > b.title) { return 1; }\n\t\t\t\t\treturn 0;\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\t\t*/\n\t\tthis.initialFilters = window.initialFilters || null;\n\t\tthis.deserializeFilters(this.initialFilters);\n\t\tthis.applyFilters(false);\n\t\t// this.filteredReferences = this.references.slice();\n\t\t// this.updateFilterStates();\n\t\t// console.log(this.filters);\n\t\t// console.log(this.brands);\n\t}\n\n\tdeserializeFilters(initialFilter) {\n\t\tconst locationFilters = this.locationService.deserialize('filters') || initialFilter || {};\n\t\t// console.log('CollectionsCtrl.deserializeFilters', filters);\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tswitch (x) {\n\t\t\t\tcase 'collections':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.id === value;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.features.indexOf(value) !== -1;\n\t\t\t\t\t};\n\t\t\t}\n\t\t\tfilter.options.unshift({\n\t\t\t\tlabel: filter.placeholder,\n\t\t\t\tvalue: null,\n\t\t\t});\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[x] || null)));\n\t\t\tfilter.value = selectedOption.value;\n\t\t\tfilter.placeholder = selectedOption.label;\n\t\t});\n\t\treturn filters;\n\t}\n\n\tserializeFilters() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[x] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\t// console.log('CollectionsCtrl.serializeFilters', filters);\n\t\tthis.locationService.serialize('filters', filters);\n\t\treturn filters;\n\t}\n\n\tapplyFilters(serialize) {\n\t\t/*\n\t\tconst filters = Object.keys(this.filters).map((x) => {\n\t\t\treturn Object.assign({ type: x }, this.filters[x]);\n\t\t}).filter(x => x.value !== null);\n\t\t*/\n\t\tif (serialize !== false) this.serializeFilters();\n\t\tconst { filteredBrands, resultCounts, totalCounts } = this.getFilteredBrands();\n\t\t// console.log(filteredBrands, filters);\n\t\tthis.filteredBrands = [];\n\t\tthis.$timeout(() => {\n\t\t\tthis.filteredBrands = filteredBrands;\n\t\t\tthis.resultCounts = resultCounts;\n\t\t\tthis.totalCounts = totalCounts;\n\t\t\tthis.updateFilterStates();\n\t\t\t// delayer for image update\n\t\t}, 50);\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\n\t}\n\n\tgetFilteredBrands(skipFilter) {\n\t\tconst filters = Object.keys(this.filters).map((x) => this.filters[x]).filter(x => x.value !== null);\n\t\tconst filteredBrands = [];\n\t\tlet resultCounts = 0;\n\t\tconst totalCounts = this.brands.reduce((total, brand) => {\n\t\t\treturn total + brand.collections.length;\n\t\t}, 0);\n\t\tconst looks = this.filters.looks.options.filter(x => x.value);\n\t\tthis.brands.map(x => Object.assign({}, x)).forEach(brand => {\n\t\t\tconst collections = [];\n\t\t\tbrand.looks = looks.map(x => {\n\t\t\t\tconst look = Object.assign({}, x);\n\t\t\t\tlook.collections = brand.collections.filter(collection => {\n\t\t\t\t\tlet has = this.filters.looks.doFilter(collection, look.value);\n\t\t\t\t\tfilters.forEach(filter => {\n\t\t\t\t\t\tif (filter !== skipFilter) {\n\t\t\t\t\t\t\thas = has && filter.doFilter(collection, filter.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (has && collections.indexOf(collection) === -1) {\n\t\t\t\t\t\tcollections.push(collection);\n\t\t\t\t\t}\n\t\t\t\t\treturn has;\n\t\t\t\t});\n\t\t\t\treturn look;\n\t\t\t}); // .filter(x => x.collections.length)\n\t\t\t// console.log(has, collection, filters);\n\t\t\tresultCounts += collections.length;\n\t\t\tif (brand.looks.length) {\n\t\t\t\tfilteredBrands.push(brand);\n\t\t\t}\n\t\t});\n\t\treturn { filteredBrands, resultCounts, totalCounts };\n\t}\n\n\tupdateFilterStates() {\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tconst { filteredBrands, resultCounts, totalCounts } = this.getFilteredBrands(filter);\n\t\t\tconst collections = [].concat.apply([], filteredBrands.map(x => x.collections));\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tlet has = false;\n\t\t\t\tif (option.value) {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\twhile (i < collections.length && !has) {\n\t\t\t\t\t\tconst collection = collections[i];\n\t\t\t\t\t\thas = filter.doFilter(collection, option.value);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thas = true;\n\t\t\t\t}\n\t\t\t\toption.disabled = !has;\n\t\t\t});\n\t\t\t// console.log(filter.options);\n\t\t});\n\t}\n\n\tsetFilter(item, filter) {\n\t\titem = item || filter.options[0];\n\t\tfilter.value = item.value;\n\t\tfilter.placeholder = item.label;\n\t\tthis.applyFilters();\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t}\n\n\tremoveFilter(filter) {\n\t\tthis.setFilter(null, filter);\n\t}\n\n}\n\nCollectionsCtrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default CollectionsCtrl;\n","class ContactsCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$location,\n\t\t$timeout,\n\t\t$http,\n\t\tStateService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$location = $location;\n\t\tthis.$timeout = $timeout;\n\t\tthis.$http = $http;\n\t\tthis.data = window.data || {};\n\t\tthis.model = {};\n\t\tif (this.$location.search() && this.$location.search().email) {\n\t\t\tthis.model.email = this.$location.search().email;\n\t\t}\n\t\tthis.state = StateService.getState();\n\t\tthis.state.ready();\n\t}\n\n\tsetProvinces() {\n\t\tthis.$timeout(() => {\n\t\t\tthis.provinces = this.data.provinces.filter(x => x.idstato === this.model.country);\n\t\t});\n\t}\n\n\tonSubmit() {\n\t\tconsole.log('ContactsCtrl.onSubmit', this.model);\n\t\tif (this.state.busy()) {\n\t\t\tthis.$http.post('/WS/wsForms.asmx/SaveForm', { datamodel: this.model }).then(\n\t\t\t\tsuccess => {\n\t\t\t\t\tthis.state.success();\n\t\t\t\t\tthis.$scope.$emit('formsubmit');\n\t\t\t\t},\n\t\t\t\terror => {\n\t\t\t\t\tthis.error = error;\n\t\t\t\t\tthis.state.error(error);\n\t\t\t\t}\n\t\t\t)\n\t\t\t/*.finally(() => {\n\t\t\t\t\t\t\tthis.state.ready();\n\t\t\t\t\t\t})*/\n\t\t\t;\n\t\t\t/*\n\t\t\tthis.$timeout(() => {\n\t\t\t\tthis.state.ready();\n\t\t\t}, 2000);\n\t\t\t*/\n\t\t}\n\t}\n\n\tonInvalid() {\n\t\tthis.$scope.$broadcast('onInvalid');\n\t}\n\n}\n\nContactsCtrl.$inject = ['$scope', '$location', '$timeout', '$http', 'StateService'];\n\nexport default ContactsCtrl;\n","export default class AppearDirective {\n\n\tconstructor(\n\t\tDomService\n\t) {\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tif (window.matchMedia('print').matches) {\n\t\t\treturn node.classList.add('appeared');\n\t\t}\n\n\t\tconst section = this.getSection(node);\n\t\telement.index = [].slice.call(section.querySelectorAll('[appear]')).indexOf(node);\n\t\tconst subscription = this.domService.appear$(node).subscribe(event => { // -0.05\n\t\t\t// console.log(event.rect.top);\n\t\t\tconst rect = event.rect;\n\t\t\tconst x = rect.left;\n\t\t\tconst y = 0; // event.rect.top;\n\t\t\tconst index = Math.floor(y / 320) * Math.floor(window.innerWidth / 320) + Math.floor(x / 320);\n\t\t\tconst timeout = index * 50;\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (node.classList) {\n\t\t\t\t\tnode.classList.add('appeared');\n\t\t\t\t}\n\t\t\t}, timeout); // (i - firstVisibleIndex));\n\t\t\t/*\n\t\t\tif (index > 0) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tnode.classList.add('appeared');\n\t\t\t\t}, timeout); // (i - firstVisibleIndex));\n\t\t\t} else {\n\t\t\t\tnode.classList.add('appeared');\n\t\t\t}\n\t\t\t*/\n\t\t});\n\t\tconst onBeforePrint = () => {\n\t\t\tnode.classList.add('appeared', 'print');\n\t\t\tsubscription.unsubscribe();\n\t\t};\n\t\twindow.addEventListener('beforeprint', onBeforePrint);\n\n\t\tscope.$on('$destroy', () => {\n\t\t\twindow.removeEventListener('beforeprint', onBeforePrint);\n\t\t\tsubscription.unsubscribe();\n\t\t});\n\t}\n\n\tgetSection(node) {\n\t\tlet section = node.parentNode;\n\t\tlet p = node;\n\t\twhile (p) {\n\t\t\tp = p.parentNode;\n\t\t\tif (p && p.classList && p.classList.contains('section')) {\n\t\t\t\tsection = p;\n\t\t\t\tp = null;\n\t\t\t}\n\t\t}\n\t\treturn section;\n\t}\n\n\tstatic factory(DomService) {\n\t\treturn new AppearDirective(DomService);\n\t}\n\n}\n\nAppearDirective.factory.$inject = ['DomService'];\n","export default class HasDropdownDirective {\n\n\tconstructor(\n\t\t$timeout\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.restrict = 'A';\n\t\tthis.scope = false;\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst uid = HasDropdownDirective.dropDownUid++;\n\t\tlet opened = null;\n\t\tconst consumer = attributes.hasDropdownConsumer !== undefined ? scope.$eval(attributes.hasDropdownConsumer) : null;\n\t\t// scope.hasDropdown = null;\n\t\t// console.log(attributes.hasDropdown);\n\t\tconst trigger = attributes.hasDropdown !== '' ? node.querySelector(attributes.hasDropdown) : node;\n\t\tconst onClick = (event) => {\n\t\t\t// console.log(trigger, node, attributes.hasDropdown);\n\t\t\tif (opened === null) {\n\t\t\t\topenDropdown();\n\t\t\t} else if (trigger !== node) {\n\t\t\t\tcloseDropdown();\n\t\t\t}\n\t\t};\n\t\tconst onDocumentClick = (event) => {\n\t\t\tconst clickedInside = node === event.target || node.contains(event.target); // || !document.contains(event.target)\n\t\t\tif (!clickedInside) {\n\t\t\t\tcloseDropdown();\n\t\t\t}\n\t\t};\n\t\tconst onShowHide = (value) => {\n\t\t\t/*\n\t\t\tif (uid === 4) {\n\t\t\t\tconsole.log('onShowHide', scope.hasDropdown, uid);\n\t\t\t}\n\t\t\t*/\n\t\t\tif (scope.hasDropdown === uid) {\n\t\t\t\tnode.classList.add('opened');\n\t\t\t} else {\n\t\t\t\tnode.classList.remove('opened');\n\t\t\t}\n\t\t};\n\t\tscope.$watch('hasDropdown', onShowHide);\n\t\tconst openDropdown = () => {\n\t\t\tif (opened === null) {\n\t\t\t\topened = true;\n\t\t\t\taddDocumentListeners();\n\t\t\t\tif (consumer) {\n\t\t\t\t\tconst dropdown = node.querySelector('[dropdown]');\n\t\t\t\t\tconsumer.onDroppedIn(dropdown).then((success) => {\n\t\t\t\t\t\t// console.log('success');\n\t\t\t\t\t});\n\t\t\t\t\t/*\n\t\t\t\t\tif (scope.hasDropdown === uid) {\n\t\t\t\t\t\t// consumer.onDroppedOut(dropdown);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsumer.onDroppedIn(dropdown);\n\t\t\t\t\t}\n\t\t\t\t\t// console.log(consumer, dropdown);\n\t\t\t\t\t*/\n\t\t\t\t}\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tscope.hasDropdown = uid;\n\t\t\t\t\t/*\n\t\t\t\t\tif (scope.hasDropdown === uid) {\n\t\t\t\t\t\t// scope.hasDropdown = null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscope.hasDropdown = uid;\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst closeDropdown = () => {\n\t\t\tif (opened !== null) {\n\t\t\t\tremoveDocumentListeners();\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\topened = null;\n\t\t\t\t\tif (consumer) {\n\t\t\t\t\t\tconst dropdown = node.querySelector('[dropdown]');\n\t\t\t\t\t\tconsumer.onDroppedOut(dropdown);\n\t\t\t\t\t\t// console.log(consumer, dropdown);\n\t\t\t\t\t}\n\t\t\t\t\tif (scope.hasDropdown === uid) {\n\t\t\t\t\t\tscope.hasDropdown = null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tscope.$on('onCloseDropdown', closeDropdown);\n\t\tscope.$on('onNavigateOut', closeDropdown);\n\t\tscope.$on('onNavigationTransitionIn', closeDropdown);\n\t\tconst addListeners = () => {\n\t\t\ttrigger.addEventListener('click', onClick);\n\t\t};\n\t\tconst addDocumentListeners = () => {\n\t\t\tdocument.addEventListener('click', onDocumentClick);\n\t\t};\n\t\tconst removeListeners = () => {\n\t\t\ttrigger.removeEventListener('click', onClick);\n\t\t};\n\t\tconst removeDocumentListeners = () => {\n\t\t\tdocument.removeEventListener('click', onDocumentClick);\n\t\t};\n\t\taddListeners();\n\t\tscope.$on('$destroy', () => {\n\t\t\tremoveListeners();\n\t\t\tremoveDocumentListeners();\n\t\t});\n\t}\n\n\tstatic factory($timeout) {\n\t\treturn new HasDropdownDirective($timeout);\n\t}\n\n}\n\nHasDropdownDirective.dropDownUid = 0;\n\nHasDropdownDirective.factory.$inject = ['$timeout'];\n","import HasDropdownDirective from \"./has-dropdown.directive\";\n\nexport default class AutocompleteDirective {\n\n\tconstructor(\n\t\t$timeout\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.restrict = 'A';\n\t\tthis.scope = {\n\t\t\tfilter: '=selectWithAutocomplete',\n\t\t\thandler: '=',\n\t\t\tonSetItem: '=?',\n\t\t\tonRemoveItem: '=?',\n\t\t};\n\t\tthis.template = `\n\t\t<div class=\"dropdown\">\n\t\t\t<ul class=\"nav nav--select\">\n\t\t\t\t<li ng-repeat=\"item in items track by $index\" ng-class=\"{ active: item.value == filter.value, disabled: item.disabled }\">\n\t\t\t\t\t<span class=\"option\" ng-class=\"{ 'option--picture': item.image }\" ng-click=\"setItem(item)\">\n\t\t\t\t\t\t<img ng-src=\"{{item.image}}\" ng-if=\"item.image\" />\n\t\t\t\t\t\t<span ng-bind=\"item.label\"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t\t<label class=\"label\" ng-bind=\"filter.label\"></label>\n\t\t<div class=\"control control--select\" ng-class=\"{ selected: filter.value }\">\n\t\t\t<div class=\"input\">\n\t\t\t\t<svg class=\"icon icon--close\" ng-if=\"filter.value\" ng-click=\"removeItem()\"><use xlink:href=\"#close\"></use></svg>\n\t\t\t\t<input type=\"text\" class=\"value\" ng-model=\"autocomplete.query\" ng-model-options=\"{ debounce: 200 }\" ng-disabled=\"filter.value\" placeholder=\"{{filter.placeholder}}\" ng-change=\"onChange($event)\" ng-click=\"onClick($event)\"></input>\n\t\t\t\t<svg class=\"icon icon--search\"><use xlink:href=\"#search\"></use></svg>\n\t\t\t\t<!-- <svg class=\"icon icon--arrow-down\"><use xlink:href=\"#arrow-down\"></use></svg> -->\n\t\t\t</div>\n\t\t</div>\n\t\t`;\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst input = node.querySelector('input');\n\t\tconst uid = HasDropdownDirective.dropDownUid++;\n\t\tconst autocomplete = scope.autocomplete = { query: null };\n\t\tconst filter = scope.filter;\n\t\tscope.items = scope.filter.options;\n\t\tnode.initialFocus = null;\n\t\t// scope.$parent.hasDropdown = null;\n\t\tscope.setItem = (item) => {\n\t\t\tfilter.value = item.value;\n\t\t\tautocomplete.query = null;\n\t\t\tif (scope.handler) {\n\t\t\t\tscope.handler.setFilter(item, filter);\n\t\t\t}\n\t\t};\n\t\tscope.removeItem = (item) => {\n\t\t\tfilter.value = null;\n\t\t\tautocomplete.query = null;\n\t\t\tif (scope.handler) {\n\t\t\t\tscope.handler.removeFilter(filter);\n\t\t\t}\n\t\t};\n\t\tscope.onChange = (event) => {\n\t\t\tautocomplete.results = filter.options.filter(x => x.label.toLowerCase().indexOf(autocomplete.query.toLowerCase()) !== -1);\n\t\t\tif (autocomplete.results) {\n\t\t\t\tscope.items = autocomplete.results;\n\t\t\t\tscope.$parent.hasDropdown = uid;\n\t\t\t\tnode.initialFocus = true;\n\t\t\t} else {\n\t\t\t\tscope.items = filter.options;\n\t\t\t\tscope.$parent.hasDropdown = null;\n\t\t\t}\n\t\t\t// console.log('onChange', autocomplete.query, autocomplete.results);\n\t\t};\n\t\tconst onClickInput = (event) => {\n\t\t\tevent.stopPropagation();\n\t\t\t// console.log('onClickInput', event);\n\t\t};\n\t\tconst onClick = (event) => {\n\t\t\tconst clickedInside = node === event.target || node.contains(event.target); // || !document.contains(event.target)\n\t\t\tif (clickedInside) {\n\t\t\t\tnode.initialFocus = true;\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tif (scope.$parent.hasDropdown === uid) {\n\t\t\t\t\t\tscope.$parent.hasDropdown = null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tscope.$parent.hasDropdown = uid;\n\t\t\t\t\t}\n\t\t\t\t\tscope.items = filter.options;\n\t\t\t\t\tautocomplete.query = null;\n\t\t\t\t\tautocomplete.results = [];\n\t\t\t\t});\n\t\t\t\t// console.log(node, clickedInside, scope.$parent.hasDropdown);\n\t\t\t} else if (node.initialFocus !== null) {\n\t\t\t\tnode.initialFocus = false;\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tif (scope.$parent.hasDropdown === uid) {\n\t\t\t\t\t\tscope.$parent.hasDropdown = null;\n\t\t\t\t\t\tscope.items = filter.options;\n\t\t\t\t\t\tautocomplete.query = null;\n\t\t\t\t\t\tautocomplete.results = [];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tscope.$parent.$watch('hasDropdown', (value) => {\n\t\t\t// console.log('hasDropdown', value, uid);\n\t\t\tif (scope.$parent.hasDropdown === uid) {\n\t\t\t\tnode.classList.add('opened');\n\t\t\t} else {\n\t\t\t\tnode.classList.remove('opened');\n\t\t\t}\n\t\t});\n\t\tconst addListeners = () => {\n\t\t\tinput.addEventListener('click', onClickInput);\n\t\t\tdocument.addEventListener('click', onClick);\n\t\t\t// element.on('click', onClick);\n\t\t};\n\t\tconst removeListeners = () => {\n\t\t\tinput.removeEventListener('click', onClickInput);\n\t\t\tdocument.removeEventListener('click', onClick);\n\t\t\t// element.off('click', onClick);\n\t\t};\n\t\taddListeners();\n\t\tscope.$on('$destroy', () => {\n\t\t\tremoveListeners();\n\t\t});\n\t}\n\n\tstatic factory($timeout) {\n\t\treturn new AutocompleteDirective($timeout);\n\t}\n\n}\n\nAutocompleteDirective.factory.$inject = ['$timeout'];\n","export default class CookiesDirective {\n\n\tconstructor(\n\t\t$timeout,\n\t\tStorageService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.storage = StorageService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst accept = () => {\n\t\t\tvar dt = new Date();\n\t\t\tdt.setDate(dt.getDate() + 365);\n\t\t\tdocument.cookie = '_cookiepolicy=accept; path=/; expires=' + dt.toUTCString();\n\t\t};\n\t\tconst node = element[0];\n\t\tconst cookiesAccepted = this.storage.get('cookiesAccepted');\n\t\tif (cookiesAccepted) {\n\t\t\tnode.classList.add('cookies-accepted');\n\t\t}\n\t\tscope.onAcceptCookies = (event) => {\n\t\t\tthis.storage.set('cookiesAccepted', true);\n\t\t\t// accept();\n\t\t\tTweenMax.to(node, 0.5, {\n\t\t\t\tbottom: '-100%',\n\t\t\t\tease: Power2.easeInOut,\n\t\t\t\tdelay: 0.15,\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tnode.classList.add('cookies-accepted');\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t}\n\n\tstatic factory($timeout, StorageService) {\n\t\treturn new CookiesDirective($timeout, StorageService);\n\t}\n\n}\n\nCookiesDirective.factory.$inject = ['$timeout', 'CookieService'];\n","import { FRAGMENT_SHADER } from \"../shared/shader\";\n\nexport default class GlslCanvasDirective {\n\n\t/*\n\tremoved \"node_modules/glsl-canvas-js/dist/glsl-canvas.js\",\n\tfrom gulpfile.config.json\n\t*/\n\n\tconstructor(\n\t\tDomService\n\t) {\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconsole.log('GlslCanvasDirective.link');\n\t\tconst node = element[0];\n\t\tconst canvas = new GlslCanvas(node, { fragmentString: FRAGMENT_SHADER });\n\t\t// const canvas = new GlslCanvas(node);\n\t\tcanvas.setTexture('u_texture', attributes.glslCanvas, { repeat: true });\n\t\tcanvas.setUniform('u_pow', 1.0);\n\t\tcanvas.setUniform('u_top', 0.0);\n\t\tcanvas.setUniform('u_strength', attributes.withVideo !== undefined ? 0.1 : 0.05);\n\t\tlet pow = { pow: 1.0 };\n\t\tlet tween;\n\t\tconst onOver = (event) => {\n\t\t\t// console.log('onOver');\n\t\t\tif (tween) {\n\t\t\t\ttween.kill();\n\t\t\t}\n\t\t\ttween = TweenMax.to(pow, 3, {\n\t\t\t\tpow: 0.0,\n\t\t\t\tease: Expo.easeOut,\n\t\t\t\t// Back.easeOut.config(1.7),\n\t\t\t\t// Elastic.easeOut.config(1, 0.3),\n\t\t\t\toverwrite: 'all',\n\t\t\t\tonUpdate: () => {\n\t\t\t\t\t// console.log(pow.pow);\n\t\t\t\t\tcanvas.setUniform('u_pow', pow.pow);\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\t\tconst onOut = (event) => {\n\t\t\t// console.log('onOut');\n\t\t\tif (tween) {\n\t\t\t\ttween.kill();\n\t\t\t}\n\t\t\ttween = TweenMax.to(pow, 3, {\n\t\t\t\tpow: 1.0,\n\t\t\t\tease: Expo.easeOut,\n\t\t\t\t// Back.easeOut.config(1.7),\n\t\t\t\t// Elastic.easeOut.config(1, 0.3),\n\t\t\t\toverwrite: 'all',\n\t\t\t\tonUpdate: () => {\n\t\t\t\t\t// console.log(pow.pow);\n\t\t\t\t\tcanvas.setUniform('u_pow', pow.pow);\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\t\tnode.addEventListener('mouseover', onOver);\n\t\tnode.addEventListener('mouseout', onOut);\n\t\tconst subscription = this.domService.raf$().subscribe(scroll => {\n\t\t\tcanvas.setUniform('u_top', window.scrollY || window.scrollTop || 0);\n\t\t});\n\t\tcanvas.on('error', function(error) {\n\t\t\tconsole.log(error);\n\t\t});\n\t\tscope.$on('$destroy', () => {\n\t\t\tif (tween) {\n\t\t\t\ttween.kill();\n\t\t\t}\n\t\t\tnode.removeEventListener('mouseover', onOver);\n\t\t\tnode.removeEventListener('mouseout', onOut);\n\t\t\tsubscription.unsubscribe();\n\t\t\tcanvas.destroy();\n\t\t});\n\t}\n\n\tstatic factory(DomService) {\n\t\treturn new GlslCanvasDirective(DomService);\n\t}\n\n}\n\nGlslCanvasDirective.factory.$inject = ['DomService'];\n","\n\n\nexport const FRAGMENT_SHADER = `\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform vec2 u_resolution;\nuniform vec2 u_mouse;\nuniform float u_time;\nuniform float u_pow;\nuniform float u_top;\nuniform float u_strength;\nuniform sampler2D u_texture;\nuniform vec2 u_textureResolution;\n\nfloat random(vec2 st) {\n\treturn fract(sin(dot(st.xy + cos(u_time), vec2(12.9898 , 78.233))) * (43758.5453123));\n}\n\nvoid main() {\n\tvec2 st = gl_FragCoord.xy / u_resolution.xy;\n\tfloat rr = u_resolution.x / u_resolution.y;\n\tfloat tr = u_textureResolution.x / u_textureResolution.y;\n\tif (tr > rr) {\n\t\tst.x = ((st.x - 0.5) * rr / tr) + 0.5;\n\t} else {\n\t\tst.y = ((st.y - 0.5) / rr * tr) + 0.5;\n\t}\n\tfloat top = u_top / u_resolution.y;\n\tvec2 mx = u_mouse / u_resolution;\n\tvec2 dx = vec2(cos(u_time * 0.5), sin(u_time * 0.6)) * 4.0 * u_strength;\n\n\tfloat noise = random(st) * 0.08;\n\n\tfloat c = cos((st.x + dx.x - mx.x * 0.4) * 6.0 + 2.0 * dx.y);\n\tfloat s = sin((st.y + top + dx.y - mx.y * 0.2) * 3.0 + 1.0 * dx.x);\n\tfloat b = (length(vec2(c + s, c)) + 2.0) * u_strength;\n\n\tfloat center = length(st - 0.5);\n\tvec2 sty = vec2(st.x, st.y + top);\n\tfloat scale = 0.95 * (1.0 - b * center * u_pow);\n\tvec2 stb = (sty - 0.5) * scale + 0.5;\n\n\tvec3 video = texture2D(u_texture, stb).rgb;\n\tvec3 bulge = vec3(b);\n\n\tvec3 color = vec3(0.0);\n\tcolor = vec3(video - noise);\n\t// color = vec3(video);\n\t// color = vec3(video - bulge * 0.1 - noise);\n\t// color = vec3(bulge);\n\t// color = vec3(noise);\n\t// color = vec3(center);\n\t// color = vec3(u_pow * center);\n\t// color = vec3(bulge - noise) * length(st - 0.5) * u_pow;\n\n\tgl_FragColor = vec4(color, 1.0);\n}\n`;\n","export default class HilightDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tlet hilight, query;\n\t\tconst update = () => {\n\t\t\tif (hilight) {\n\t\t\t\tif (query) {\n\t\t\t\t\tconst index = hilight.toLowerCase().indexOf(query);\n\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\tnode.innerHTML = `${hilight.substring(0, index)}<span class=\"hilight\">${hilight.substring(index, index + query.length)}</span>${hilight.substring(index + query.length, hilight.length)}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.innerHTML = hilight;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnode.innerHTML = hilight;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// console.log(hilight, query, node.innerHTML);\n\t\t};\n\t\tscope.$watch(attributes.hilight, (current, previous) => {\n\t\t\t// console.log('HilightDirective.hilight', current, previous);\n\t\t\thilight = current;\n\t\t\tupdate();\n\t\t});\n\t\tscope.$watch(attributes.query, (current, previous) => {\n\t\t\t// console.log('HilightDirective.query', current, previous);\n\t\t\tquery = current;\n\t\t\tupdate();\n\t\t});\n\t\treturn;\n\t}\n\n\tstatic factory() {\n\t\treturn new HilightDirective();\n\t}\n\n}\n\nHilightDirective.factory.$inject = [];\n","const USE_HIGHWAY = true;\n\nexport default class HrefDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst onClick = () => {\n\t\t\twindow.location.href = node.getAttribute('href') /* attributes.href mantiene il valore iniziale */ ;\n\t\t};\n\t\tif (USE_HIGHWAY) {\n\t\t\tif (attributes.routerDisabled === undefined) {\n\t\t\t\tscope.$emit('onHrefNode', node);\n\t\t\t} else {\n\t\t\t\t// console.log(attributes.routerDisabled, node);\n\t\t\t\tnode.addEventListener('click', onClick);\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tif (node.nodeName.toLowerCase() === 'link') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (attributes.target === '_blank') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst onClick = (event) => {\n\t\t\t\tconst href = attributes.href;\n\t\t\t\tconst absolute = /^(http:|https:|\\/\\/)/.test(href);\n\t\t\t\tconst domain = this.getDomain(href);\n\t\t\t\tconst currentDomain = this.getDomain(window.location.href);\n\t\t\t\tif (absolute && domain !== currentDomain) {\n\t\t\t\t\twindow.location.href = href;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Se c'è un cambio di mercato, facciamo ricaricare la pagina\n\t\t\t\tconst market = this.getMarket(href);\n\t\t\t\tconst currentMarket = this.getMarket(window.location.href);\n\t\t\t\t// console.log('onNavigationShouldFetch', currentMarket, market);\n\t\t\t\tif (currentMarket !== null && market !== currentMarket) {\n\t\t\t\t\twindow.location.href = href;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (window.location.href.indexOf(href) !== -1) {\n\t\t\t\t\tnode.classList.add('active');\n\t\t\t\t} else {\n\t\t\t\t\tnode.classList.remove('active');\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\tif (href === '#') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst title = node.innerText;\n\t\t\t\tscope.$emit('onNavigationShouldFetch', { title, href });\n\t\t\t};\n\t\t\tnode.addEventListener('click', onClick);\n\t\t\t/*\n\t\t\tscope.$on('onNavigationEnded', function($scope, $href) {\n\t\t\t\tif (href === $href) {\n\t\t\t\t\tnode.classList.add('active');\n\t\t\t\t} else {\n\t\t\t\t\tnode.classList.remove('active');\n\t\t\t\t}\n\t\t\t});\n\t\t\t*/\n\t\t\tscope.$on('$destroy', () => {\n\t\t\t\tnode.removeEventListener('click', onClick);\n\t\t\t});\n\t\t}\n\t\tscope.$on('$destroy', () => {\n\t\t\tnode.removeEventListener('click', onClick);\n\t\t});\n\t\treturn;\n\t}\n\n\tgetDomain(text) {\n\t\tconst domainRegexp = /([[a-zA-Z0-9-_]+\\.]*[a-zA-Z0-9][a-zA-Z0-9-_]+\\.[a-zA-Z]{2,11})/;\n\t\tconst matches = text.match(domainRegexp);\n\t\treturn matches && matches.length > 1 ? matches[1] : null;\n\t}\n\n\tgetMarket(text) {\n\t\tconst marketRegexp = /(^|[^\\/])\\/([^\\/]+)/;\n\t\tconst matches = text.match(marketRegexp);\n\t\treturn matches && matches.length > 2 ? matches[2] : null;\n\t}\n\n\tstatic factory() {\n\t\treturn new HrefDirective();\n\t}\n\n}\n\nHrefDirective.factory.$inject = [];\n","export class LastItemDirective {\n\n\tconstructor(\n\t\t$timeout\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tif (scope.$last === true) {\n\t\t\tthis.$timeout(() => {\n\t\t\t\tscope.$emit('lastItem', element);\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic factory($timeout) {\n\t\treturn new LastItemDirective($timeout);\n\t}\n\n}\n\nLastItemDirective.factory.$inject = ['$timeout'];\n","export default class LazyScriptDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t\tthis.scope = false;\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\t// if (attributes.type === 'text/javascript-lazy') {\n\t\tif (attributes.src !== undefined) {\n\t\t\tfetch(attributes.src, {\n\t\t\t\tmode: 'no-cors'\n\t\t\t}).then(response => {\n\t\t\t\tconst code = response.text();\n\t\t\t\ttry {\n\t\t\t\t\tnew Function(code)();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log('LazyScriptDirective.error', error);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tconst code = element.text();\n\t\t\ttry {\n\t\t\t\tnew Function(code)();\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('LazyScriptDirective.error', error);\n\t\t\t}\n\t\t}\n\t\t// }\n\t\t// scope.$on('$destroy', () => {});\n\t}\n\n\tstatic factory() {\n\t\treturn new LazyScriptDirective();\n\t}\n\n}\n\nLazyScriptDirective.factory.$inject = [];\n","\n\nexport default class Rect {\n\n\tconstructor(rect) {\n\t\tthis.top = 0;\n\t\tthis.right = 0;\n\t\tthis.bottom = 0;\n\t\tthis.left = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.set(rect);\n\t}\n\n\tstatic contains(rect, left, top) {\n\t\treturn rect.top <= top && top <= rect.bottom && rect.left <= left && left <= rect.right;\n\t}\n\n\tstatic intersectRect(r1, r2) {\n\t\treturn !(r2.left > r1.right ||\n\t\t\tr2.right < r1.left ||\n\t\t\tr2.top > r1.bottom ||\n\t\t\tr2.bottom < r1.top);\n\t}\n\n\tstatic fromNode(node) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst rect = node.rect_ || (node.rect_ = new Rect());\n\t\tconst rects = node.getClientRects();\n\t\tif (!rects.length) {\n\t\t\t// console.log(rects, node);\n\t\t\treturn rect;\n\t\t}\n\t\tconst boundingRect = node.getBoundingClientRect();\n\t\t// rect.top: boundingRect.top + defaultView.pageYOffset,\n\t\t// rect.left: boundingRect.left + defaultView.pageXOffset,\n\t\trect.top = boundingRect.top;\n\t\trect.left = boundingRect.left;\n\t\trect.width = boundingRect.width;\n\t\trect.height = boundingRect.height;\n\t\trect.setCenter();\n\t\treturn rect;\n\t}\n\n\tset(rect) {\n\t\tif (rect) {\n\t\t\tObject.assign(this, rect);\n\t\t\tthis.right = this.left + this.width;\n\t\t\tthis.bottom = this.top + this.height;\n\t\t}\n\t\tthis.setCenter();\n\t}\n\n\tsetCenter() {\n\t\tconst center = this.center || (this.center = {});\n\t\tcenter.top = this.top + this.height / 2;\n\t\tcenter.left = this.left + this.width / 2;\n\t\tcenter.x = center.left;\n\t\tcenter.y = center.top;\n\t}\n\n\tcontains(left, top) {\n\t\treturn Rect.contains(this, left, top);\n\t}\n\n\tintersect(rect) {\n\t\treturn Rect.intersectRect(this, rect);\n\t}\n\n\tintersection(rect) {\n\t\tconst intersection = this.intersection_ || (this.intersection_ = { center: {} });\n\t\tintersection.center.x = (this.center.x - rect.center.x) / (rect.width / 2);\n\t\tintersection.center.y = (this.center.y - rect.center.y) / (rect.height / 2);\n\t\tconst dx = this.left > rect.left ? 0 : Math.abs(rect.left - this.left);\n\t\tconst dy = this.top > rect.top ? 0 : Math.abs(rect.top - this.top);\n\t\tconst x = dx ? (1 - dx / this.width) : ((rect.left + rect.width) - this.left) / this.width;\n\t\tconst y = dy ? (1 - dy / this.height) : ((rect.top + rect.height) - this.top) / this.height;\n\t\tintersection.x = x;\n\t\tintersection.y = y;\n\t\treturn intersection;\n\t}\n\n\tintersection___(rect) {\n\t\tconst center = {\n\t\t\tx: (this.center.x - rect.center.x) / (rect.width / 2),\n\t\t\ty: (this.center.y - rect.center.y) / (rect.height / 2),\n\t\t};\n\t\tif (this.intersect(rect)) {\n\t\t\tconst dx = this.left > rect.left ? 0 : Math.abs(rect.left - this.left);\n\t\t\tconst dy = this.top > rect.top ? 0 : Math.abs(rect.top - this.top);\n\t\t\tlet x = dx ? (1 - dx / this.width) : ((rect.left + rect.width) - this.left) / this.width;\n\t\t\tlet y = dy ? (1 - dy / this.height) : ((rect.top + rect.height) - this.top) / this.height;\n\t\t\tx = Math.min(1, x);\n\t\t\ty = Math.min(1, y);\n\t\t\treturn {\n\t\t\t\tx: x,\n\t\t\t\ty: y,\n\t\t\t\tcenter: center\n\t\t\t};\n\t\t} else {\n\t\t\treturn { x: 0, y: 0, center: center };\n\t\t}\n\t}\n\n}\n","import { map } from 'rxjs/operators';\nimport GtmService from '../gtm/gtm.service';\nimport Rect from '../shared/rect';\n\n// let INDEX = 0;\n\nexport default class LazyDirective {\n\n\t// src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" lazy lazy-src=\"\n\n\tconstructor(\n\t\tDomService\n\t) {\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t\tthis.scope = {\n\t\t\tsrc: \"@?\",\n\t\t\tsrcset: \"@?\",\n\t\t\tbackgroundSrc: \"@?\",\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst image = element[0];\n\t\tif (window.matchMedia('print').matches) {\n\t\t\treturn this.immediate(scope, image);\n\t\t}\n\n\t\timage.classList.remove('lazying', 'lazyed');\n\n\t\tconst subscription = this.domService.appear$(image).subscribe(event => {\n\t\t\tif ((image.width > 0 || image.height > 0 || !image.classList.contains('nav--primary--image')) && !image.classList.contains('lazying')) {\n\t\t\t\timage.classList.add('lazying');\n\t\t\t\tthis.onAppearsInViewport(image, scope, attributes);\n\t\t\t}\n\t\t});\n\n\t\tconst onBeforePrint = () => {\n\t\t\tthis.immediate(scope, image);\n\t\t\tsubscription.unsubscribe();\n\t\t};\n\t\twindow.addEventListener('beforeprint', onBeforePrint);\n\n\t\tscope.$on('$destroy', () => {\n\t\t\twindow.removeEventListener('beforeprint', onBeforePrint);\n\t\t\tsubscription.unsubscribe();\n\t\t});\n\t}\n\n\timmediate(scope, image) {\n\t\t// this.onAppearsInViewport(image, scope, attributes);\n\t\tif (!image.classList.contains('lazyed')) {\n\t\t\tconst src = this.getThronSrc(image, scope.src);\n\t\t\timage.src = src;\n\t\t\timage.removeAttribute('data-src');\n\t\t\timage.classList.remove('lazying');\n\t\t\timage.classList.add('lazyed');\n\t\t\tscope.$emit('lazyImage', image);\n\t\t}\n\t}\n\n\tgetThronSrc(image, src) {\n\t\tconst node = image.parentNode;\n\t\tconst splitted = src.split('/std/');\n\t\tif (splitted.length > 1) {\n\t\t\t// Contenuto Thron\n\t\t\tif (splitted[1].match(/^0x0\\//)) {\n\t\t\t\t// se non sono state richieste dimensioni specifiche, imposto le dimensioni necessarie alla pagina\n\t\t\t\t// src = splitted[0] + '/std/' + Math.floor(image.width * 1.1).toString() + 'x' + Math.floor(image.height * 1.1).toString() + splitted[1].substr(3);\n\t\t\t\tsrc = splitted[0] + '/std/' + Math.floor(node.offsetWidth * 1.1).toString() + 'x0' + splitted[1].substr(3);\n\t\t\t\t/*\n\t\t\t\tif (node.offsetWidth >= node.offsetHeight) {\n\t\t\t\t\tsrc = splitted[0] + '/std/' + Math.floor(node.offsetWidth * 1.1).toString() + 'x0' + splitted[1].substr(3);\n\t\t\t\t} else {\n\t\t\t\t\tsrc = splitted[0] + '/std/0x' + Math.floor(node.offsetHeight * 1.1).toString() + splitted[1].substr(3);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tif (!src.match(/[&?]scalemode=?/)) {\n\t\t\t\t\tsrc += src.indexOf('?') !== -1 ? '&' : '?';\n\t\t\t\t\t// src += 'scalemode=auto';\n\t\t\t\t}\n\t\t\t}\n\t\t\t//if (window.devicePixelRatio > 1) {\n\t\t\t//\tsrc += src.indexOf('?') !== -1 ? '&' : '?';\n\t\t\t//\tsrc += 'dpr=' + Math.floor(window.devicePixelRatio * 100).toString();\n\t\t\t//}\n\t\t}\n\t\treturn src;\n\t}\n\n\tonAppearsInViewport(image, scope, attributes) {\n\t\tif (scope.srcset) {\n\t\t\t// attributes.$set('srcset', scope.srcset);\n\t\t\timage.setAttribute('srcset', scope.srcset);\n\t\t\timage.removeAttribute('data-srcset');\n\t\t\tif (scope.src) {\n\t\t\t\t// attributes.$set('src', scope.src);\n\t\t\t\timage.setAttribute('src', this.getThronSrc(image, scope.src));\n\t\t\t\timage.removeAttribute('data-src');\n\t\t\t}\n\t\t\timage.classList.remove('lazying');\n\t\t\timage.classList.add('lazyed');\n\t\t} else if (scope.src) {\n\t\t\tconst src = this.getThronSrc(image, scope.src);\n\t\t\timage.removeAttribute('data-src');\n\t\t\tthis.onImagePreload(image, src, (srcOrUndefined) => {\n\t\t\t\t// image.setAttribute('src', src);\n\t\t\t\timage.classList.remove('lazying');\n\t\t\t\timage.classList.add('lazyed');\n\t\t\t\tscope.$emit('lazyImage', image);\n\t\t\t});\n\t\t} else if (scope.backgroundSrc) {\n\t\t\timage.setStyle('background-image', `url(${this.getThronSrc(image, scope.backgroundSrc)})`);\n\t\t\timage.removeAttribute('data-background-src');\n\t\t\timage.classList.remove('lazying');\n\t\t\timage.classList.add('lazyed');\n\t\t}\n\t}\n\n\tlazy$(node) {\n\t\treturn this.domService.rafAndRect$().pipe(\n\t\t\tmap(datas => {\n\t\t\t\tconst windowRect = datas[1];\n\t\t\t\tconst rect = Rect.fromNode(node);\n\t\t\t\tconst intersection = rect.intersection(windowRect);\n\t\t\t\treturn intersection;\n\t\t\t})\n\t\t);\n\t}\n\n\tonImagePreload(image, src, callback) {\n\t\t// const img = new Image();\n\t\timage.onload = () => {\n\t\t\timage.onload = image.onerror = null;\n\t\t\tif (typeof callback === 'function') {\n\t\t\t\t// setTimeout(() => {\n\t\t\t\tcallback(image.src);\n\t\t\t\t// }, 10);\n\t\t\t}\n\t\t};\n\t\timage.onerror = function(e) {\n\t\t\timage.onload = image.onerror = null;\n\n\t\t\tGtmService.push({\n\t\t\t\tevent: 'img error',\n\t\t\t\timageurl: image.src,\n\t\t\t\tpageurl: window.location.href\n\t\t\t});\n\n\t\t\timage.src = 'data:image/png;base64,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';\n\t\t\t// setTimeout(() => {\n\t\t\tcallback();\n\t\t\t// }, 10);\n\t\t};\n\t\timage.src = src;\n\t}\n\n\tstatic factory(DomService) {\n\t\treturn new LazyDirective(DomService);\n\t}\n\n}\n\nLazyDirective.factory.$inject = ['DomService'];\n","import GtmService from '../gtm/gtm.service';\n\nexport default class MediaDirective {\n\n\tconstructor(\n\t\t$timeout,\n\t\tWishlistService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.wishlistService = WishlistService;\n\t\tthis.restrict = 'A';\n\t\tthis.transclude = true;\n\t\tthis.template = `<div class=\"media\">\n\t<ng-transclude></ng-transclude>\n</div>\n<div class=\"overlay\" ng-click=\"onOverlay()\"></div>\n<div class=\"share-buttons\">\n<div class=\"btn btn--pinterest\" ng-click=\"onPin($event)\" ng-if=\"onPin\">\n\t<svg class=\"icon icon--pinterest\"><use xlink:href=\"#pinterest\"></use></svg>\n</div>\n<div class=\"btn btn--wishlist\" ng-class=\"{ active: wishlistActive, activated: wishlistActivated, deactivated: wishlistDeactivated }\" ng-click=\"onClickWishlist($event)\">\n\t<svg class=\"icon icon--wishlist\" ng-if=\"!wishlistActive\"><use xlink:href=\"#wishlist\"></use></svg>\n\t<svg class=\"icon icon--wishlist\" ng-if=\"wishlistActive\"><use xlink:href=\"#wishlist-added\"></use></svg>\n</div></div>`;\n\t\tthis.scope = {\n\t\t\titem: '=?media',\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tscope.item = scope.item || {};\n\t\tconst node = element[0];\n\t\tconst img = node.querySelector('img');\n\t\tif (img) {\n\t\t\tconst pageTitle = document.title;\n\t\t\tscope.onPin = (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tconst pin = {\n\t\t\t\t\turl: window.location.href,\n\t\t\t\t\tmedia: img.src,\n\t\t\t\t\tdescription: img.title || pageTitle,\n\t\t\t\t};\n\t\t\t\t// console.log('MediaDirective.onPin', pin);\n\n\t\t\t\tGtmService.push({\n\t\t\t\t\tevent: 'Pinterest',\n\t\t\t\t\twish_name: scope.item.name || scope.item.coId,\n\t\t\t\t\twish_type: scope.item.typeName || scope.item.type\n\t\t\t\t});\n\n\t\t\t\tPinUtils.pinOne(pin);\n\t\t\t};\n\t\t}\n\t\tscope.$watch(() => {\n\t\t\treturn this.wishlistService.has(scope.item);\n\t\t}, (current, previous) => {\n\t\t\t// console.log(current, previous, node);\n\t\t\tif (scope.wishlistActive !== current) {\n\t\t\t\tscope.wishlistActive = current;\n\t\t\t\tif (current) {\n\t\t\t\t\tscope.wishlistActivated = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.wishlistActivated = false;\n\t\t\t\t\t}, 2000);\n\t\t\t\t} else {\n\t\t\t\t\tscope.wishlistDeactivated = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.wishlistDeactivated = false;\n\t\t\t\t\t}, 2000);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tscope.onClickWishlist = (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\n\t\t\tthis.wishlistService.toggle(scope.item).then(\n\t\t\t\t(has) => {\n\t\t\t\t\tconsole.log('MediaDirective.onClickWishlist', has);\n\t\t\t\t},\n\t\t\t\t(error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t}\n\t\t\t);\n\t\t};\n\t\tscope.onOverlay = (event) => {\n\t\t\tconst btnGallery = node.nextElementSibling && node.nextElementSibling.querySelector('.btn--gallery');\n\t\t\tif (btnGallery !== null) {\n\t\t\t\t// console.log(btnGallery);\n\t\t\t\tbtnGallery.click();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (node.classList.contains('picture--vertical') || node.classList.contains('picture--horizontal') || node.classList.contains('picture--square')) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\tconst items = [...document.querySelectorAll('.picture--vertical[media], .picture--vertical[video], .picture--horizontal[media], .picture--horizontal[video], .picture--square[media], .picture--square[video]')].map((itemNode, i) => {\n\t\t\t\t\t\tif (itemNode == node) {\n\t\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst item = {};\n\t\t\t\t\t\titem.type = itemNode.hasAttribute('media') ? 'media' : 'video';\n\t\t\t\t\t\tif (item.type === 'media') {\n\t\t\t\t\t\t\tconst img = itemNode.querySelector('img');\n\t\t\t\t\t\t\tif (img) {\n\t\t\t\t\t\t\t\titem.src = img.getAttribute('data-src-zoom') || img.getAttribute('src') || img.getAttribute('data-src');\n\t\t\t\t\t\t\t\titem.title = img.getAttribute('alt');\n\t\t\t\t\t\t\t\tconst wishlist = itemNode.getAttribute('media');\n\t\t\t\t\t\t\t\tif (wishlist) {\n\t\t\t\t\t\t\t\t\titem.wishlist = this.eval(wishlist); // JSON.parse(wishlist.indexOf('\"') === -1 ? wishlist.split(/[^\\d\\W]+/g).join('\"') : wishlist);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log(itemNode, img);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst video = itemNode.querySelector('video');\n\t\t\t\t\t\t\tconst sources = video.querySelectorAll('source');\n\t\t\t\t\t\t\titem.poster = video.getAttribute('poster');\n\t\t\t\t\t\t\titem.src = sources[sources.length - 1].getAttribute('src');\n\t\t\t\t\t\t\titem.title = video.getAttribute('alt');\n\t\t\t\t\t\t\tconst wishlist = itemNode.getAttribute('video');\n\t\t\t\t\t\t\tif (wishlist) {\n\t\t\t\t\t\t\t\titem.wishlist = this.eval(wishlist); // JSON.parse(wishlist.indexOf('\"') === -1 ? wishlist.split(/[^\\d\\W]+/g).join('\"') : wishlist);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t});\n\t\t\t\t\tscope.$root.gallery = {\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\titems,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t\t// event.preventDefault();\n\t\t\t// event.stopPropagation();\n\t\t};\n\t\tscope.$on('$destroy', () => {});\n\t}\n\n\teval(string) {\n\t\treturn new Function(`() => {\n\t\t\treturn ${string};\n\t\t}`)();\n\t}\n\n\tstatic factory($timeout, WishlistService) {\n\t\treturn new MediaDirective($timeout, WishlistService);\n\t}\n\n}\n\nMediaDirective.factory.$inject = ['$timeout', 'WishlistService'];\n","/* global window, document, angular, Muuri, TweenMax, TimelineMax */\n\nexport class MuuriDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tif (window.matchMedia('print').matches) {\n\t\t\tnode.classList.add('printable');\n\t\t\treturn;\n\t\t}\n\t\tconst onBeforePrint = () => {\n\t\t\tif (element.muuri) {\n\t\t\t\telement.muuri.destroy();\n\t\t\t}\n\t\t\tnode.classList.add('printable');\n\t\t};\n\t\twindow.addEventListener('beforeprint', onBeforePrint);\n\t\tscope.$on('lastItem', (slide) => {\n\t\t\t// console.log('MuuriDirective.lastItem', slide);\n\t\t\tthis.onMuuri(scope, element, attributes);\n\t\t});\n\t\tscope.$on('lazyImage', (slide) => {\n\t\t\t// console.log('lazyImage', element.muuri);\n\t\t\treturn;\n\t\t\tif (element.muuri) {\n\t\t\t\tconst node = element[0];\n\t\t\t\tconst items = [...node.querySelectorAll('.listing__item')];\n\t\t\t\telement.muuri.refreshItems(items).layout();\n\t\t\t}\n\t\t});\n\t\tscope.$on('$destroy', () => {\n\t\t\twindow.removeEventListener('beforeprint', onBeforePrint);\n\t\t\tif (element.muuri) {\n\t\t\t\telement.muuri.destroy();\n\t\t\t}\n\t\t});\n\t\tsetTimeout(() => {\n\t\t\tthis.onMuuri(scope, element, attributes);\n\t\t}, 1);\n\t}\n\n\tonMuuri(scope, element, attributes) {\n\t\tif (element.muuri) {\n\t\t\tconst node = element[0];\n\t\t\t// const items = scope.$eval(attributes.muuri);\n\t\t\tconst previousItems = element.muuri.getItems().map(x => x.getElement());\n\t\t\t// console.log('MuuriDirective.previousItems', previousItems);\n\t\t\tconst items = [...node.querySelectorAll('.listing__item')];\n\t\t\t// console.log('MuuriDirective.newItems', items);\n\t\t\tconst newItems = items.filter(x => previousItems.indexOf(x) === -1);\n\t\t\tconst removeItems = previousItems.filter(x => items.indexOf(x) === -1);\n\t\t\telement.muuri.remove(removeItems);\n\t\t\telement.muuri.add(newItems);\n\t\t\t// element.muuri.refreshItems(items).layout();\n\t\t} else {\n\t\t\telement.muuri = new Muuri(element[0], {\n\t\t\t\tlayoutDuration: 0, // 400,\n\t\t\t\tlayoutEasing: 'ease',\n\t\t\t\tlayout: {\n\t\t\t\t\tfillGaps: true,\n\t\t\t\t\thorizontal: false,\n\t\t\t\t\talignRight: false,\n\t\t\t\t\talignBottom: false,\n\t\t\t\t\trounding: false\n\t\t\t\t}\n\t\t\t});\n\t\t\telement.addClass('muuri-init');\n\t\t\tscope.$emit('onMuuri');\n\t\t}\n\t}\n\n\tstatic factory() {\n\t\treturn new MuuriDirective();\n\t}\n\n}\n\nMuuriDirective.factory.$inject = [];\n","// Workaround for Edge 16+, which only implemented object-fit for <img> tags\n// TODO: Keep an eye on Edge to determine which version has full final support\nconst edgeVersion = window.navigator.userAgent.match(/Edge\\/(\\d{2})\\./);\nconst edgePartialSupport = edgeVersion ?\n\tparseInt(edgeVersion[1], 10) >= 16 :\n\tfalse;\n\n// If the browser does support object-fit, we don't need to continue\nconst hasSupport = 'objectFit' in document.documentElement.style !== false;\n\nexport default class ObjectFitDirective {\n\n\tconstructor(\n\t\tDomService\n\t) {\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\t// console.log('ObjectFitDirective', node);\n\n\t\t// if the page is being rendered on the server, don't continue\n\t\tif (typeof window === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tif (hasSupport && !edgePartialSupport) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.polyfill(node);\n\n\t\t/*\n\t\t\tif (typeof node === 'undefined' || node instanceof Event) {\n\t\t\t\t// If left blank, or a default event, all node on the page will be polyfilled.\n\t\t\t\tnode = document.querySelectorAll('[data-object-fit]');\n\t\t\t} else if (node && node.nodeName) {\n\t\t\t\t// If it's a single node, wrap it in an array so it works.\n\t\t\t\tnode = [node];\n\t\t\t} else if (typeof node === 'object' && node.length && node[0].nodeName) {\n\t\t\t\t// If it's an array of DOM nodes (e.g. a jQuery selector), it's fine as-is.\n\t\t\t\tnode = node;\n\t\t\t} else {\n\t\t\t\t// Otherwise, if it's invalid or an incorrect type, return false to let people know.\n\t\t\t\treturn false;\n\t\t\t}\n\t\t*/\n\n\t\tconst polyfill = () => {\n\t\t\tthis.polyfill(node);\n\t\t};\n\t\twindow.addEventListener('resize', polyfill);\n\t\tscope.$on('$destroy', () => {\n\t\t\twindow.removeEventListener('resize', polyfill);\n\t\t});\n\n\t}\n\n\tpolyfill(node) {\n\t\tconst nodeName = node.nodeName.toLowerCase();\n\t\tconst objectFit = () => {\n\t\t\tthis.objectFit(node);\n\t\t};\n\t\tif (nodeName === 'img') {\n\t\t\tif (edgePartialSupport) {\n\t\t\t\treturn;\n\t\t\t\t// Edge supports object-fit for images (but nothing else), so no need to polyfill\n\t\t\t}\n\t\t\tif (node.complete) {\n\t\t\t\tthis.objectFit(node);\n\t\t\t} else {\n\t\t\t\tnode.addEventListener('load', objectFit);\n\t\t\t}\n\t\t} else if (nodeName === 'video') {\n\t\t\tif (node.readyState > 0) {\n\t\t\t\tthis.objectFit(node);\n\t\t\t} else {\n\t\t\t\tnode.addEventListener('loadedmetadata', objectFit);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.objectFit(node);\n\t\t}\n\t}\n\n\tobjectFit(node) {\n\t\tconsole.log('ObjectFitDirective.objectFit', node);\n\t\t// IE 10- data polyfill\n\t\tlet fit = node.dataset ?\n\t\t\tnode.dataset.objectFit :\n\t\t\tnode.getAttribute('data-object-fit');\n\t\tlet position = node.dataset ?\n\t\t\tnode.dataset.objectPosition :\n\t\t\tnode.getAttribute('data-object-position');\n\t\t// Default fallbacks\n\t\tfit = fit || 'cover';\n\t\tposition = position || '50% 50%';\n\t\t// If necessary, make the parent container work with absolutely positioned elements\n\t\tconst parentNode = node.parentNode;\n\t\tthis.checkParentContainer(parentNode);\n\t\t// Check for any pre-set CSS which could mess up image calculations\n\t\tthis.checkMediaProperties(node);\n\t\t// Reset any pre-set width/height CSS and handle fit positioning\n\t\tnode.style.position = 'absolute';\n\t\tnode.style.width = 'auto';\n\t\tnode.style.height = 'auto';\n\t\t// `scale-down` chooses either `none` or `contain`, whichever is smaller\n\t\tif (fit === 'scale-down') {\n\t\t\tif (\n\t\t\t\tnode.clientWidth < parentNode.clientWidth &&\n\t\t\t\tnode.clientHeight < parentNode.clientHeight\n\t\t\t) {\n\t\t\t\tfit = 'none';\n\t\t\t} else {\n\t\t\t\tfit = 'contain';\n\t\t\t}\n\t\t}\n\t\t// `none` (width/height auto) and `fill` (100%) and are straightforward\n\t\tif (fit === 'none') {\n\t\t\tthis.setPosition('x', node, position);\n\t\t\tthis.setPosition('y', node, position);\n\t\t\treturn;\n\t\t}\n\t\tif (fit === 'fill') {\n\t\t\tnode.style.width = '100%';\n\t\t\tnode.style.height = '100%';\n\t\t\tthis.setPosition('x', node, position);\n\t\t\tthis.setPosition('y', node, position);\n\t\t\treturn;\n\t\t}\n\t\t// `cover` and `contain` must figure out which side needs covering, and add CSS positioning & centering\n\t\tnode.style.height = '100%';\n\t\tif ((fit === 'cover' && node.clientWidth > parentNode.clientWidth) ||\n\t\t\t(fit === 'contain' && node.clientWidth < parentNode.clientWidth)) {\n\t\t\tnode.style.top = '0';\n\t\t\tnode.style.marginTop = '0';\n\t\t\tthis.setPosition('x', node, position);\n\t\t} else {\n\t\t\tnode.style.width = '100%';\n\t\t\tnode.style.height = 'auto';\n\t\t\tnode.style.left = '0';\n\t\t\tnode.style.marginLeft = '0';\n\t\t\tthis.setPosition('y', node, position);\n\t\t}\n\t}\n\n\tcheckParentContainer(parentNode) {\n\t\tconst styles = window.getComputedStyle(parentNode, null);\n\t\tconst position = styles.getPropertyValue('position');\n\t\tconst overflow = styles.getPropertyValue('overflow');\n\t\tconst display = styles.getPropertyValue('display');\n\t\tif (!position || position === 'static') {\n\t\t\tparentNode.style.position = 'relative';\n\t\t}\n\t\tif (overflow !== 'hidden') {\n\t\t\tparentNode.style.overflow = 'hidden';\n\t\t}\n\t\t// Guesstimating that people want the parent to act like full width/height wrapper here.\n\t\t// Mostly attempts to target <picture> elements, which default to inline.\n\t\tif (!display || display === 'inline') {\n\t\t\tparentNode.style.display = 'block';\n\t\t}\n\t\tif (parentNode.clientHeight === 0) {\n\t\t\tparentNode.style.height = '100%';\n\t\t}\n\t\t// Add a CSS class hook, in case people need to override styles for any reason.\n\t\tif (parentNode.className.indexOf('object-fit-polyfill') === -1) {\n\t\t\tparentNode.className = parentNode.className + ' object-fit-polyfill';\n\t\t}\n\t}\n\n\tcheckMediaProperties(node) {\n\t\tconst styles = window.getComputedStyle(node, null);\n\t\tconst constraints = {\n\t\t\t'max-width': 'none',\n\t\t\t'max-height': 'none',\n\t\t\t'min-width': '0px',\n\t\t\t'min-height': '0px',\n\t\t\ttop: 'auto',\n\t\t\tright: 'auto',\n\t\t\tbottom: 'auto',\n\t\t\tleft: 'auto',\n\t\t\t'margin-top': '0px',\n\t\t\t'margin-right': '0px',\n\t\t\t'margin-bottom': '0px',\n\t\t\t'margin-left': '0px',\n\t\t};\n\t\tfor (let property in constraints) {\n\t\t\tconst constraint = styles.getPropertyValue(property);\n\t\t\tif (constraint !== constraints[property]) {\n\t\t\t\tnode.style[property] = constraints[property];\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPosition(axis, node, objectPosition) {\n\t\tlet position, other, start, end, side;\n\t\tobjectPosition = objectPosition.split(' ');\n\t\tif (objectPosition.length < 2) {\n\t\t\tobjectPosition[1] = objectPosition[0];\n\t\t}\n\t\tif (axis === 'x') {\n\t\t\tposition = objectPosition[0];\n\t\t\tother = objectPosition[1];\n\t\t\tstart = 'left';\n\t\t\tend = 'right';\n\t\t\tside = node.clientWidth;\n\t\t} else if (axis === 'y') {\n\t\t\tposition = objectPosition[1];\n\t\t\tother = objectPosition[0];\n\t\t\tstart = 'top';\n\t\t\tend = 'bottom';\n\t\t\tside = node.clientHeight;\n\t\t} else {\n\t\t\treturn; // Neither x or y axis specified\n\t\t}\n\t\tif (position === start || other === start) {\n\t\t\tnode.style[start] = '0';\n\t\t\treturn;\n\t\t}\n\t\tif (position === end || other === end) {\n\t\t\tnode.style[end] = '0';\n\t\t\treturn;\n\t\t}\n\t\tif (position === 'center' || position === '50%') {\n\t\t\tnode.style[start] = '50%';\n\t\t\tnode.style['margin-' + start] = side / -2 + 'px';\n\t\t\treturn;\n\t\t}\n\t\t// Percentage values (e.g., 30% 10%)\n\t\tif (position.indexOf('%') !== -1) {\n\t\t\tposition = parseInt(position);\n\t\t\tif (position < 50) {\n\t\t\t\tnode.style[start] = position + '%';\n\t\t\t\tnode.style['margin-' + start] = side * (position / -100) + 'px';\n\t\t\t} else {\n\t\t\t\tposition = 100 - position;\n\t\t\t\tnode.style[end] = position + '%';\n\t\t\t\tnode.style['margin-' + end] = side * (position / -100) + 'px';\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\t// Length-based values (e.g. 10px / 10em)\n\t\t\tnode.style[start] = position;\n\t\t}\n\t\tnode.style.position = 'absolute';\n\t}\n\n\tstatic factory(DomService) {\n\t\treturn new ObjectFitDirective(DomService);\n\t}\n\n}\n\nObjectFitDirective.factory.$inject = ['DomService'];\n","export default class OverOnDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst selector = attributes.overOn;\n\t\tconst target = node.querySelector(selector);\n\t\tconst onOver = (event) => {\n\t\t\tnode.classList.add('over');\n\t\t}\n\t\tconst onOut = (event) => {\n\t\t\tnode.classList.remove('over');\n\t\t}\n\t\tif (target) {\n\t\t\ttarget.addEventListener('mouseover', onOver);\n\t\t\ttarget.addEventListener('mouseleave', onOut);\n\t\t\tscope.$on('$destroy', () => {\n\t\t\t\ttarget.removeEventListener('mouseover', onOver);\n\t\t\t\ttarget.removeEventListener('mouseleave', onOut);\n\t\t\t})\n\t\t}\n\t}\n\n\tstatic factory() {\n\t\treturn new OverOnDirective();\n\t}\n\n}\n\nOverOnDirective.factory.$inject = [];\n","import { distinctUntilChanged, filter, map } from 'rxjs/operators';\nimport Rect from '../shared/rect';\n\nconst isEdge = window.navigator.userAgent.indexOf('Edge') !== -1;\n\nexport default class ParallaxDirective {\n\n\tconstructor(\n\t\tDomService\n\t) {\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\treturn false; // !!! rimosso effetto parallasse\n\t\tconst node = element[0];\n\t\tconst childNode = node.querySelector(isEdge ? 'img' : 'img, video');\n\t\tif (childNode) {\n\t\t\tconst style = window.getComputedStyle(node);\n\t\t\tconst position = style.position;\n\t\t\tconst parallax = (parseInt(attributes.parallax) || 5) * 2;\n\t\t\tconst subscription = this.parallax$(node, parallax).subscribe(parallax => {\n\t\t\t\tif (position === 'absolute') {\n\t\t\t\t\tchildNode.setAttribute('style', `top: 50%; left: 50%; transform: translateX(-50%) translateY(${parallax.p}%) scale(${parallax.s}, ${parallax.s});`);\n\t\t\t\t} else {\n\t\t\t\t\tchildNode.setAttribute('style', `transform: translateX(0) translateY(${parallax.p+50}%) scale(${parallax.s}, ${parallax.s});`);\n\t\t\t\t}\n\t\t\t});\n\t\t\tscope.$on('$destroy', () => {\n\t\t\t\tsubscription.unsubscribe();\n\t\t\t});\n\t\t}\n\t}\n\n\tunits(value, decimals = 4) {\n\t\tconst pow = Math.pow(10, decimals) / 10;\n\t\treturn Math.round(value * pow) / pow;\n\t}\n\n\tparallax$(node, parallax) {\n\t\treturn this.domService.rafAndRect$().pipe(\n\t\t\tmap(datas => {\n\t\t\t\tconst windowRect = datas[1];\n\t\t\t\tconst rect = Rect.fromNode(node);\n\t\t\t\tconst intersection = rect.intersection(windowRect);\n\t\t\t\tif (intersection.y > 0) {\n\t\t\t\t\treturn Math.min(1, Math.max(-1, intersection.center.y)); // intersection.center.y;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}),\n\t\t\tfilter(y => y !== null),\n\t\t\tdistinctUntilChanged(),\n\t\t\tmap(y => {\n\t\t\t\tconst direction = 1; // i % 2 === 0 ? 1 : -1;\n\t\t\t\tconst s = (100 + parallax * 2) / 100;\n\t\t\t\tconst p = (-50 + (y * parallax * direction)); // .toFixed(3);\n\t\t\t\t// const y = Math.min(1, Math.max(-1, intersection.center.y));\n\t\t\t\t// const s = (100 + parallax * 2) / 100;\n\t\t\t\t// const p = (-50 + (y * parallax * direction)); // .toFixed(3);\n\t\t\t\treturn { s: this.units(s), p: this.units(p) };\n\t\t\t})\n\t\t);\n\t}\n\n\tstatic factory(DomService) {\n\t\treturn new ParallaxDirective(DomService);\n\t}\n\n}\n\nParallaxDirective.factory.$inject = ['DomService'];\n","export default class ScrollToDirective {\n\n\tconstructor(\n\t\tDomService\n\t) {\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst onClick = () => {\n\t\t\tconst selector = attributes.scrollTo;\n\t\t\tconst target = document.querySelector(selector);\n\t\t\tif (target) {\n\t\t\t\tconst top = target.getBoundingClientRect().top + this.domService.scrollTop - Number(attributes.offset || 0);\n\t\t\t\tif (!'scrollBehavior' in document.documentElement.style) {\n\t\t\t\t\twindow.scrollTo(0, top);\n\t\t\t\t} else {\n\t\t\t\t\twindow.scrollTo({ top, behavior: 'smooth' });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst addListeners = () => {\n\t\t\telement.on('click', onClick);\n\t\t};\n\n\t\tconst removeListeners = () => {\n\t\t\telement.off('click', onClick);\n\t\t};\n\n\t\tscope.$on('$destroy', function() {\n\t\t\tremoveListeners();\n\t\t});\n\n\t\taddListeners();\n\t}\n\n\tstatic factory(DomService) {\n\t\treturn new ScrollToDirective(DomService);\n\t}\n\n}\n\nScrollToDirective.factory.$inject = ['DomService'];\n","import { distinctUntilChanged } from \"rxjs/operators\";\n\nexport default class ScrollDirective {\n\n\t// @Output() public scroll = new EventEmitter();\n\n\tconstructor(\n\t\t$timeout,\n\t\tDomService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.domService = DomService;\n\t\t// this.require = 'ngModel';\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tif (attributes.scroll !== undefined) {\n\t\t\tconst node = element[0];\n\t\t\tthis.$timeout(() => {\n\t\t\t\tlet previous;\n\t\t\t\tconst subscription = this.domService.scrollIntersection$(node).pipe(\n\t\t\t\t\tdistinctUntilChanged((a, b) => {\n\t\t\t\t\t\tconst differs = b.scroll.scrollTop !== previous;\n\t\t\t\t\t\tprevious = b.scroll.scrollTop;\n\t\t\t\t\t\treturn !differs;\n\t\t\t\t\t})\n\t\t\t\t).subscribe(event => {\n\t\t\t\t\tconst callback = scope.$eval(attributes.scroll, { $event: event });\n\t\t\t\t\tif (typeof callback === 'function') {\n\t\t\t\t\t\tcallback(event);\n\t\t\t\t\t\t// scope.$eval(attributes.scroll, { $event: event });\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tscope.$on('$destroy', () => {\n\t\t\t\t\tsubscription.unsubscribe();\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t/*\n\t\tconst callback = scope.$eval(attributes.scroll);\n\t\tif (typeof callback === 'function') {\n\t\t\tconst subscription = this.domService.scroll$().subscribe(event => callback(event));\n\t\t\tscope.$on('$destroy', () => {\n\t\t\t\tsubscription.unsubscribe();\n\t\t\t});\n\t\t}\n\t\t*/\n\t}\n\n\tstatic factory($timeout, DomService) {\n\t\treturn new ScrollDirective($timeout, DomService);\n\t}\n\n}\n\nScrollDirective.factory.$inject = ['$timeout', 'DomService'];\n","import { tap } from 'rxjs/operators';\nimport Rect from '../shared/rect';\n\nexport default class StickyDirective {\n\n\tconstructor(\n\t\t$timeout,\n\t\tDomService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst content = node.querySelector('[sticky-content]');\n\t\tconst onClick = (event) => {\n\t\t\tconst isChild = this.domService.traverseUp(event.target, (node) => {\n\t\t\t\treturn node.classList && node.classList.contains('form__group');\n\t\t\t});\n\t\t\tif (isChild && window.innerWidth > 860) {\n\t\t\t\t// console.log('StickyDirective.onClick');\n\t\t\t\tconst top = this.domService.scrollTop + node.getBoundingClientRect().top;\n\t\t\t\twindow.scroll({\n\t\t\t\t\ttop: top,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tbehavior: 'smooth'\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tthis.$timeout(() => {\n\t\t\tconst subscription = this.scroll$(element, attributes).subscribe();\n\t\t\tcontent.addEventListener('click', onClick);\n\t\t\tscope.$on('$destroy', () => {\n\t\t\t\tsubscription.unsubscribe();\n\t\t\t\tcontent.removeEventListener('click', onClick);\n\t\t\t});\n\t\t});\n\t}\n\n\tscroll$(element, attributes) {\n\t\tconst node = element[0];\n\t\tconst content = node.querySelector('[sticky-content]');\n\t\tconst stickyTop = parseInt(attributes.sticky) || 0;\n\t\treturn this.domService.scroll$().pipe(\n\t\t\ttap(scroll => {\n\t\t\t\tlet rect = Rect.fromNode(node);\n\t\t\t\t// const maxtop = node.offsetHeight - content.offsetHeight;\n\t\t\t\t// top = Math.max(0, Math.min(maxtop, top - rect.top));\n\t\t\t\tconst maxTop = Math.max(0, stickyTop - rect.top);\n\t\t\t\t// content.setAttribute('style', `transform: translateY(${maxTop}px);`);\n\t\t\t\t// console.log(maxTop, stickyTop, rect.top);\n\t\t\t\tconst sticky = maxTop > 0;\n\t\t\t\tif (sticky !== element.sticky) {\n\t\t\t\t\telement.sticky = sticky;\n\t\t\t\t\tif (sticky) {\n\t\t\t\t\t\tnode.classList.add('sticky');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.classList.remove('sticky');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tscroll$_(element, attributes) {\n\t\tconst node = element[0];\n\t\tconst content = node.querySelector('[sticky-content]');\n\t\tconst stickyTop = parseInt(attributes.sticky) || 0;\n\t\treturn this.domService.raf$().pipe(\n\t\t\ttap(datas => {\n\t\t\t\tlet rect = Rect.fromNode(node);\n\t\t\t\t// const maxtop = node.offsetHeight - content.offsetHeight;\n\t\t\t\t// top = Math.max(0, Math.min(maxtop, top - rect.top));\n\t\t\t\tconst maxTop = Math.max(0, stickyTop - rect.top);\n\t\t\t\tcontent.setAttribute('style', `transform: translateY(${maxTop}px);`);\n\t\t\t\tconst sticky = maxTop > 0;\n\t\t\t\tif (sticky !== element.sticky) {\n\t\t\t\t\telement.sticky = sticky;\n\t\t\t\t\tif (sticky) {\n\t\t\t\t\t\tnode.classList.add('sticky');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.classList.remove('sticky');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t}\n\n\tstatic factory($timeout, DomService) {\n\t\treturn new StickyDirective($timeout, DomService);\n\t}\n\n}\n\nStickyDirective.factory.$inject = ['$timeout', 'DomService'];\n","const DEFAULT_SWIPER_OPTIONS = {\n\tslidesPerView: 'auto',\n\tspaceBetween: 1,\n\tcenteredSlides: true,\n\tloop: false,\n\tloopAdditionalSlides: 100,\n\tspeed: 600,\n\tautoplay: 5000,\n\tkeyboardControl: true,\n\tmousewheelControl: false,\n\tonSlideClick: function(swiper) {\n\t\tangular.element(swiper.clickedSlide).scope().clicked(angular.element(swiper.clickedSlide).scope().$index);\n\t},\n\tpagination: {\n\t\tel: '.swiper-pagination',\n\t\tclickable: true,\n\t},\n\tnavigation: {\n\t\tnextEl: '.swiper-button-next',\n\t\tprevEl: '.swiper-button-prev',\n\t},\n\tkeyboard: {\n\t\tenabled: true,\n\t\tonlyInViewport: true,\n\t},\n};\n\nexport class SwiperDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t\tthis.options = DEFAULT_SWIPER_OPTIONS;\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tif (window.matchMedia('print').matches) {\n\t\t\treturn;\n\t\t}\n\t\tconst onBeforePrint = () => {\n\t\t\tif (element.swiper) {\n\t\t\t\telement.swiper.destroy();\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('beforeprint', onBeforePrint);\n\t\tTweenMax.set(node, { opacity: 0 });\n\t\tscope.$on('lastItem', (slide) => {\n\t\t\tthis.onSwiper(scope, element, attributes);\n\t\t});\n\t\tscope.$on('$destroy', () => {\n\t\t\twindow.removeEventListener('beforeprint', onBeforePrint);\n\t\t\tif (element.swiper) {\n\t\t\t\telement.swiper.destroy();\n\t\t\t}\n\t\t});\n\t\tscope.$watch('$viewContentLoaded', () => {\n\t\t\tthis.onSwiper(scope, element, attributes);\n\t\t});\n\t\tscope.$on('onResize', ($scope) => {\n\t\t\tthis.onResize(scope, element, attributes);\n\t\t});\n\t\tthis.linked(scope, element, attributes, controller);\n\t}\n\n\tlinked(scope, element, attributes, controller) {\n\t\t// console.log('linked not overrided');\n\t}\n\n\tonResize(scope, element, attributes) {\n\t\tif (element.swiper) {\n\t\t\tArray.from(element[0].querySelectorAll('.swiper-slide')).forEach(node => node.setAttribute('style', ''));\n\t\t\telement.swiper.update();\n\t\t}\n\t}\n\n\tonSwiper(scope, element, attributes) {\n\t\tconst node = element[0];\n\t\t//const initialSlide = attributes.initialSlide !== undefined ? +attributes.initialSlide : 0;\n\t\tif (element.swiper) {\n\t\t\telement.swiper.update();\n\t\t} else {\n\t\t\t//this.options.initialSlide = initialSlide;\n\t\t\tlet swiper_;\n\t\t\tconst on = this.options.on || (this.options.on = {});\n\t\t\tconst callback = on.init;\n\t\t\tif (!on.init || !on.init.swiperDirectiveInit) {\n\t\t\t\ton.init = function() {\n\t\t\t\t\tTweenMax.to(node, 0.4, {\n\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\tease: Power2.easeOut,\n\t\t\t\t\t});\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tif (typeof callback === 'function') {\n\t\t\t\t\t\t\tcallback.apply(this, [swiper_, element, scope]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 1);\n\t\t\t\t};\n\t\t\t\ton.init.swiperDirectiveInit = true;\n\t\t\t}\n\t\t\tif (attributes.noLoop !== undefined) {\n\t\t\t\tthis.options.loop = false;\n\t\t\t}\n\t\t\t// console.log('attributes.noLoop', attributes.noLoop);\n\t\t\tTweenMax.set(node, { opacity: 1 });\n\t\t\tswiper_ = new Swiper(element, this.options);\n\t\t\telement.swiper = swiper_;\n\t\t\telement.swiper._opening = true;\n\t\t\telement.addClass('swiper-init');\n\t\t}\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperDirective();\n\t}\n\n}\n\nSwiperDirective.factory.$inject = [];\n\nexport class SwiperGalleryDirective extends SwiperDirective {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.options = {\n\t\t\tslidesPerView: 'auto',\n\t\t\tloopAdditionalSlides: 100,\n\t\t\tloop: true,\n\t\t\tcenteredSlides: false,\n\t\t\t// watchOverflow: true,\n\t\t\tspaceBetween: 1,\n\t\t\t// speed: 600,\n\t\t\t// autoplay: 5,\n\t\t\tkeyboardControl: true,\n\t\t\tmousewheelControl: false,\n\t\t\tonSlideClick: function(swiper) {\n\t\t\t\tangular.element(swiper.clickedSlide).scope().clicked(angular.element(swiper.clickedSlide).scope().$index);\n\t\t\t},\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t},\n\t\t\tnavigation: {\n\t\t\t\tnextEl: '.swiper-button-next',\n\t\t\t\tprevEl: '.swiper-button-prev',\n\t\t\t},\n\t\t\tkeyboard: {\n\t\t\t\tenabled: true,\n\t\t\t\tonlyInViewport: true,\n\t\t\t},\n\t\t};\n\t}\n\n\tonResize(scope, element, attributes) {\n\t\tif (element.swiper) {\n\t\t\tArray.from(element[0].querySelectorAll('.swiper-slide')).forEach(node => node.setAttribute('style', ''));\n\t\t\telement.swiper.params.slidesPerView = scope.zoomed ? 1 : 'auto';\n\t\t\telement.swiper.update();\n\t\t\tif (element.swiper._opening) {\n\t\t\t\telement.swiper._opening = false;\n\t\t\t\tconst initialSlide = attributes.initialSlide !== undefined ? +attributes.initialSlide : 0;\n\t\t\t\tif (initialSlide) {\n\t\t\t\t\telement.swiper.slideTo(initialSlide, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// console.log('SwiperGalleryDirective.onResize', scope.$id, scope.zoomed, attributes.index);\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperGalleryDirective();\n\t}\n\n}\n\nSwiperGalleryDirective.factory.$inject = [];\n\nexport class SwiperHeroDirective extends SwiperDirective {\n\n\tconstructor() {\n\t\tsuper();\n\t\tlet swiper_, element_, scope_;\n\t\tthis.options = {\n\t\t\tspeed: 600,\n\t\t\tparallax: true,\n\t\t\t/*\n\t\t\tautoplay: {\n\t\t\t\tdelay: 10000,\n\t\t\t},\n\t\t\t*/\n\t\t\tspaceBetween: 0,\n\t\t\tkeyboardControl: true,\n\t\t\tmousewheelControl: false,\n\t\t\tonSlideClick: function(swiper) {\n\t\t\t\tangular.element(swiper.clickedSlide).scope().clicked(angular.element(swiper.clickedSlide).scope().$index);\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tinit: (swiper, element, scope) => {\n\t\t\t\t\t// console.log('SwiperHeroDirective.init');\n\t\t\t\t\tif (!swiper_) {\n\t\t\t\t\t\tswiper_ = swiper;\n\t\t\t\t\t\telement_ = element;\n\t\t\t\t\t\tscope_ = scope;\n\t\t\t\t\t}\n\t\t\t\t\tscope_.$on('onThronCanPlay', ($scope, id) => {\n\t\t\t\t\t\t// console.log('SwiperHeroDirective.onThronCanPlay', id);\n\t\t\t\t\t\tthis.toggleVideo(element, scope, id);\n\t\t\t\t\t});\n\t\t\t\t\tscope_.$on('onThronComplete', ($scope, id) => {\n\t\t\t\t\t\t// console.log('SwiperHeroDirective.onThronComplete', id);\n\t\t\t\t\t\tthis.next(swiper_);\n\t\t\t\t\t});\n\t\t\t\t\t/*\n\t\t\t\t\tif (swiper_.autoplay) {\n\t\t\t\t\t\tswiper_.autoplay.start();\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\t\t\t\t},\n\t\t\t\tslideChangeTransitionStart: () => {\n\t\t\t\t\t// console.log('SwiperHeroDirective.slideChangeTransitionStart');\n\t\t\t\t\tif (element_) {\n\t\t\t\t\t\tthis.toggleVideo(element_, scope_);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tslideChangeTransitionEnd: () => {\n\t\t\t\t\t// console.log('SwiperHeroDirective.slideChangeTransitionEnd');\n\t\t\t\t\tif (element_) {\n\t\t\t\t\t\t// this.toggleVideo(element_, scope_);\n\t\t\t\t\t\tthis.checkAutoplay(element_, scope_, swiper_);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t},\n\t\t\tnavigation: {\n\t\t\t\tnextEl: '.swiper-button-next',\n\t\t\t\tprevEl: '.swiper-button-prev',\n\t\t\t},\n\t\t\tkeyboard: {\n\t\t\t\tenabled: true,\n\t\t\t\tonlyInViewport: true,\n\t\t\t},\n\t\t};\n\t}\n\n\ttoggleVideo(element, scope, id) {\n\t\tconst slides = [...element[0].querySelectorAll('.swiper-slide')];\n\t\tslides.forEach(slide => {\n\t\t\tconst node = slide.querySelector('video, [data-thron]');\n\t\t\tif (node) {\n\t\t\t\tif (slide.classList.contains('swiper-slide-active')) {\n\t\t\t\t\t// console.log('playing node', node);\n\t\t\t\t\tif (node.hasAttribute('data-thron')) {\n\t\t\t\t\t\t// console.log(id, node.id, id === node.id);\n\t\t\t\t\t\tif (id && id === node.id) {\n\t\t\t\t\t\t\tscope.$broadcast('playThron', node.id);\n\t\t\t\t\t\t} else if (!id) {\n\t\t\t\t\t\t\tscope.$broadcast('playThron', node.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.play();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (node.hasAttribute('data-thron')) {\n\t\t\t\t\t\tscope.$broadcast('pauseThron', node.id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.pause();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tcheckAutoplay(element, scope, swiper) {\n\t\tconst video = element[0].querySelector('.swiper-slide-active video, .swiper-slide-active [data-thron]');\n\t\tif (!video) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.next(swiper);\n\t\t\t\t// swiper.slideNext();\n\t\t\t}, 5000);\n\t\t}\n\t}\n\n\tnext(swiper) {\n\t\tif (swiper.realIndex == swiper.slides.length - 1) {\n\t\t\tswiper.slideTo(0);\n\t\t} else {\n\t\t\tswiper.slideNext();\n\t\t}\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperHeroDirective();\n\t}\n\n}\n\nSwiperHeroDirective.factory.$inject = [];\n\nexport class SwiperFocusDirective extends SwiperDirective {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.options = {\n\t\t\tspeed: 600,\n\t\t\tspaceBetween: 0,\n\t\t\tkeyboardControl: true,\n\t\t\tmousewheelControl: false,\n\t\t\tonSlideClick: function(swiper) {\n\t\t\t\tangular.element(swiper.clickedSlide).scope().clicked(angular.element(swiper.clickedSlide).scope().$index);\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tinit: function() {\n\t\t\t\t\tconst swiper = this;\n\t\t\t\t\tconst container = swiper.$el[0];\n\t\t\t\t\tconst tabs = [...container.querySelectorAll('.btn--tab')];\n\t\t\t\t\ttabs.forEach((tab, i) => i === 0 ? tab.classList.add('active') : tab.classList.remove('active'));\n\t\t\t\t},\n\t\t\t\tslideChange: function() {\n\t\t\t\t\tconst swiper = this;\n\t\t\t\t\tconst container = swiper.$el[0];\n\t\t\t\t\tconst tabs = [...container.querySelectorAll('.btn--tab')];\n\t\t\t\t\ttabs.forEach((tab, i) => i === swiper.activeIndex ? tab.classList.add('active') : tab.classList.remove('active'));\n\t\t\t\t},\n\t\t\t},\n\t\t\tnavigation: {\n\t\t\t\tnextEl: '.swiper-button-next',\n\t\t\t\tprevEl: '.swiper-button-prev',\n\t\t\t},\n\t\t\tkeyboard: {\n\t\t\t\tenabled: true,\n\t\t\t\tonlyInViewport: true,\n\t\t\t},\n\t\t};\n\t}\n\n\tlinked(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst tabs = [...node.querySelectorAll('.btn--tab')];\n\t\tconst onOver = (event) => {\n\t\t\tconst index = tabs.indexOf(event.currentTarget);\n\t\t\telement.swiper.slideTo(index, 1000, function() {\n\t\t\t\t// console.log('swiper.complete');\n\t\t\t});\n\t\t}\n\t\ttabs.forEach(tab => {\n\t\t\ttab.addEventListener('mouseover', onOver);\n\t\t});\n\t\tscope.$on('$destroy', () => {\n\t\t\ttabs.forEach(tab => {\n\t\t\t\ttab.removeEventListener('mouseover', onOver);\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperFocusDirective();\n\t}\n\n}\n\nSwiperFocusDirective.factory.$inject = [];\n\nexport class SwiperProjectsDirective extends SwiperDirective {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.options = {\n\t\t\tspeed: 600,\n\t\t\t// parallax: true,\n\t\t\t// autoplay: 5000,\n\t\t\t// loop: true,\n\t\t\tspaceBetween: 0,\n\t\t\tkeyboardControl: true,\n\t\t\tmousewheelControl: false,\n\t\t\tonSlideClick: function(swiper) {\n\t\t\t\tangular.element(swiper.clickedSlide).scope().clicked(angular.element(swiper.clickedSlide).scope().$index);\n\t\t\t},\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t},\n\t\t\tnavigation: {\n\t\t\t\tnextEl: '.swiper-button-next',\n\t\t\t\tprevEl: '.swiper-button-prev',\n\t\t\t},\n\t\t\tkeyboard: {\n\t\t\t\tenabled: true,\n\t\t\t\tonlyInViewport: true,\n\t\t\t},\n\t\t};\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperProjectsDirective();\n\t}\n\n}\n\nSwiperProjectsDirective.factory.$inject = [];\n\nexport class SwiperReferencesDirective extends SwiperDirective {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.options = {\n\t\t\tspeed: 600,\n\t\t\tspaceBetween: 0,\n\t\t\tkeyboardControl: true,\n\t\t\tmousewheelControl: false,\n\t\t\tonSlideClick: function(swiper) {\n\t\t\t\tangular.element(swiper.clickedSlide).scope().clicked(angular.element(swiper.clickedSlide).scope().$index);\n\t\t\t},\n\t\t\tnavigation: {\n\t\t\t\tnextEl: '.swiper-button-next',\n\t\t\t\tprevEl: '.swiper-button-prev',\n\t\t\t},\n\t\t\tkeyboard: {\n\t\t\t\tenabled: true,\n\t\t\t\tonlyInViewport: true,\n\t\t\t},\n\t\t};\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperReferencesDirective();\n\t}\n\n}\n\nSwiperReferencesDirective.factory.$inject = [];\n\nexport class SwiperTileDirective extends SwiperDirective {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.options = {\n\t\t\tspeed: 600,\n\t\t\tparallax: true,\n\t\t\tautoplay: 5000,\n\t\t\t// loop: true,\n\t\t\tspaceBetween: 60,\n\t\t\tkeyboardControl: true,\n\t\t\tmousewheelControl: false,\n\t\t\tonSlideClick: function(swiper) {\n\t\t\t\tangular.element(swiper.clickedSlide).scope().clicked(angular.element(swiper.clickedSlide).scope().$index);\n\t\t\t},\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t\tdynamicBullets: true,\n\t\t\t},\n\t\t\tnavigation: {\n\t\t\t\tnextEl: '.swiper-button-next',\n\t\t\t\tprevEl: '.swiper-button-prev',\n\t\t\t},\n\t\t\tkeyboard: {\n\t\t\t\tenabled: true,\n\t\t\t\tonlyInViewport: true,\n\t\t\t},\n\t\t};\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperTileDirective();\n\t}\n\n}\n\nSwiperTileDirective.factory.$inject = [];\n\nexport class SwiperTimelineDirective extends SwiperDirective {\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.options = {\n\t\t\tslidesPerView: 1,\n\t\t\tspaceBetween: 60,\n\t\t\tspeed: 600,\n\t\t\tautoplay: 5000,\n\t\t\tkeyboardControl: true,\n\t\t\tmousewheelControl: false,\n\t\t\ton: {\n\t\t\t\tinit: function() {\n\t\t\t\t\tconst swiper = this;\n\t\t\t\t\tconst container = swiper.$el[0];\n\t\t\t\t\tconst lis = [...container.querySelectorAll('.nav--timeline>li')];\n\t\t\t\t\tlis.forEach((x, i) => {\n\t\t\t\t\t\tx.addEventListener('click', () => {\n\t\t\t\t\t\t\tswiper.slideTo(i, 600);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t},\n\t\t\t\tslideChange: function() {\n\t\t\t\t\tconst swiper = this;\n\t\t\t\t\tconst container = swiper.$el[0];\n\t\t\t\t\tconst lis = [...container.querySelectorAll('.nav--timeline>li')];\n\t\t\t\t\tlis.forEach((x, i) => {\n\t\t\t\t\t\tif (i === swiper.activeIndex) {\n\t\t\t\t\t\t\tx.classList.add('active');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tx.classList.remove('active');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t},\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tdynamicBullets: true,\n\t\t\t},\n\t\t\tkeyboard: {\n\t\t\t\tenabled: true,\n\t\t\t\tonlyInViewport: true,\n\t\t\t},\n\t\t};\n\t}\n\n\tstatic factory() {\n\t\treturn new SwiperTimelineDirective();\n\t}\n\n}\n\nSwiperTimelineDirective.factory.$inject = [];\n","let ID = 0;\n\nexport default class ThronDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst THRON = window.THRONContentExperience || window.THRONPlayer;\n\t\tif (!THRON) {\n\t\t\treturn;\n\t\t}\n\t\tconst node = element[0];\n\t\tnode.id = `thron-${++ID}`;\n\t\tconst player = THRON(node.id, {\n\t\t\tmedia: node.getAttribute('data-thron'),\n\t\t\tloop: node.hasAttribute('loop'),\n\t\t\tautoplay: node.hasAttribute('autoplay'),\n\t\t\tmuted: true,\n\t\t\tdisplayLinked: 'close',\n\t\t\tnoSkin: true,\n\t\t\t// lockBitrate: 'max',\n\t\t});\n\t\tconst onReady = function() {\n\t\t\t// console.log('ThronDirective.onReady', node.id);\n\t\t\tconst mediaContainer = player.mediaContainer();\n\t\t\tconst video = mediaContainer.querySelector('video');\n\t\t\tvideo.setAttribute('playsinline', 'true');\n\t\t\tscope.$emit('onThronReady', node.id);\n\t\t\t// video.setAttribute('autoplay', 'true');\n\t\t};\n\t\tconst onCanPlay = function() {\n\t\t\t// console.log('ThronDirective.onCanPlay', node.id);\n\t\t\tscope.$emit('onThronCanPlay', node.id);\n\t\t}\n\t\tconst onPlaying = function() {\n\t\t\tplayer.off('playing', onPlaying);\n\t\t\tconst qualities = player.qualityLevels();\n\t\t\t// console.log('ThronDirective.onPlaying', node.id, qualities);\n\t\t\tif (qualities.length) {\n\t\t\t\tconst highestQuality = qualities[qualities.length - 1].index;\n\t\t\t\tconst lowestQuality = qualities[0].index;\n\t\t\t\tplayer.currentQuality(highestQuality);\n\t\t\t\t// console.log('ThronDirective.onPlaying', node.id, 'currentQuality', player.currentQuality());\n\t\t\t}\n\t\t};\n\t\tconst onComplete = function() {\n\t\t\t// console.log('ThronDirective.onComplete', node.id);\n\t\t\tscope.$emit('onThronComplete', node.id);\n\t\t};\n\t\tconst playVideo = function() {\n\t\t\tconst status = player.status();\n\t\t\t// console.log('ThronDirective.playVideo', node.id, status);\n\t\t\tif (status && !status.playing) {\n\t\t\t\tplayer.play();\n\t\t\t}\n\t\t};\n\t\tconst pauseVideo = function() {\n\t\t\tconst status = player.status();\n\t\t\t// console.log('ThronDirective.pauseVideo', node.id, status);\n\t\t\tif (status && status.playing) {\n\t\t\t\tplayer.pause();\n\t\t\t}\n\t\t};\n\t\tplayer.on('ready', onReady);\n\t\tplayer.on('canPlay', onCanPlay);\n\t\tplayer.on('playing', onPlaying);\n\t\tplayer.on('complete', onComplete);\n\t\tscope.$on('playThron', ($scope, id) => {\n\t\t\t// console.log('ThronDirective.playThron', id, node.id, id === node.id);\n\t\t\tif (id === node.id) {\n\t\t\t\tplayVideo();\n\t\t\t}\n\t\t});\n\t\tscope.$on('pauseThron', ($scope, id) => {\n\t\t\t// console.log('ThronDirective.pauseThron', id, node.id, id === node.id);\n\t\t\tif (id === node.id) {\n\t\t\t\tpauseVideo();\n\t\t\t}\n\t\t});\n\t\tscope.$on('$destroy', () => {\n\t\t\tplayer.off('ready', onReady);\n\t\t\tplayer.off('canPlay', onCanPlay);\n\t\t\tplayer.off('playing', onPlaying);\n\t\t\tplayer.off('complete', onComplete);\n\t\t});\n\t}\n\n\tstatic factory() {\n\t\treturn new ThronDirective();\n\t}\n\n}\n\nThronDirective.factory.$inject = [];\n","import GtmService from '../gtm/gtm.service';\n\nexport default class VideoDirective {\n\n\tconstructor(\n\t\t$timeout,\n\t\tWishlistService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.wishlistService = WishlistService;\n\t\tthis.restrict = 'A';\n\t\tthis.transclude = true;\n\t\tthis.template = `<div class=\"media\">\n\t<ng-transclude></ng-transclude>\n</div>\n<div class=\"overlay\" ng-click=\"onOverlay($event)\"></div>\n<div class=\"btn btn--play\" ng-class=\"{ playing: playing }\">\n\t<svg class=\"icon icon--play-progress-background\"><use xlink:href=\"#play-progress\"></use></svg>\n\t<svg class=\"icon icon--play-progress\" viewBox=\"0 0 196 196\">\n\t\t<path xmlns=\"http://www.w3.org/2000/svg\" stroke-width=\"2px\" stroke-dasharray=\"1\" stroke-dashoffset=\"1\" pathLength=\"1\" stroke-linecap=\"square\" d=\"M195.5,98c0,53.8-43.7,97.5-97.5,97.5S0.5,151.8,0.5,98S44.2,0.5,98,0.5S195.5,44.2,195.5,98z\"/>\n\t</svg>\n\t<svg class=\"icon icon--play\" ng-if=\"!playing\"><use xlink:href=\"#play\"></use></svg>\n\t<svg class=\"icon icon--play\" ng-if=\"playing\"><use xlink:href=\"#pause\"></use></svg>\n</div><div class=\"btn btn--pinterest\" ng-click=\"onPin()\" ng-if=\"onPin\">\n<svg class=\"icon icon--pinterest\"><use xlink:href=\"#pinterest\"></use></svg>\n</div>\n<div class=\"btn btn--wishlist\" ng-class=\"{ active: wishlistActive, activated: wishlistActivated, deactivated: wishlistDeactivated }\" ng-click=\"onClickWishlist($event)\">\n\t<svg class=\"icon icon--wishlist\" ng-if=\"!wishlistActive\"><use xlink:href=\"#wishlist\"></use></svg>\n\t<svg class=\"icon icon--wishlist\" ng-if=\"wishlistActive\"><use xlink:href=\"#wishlist-added\"></use></svg>\n</div>\n<div class=\"btn btn--zoom\" ng-click=\"onClickZoom($event)\">\n\t<svg class=\"icon icon--zoom\"><use xlink:href=\"#zoom\"></use></svg>\n</div>`;\n\t\tthis.scope = {\n\t\t\titem: '=?video',\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tscope.item = scope.item || {};\n\t\tconst node = element[0];\n\t\tconst video = node.querySelector('video');\n\t\tif (video) {\n\t\t\tconst pageTitle = document.title;\n\t\t\tscope.onPin = () => {\n\t\t\t\tconst pin = {\n\t\t\t\t\turl: window.location.href,\n\t\t\t\t\tmedia: video.poster,\n\t\t\t\t\tdescription: video.title || pageTitle,\n\t\t\t\t};\n\n\t\t\t\tGtmService.push({\n\t\t\t\t\tevent: 'Pinterest',\n\t\t\t\t\twish_name: scope.item.name || scope.item.coId,\n\t\t\t\t\twish_type: scope.item.typeName || scope.item.type\n\t\t\t\t});\n\n\t\t\t\t// console.log('VideoDirective.onPin', pin);\n\t\t\t\tPinUtils.pinOne(pin);\n\t\t\t};\n\t\t}\n\t\tconst progress = node.querySelector('.icon--play-progress path');\n\t\tscope.item = scope.item || {};\n\t\tscope.onOverlay = (event) => {\n\t\t\tif (video) {\n\t\t\t\tif (video.paused) {\n\t\t\t\t\tconst gallery = document.querySelector('.section--gallery');\n\t\t\t\t\tvideo.muted = gallery ? false : true;\n\t\t\t\t\tvideo.play();\n\t\t\t\t} else {\n\t\t\t\t\tvideo.pause();\n\t\t\t\t}\n\t\t\t}\n\t\t\t/*\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopImmediatePropagation();\n\t\t\t*/\n\t\t};\n\t\tconst onPlay = () => {\n\t\t\tthis.$timeout(() => {\n\t\t\t\tscope.playing = true;\n\t\t\t});\n\t\t};\n\t\tconst onPlayGtm = () => {\n\t\t\tconst sources = video.querySelectorAll('source');\n\t\t\tif (sources.length) {\n\t\t\t\tconst src = sources[sources.length - 1].getAttribute('src');\n\t\t\t\tif (src)\n\t\t\t\t\tGtmService.push({\n\t\t\t\t\t\tevent: 'video play',\n\t\t\t\t\t\tvideo_name: src\n\t\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst onPause = () => {\n\t\t\tthis.$timeout(() => {\n\t\t\t\tscope.playing = false;\n\t\t\t});\n\t\t};\n\t\tconst onEnded = () => {\n\t\t\tthis.$timeout(() => {\n\t\t\t\tscope.playing = false;\n\t\t\t});\n\t\t};\n\t\tconst onTimeUpdate = () => {\n\t\t\t// console.log(video.currentTime, video.duration);\n\t\t\tprogress.style.strokeDashoffset = video.currentTime / video.duration;\n\t\t};\n\t\tscope.$watch(() => {\n\t\t\treturn this.wishlistService.has(scope.item);\n\t\t}, (current, previous) => {\n\t\t\t// console.log(current, previous, node);\n\t\t\tif (scope.wishlistActive !== current) {\n\t\t\t\tscope.wishlistActive = current;\n\t\t\t\tif (current) {\n\t\t\t\t\tscope.wishlistActivated = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.wishlistActivated = false;\n\t\t\t\t\t}, 2000);\n\t\t\t\t} else {\n\t\t\t\t\tscope.wishlistDeactivated = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.wishlistDeactivated = false;\n\t\t\t\t\t}, 2000);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tscope.onClickWishlist = (event) => {\n\t\t\tthis.wishlistService.toggle(scope.item).then(\n\t\t\t\t(has) => {\n\t\t\t\t\tconsole.log('VideoDirective.onClickWishlist', has);\n\t\t\t\t},\n\t\t\t\t(error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t}\n\t\t\t);\n\t\t\t// event.preventDefault();\n\t\t\t// event.stopPropagation();\n\n\t\t};\n\t\tscope.onClickZoom = (event) => {\n\t\t\tif (scope.$root.gallery) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tscope.$root.gallery = null;\n\t\t\t\t});\n\t\t\t} else if (node.classList.contains('picture--vertical') || node.classList.contains('picture--horizontal') || node.classList.contains('picture--square')) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tlet index = 0;\n\t\t\t\t\tconst items = [...document.querySelectorAll('.picture--vertical[media], .picture--vertical[video], .picture--horizontal[media], .picture--horizontal[video], .picture--square[media], .picture--square[video]')].map((itemNode, i) => {\n\t\t\t\t\t\tif (itemNode == node) {\n\t\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst item = {};\n\t\t\t\t\t\titem.type = itemNode.hasAttribute('media') ? 'media' : 'video';\n\t\t\t\t\t\tif (item.type === 'media') {\n\t\t\t\t\t\t\tconst img = itemNode.querySelector('img');\n\t\t\t\t\t\t\titem.src = img.getAttribute('src') || img.getAttribute('data-src');\n\t\t\t\t\t\t\titem.title = img.getAttribute('alt');\n\t\t\t\t\t\t\tconst wishlist = itemNode.getAttribute('media');\n\t\t\t\t\t\t\tif (wishlist) {\n\t\t\t\t\t\t\t\titem.wishlist = this.eval(wishlist); // JSON.parse(wishlist.indexOf('\"') === -1 ? wishlist.split(/[^\\d\\W]+/g).join('\"') : wishlist);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst video = itemNode.querySelector('video');\n\t\t\t\t\t\t\tconst sources = video.querySelectorAll('source');\n\t\t\t\t\t\t\titem.poster = video.getAttribute('poster');\n\t\t\t\t\t\t\titem.src = sources[sources.length - 1].getAttribute('src');\n\t\t\t\t\t\t\titem.title = video.getAttribute('alt');\n\t\t\t\t\t\t\tconst wishlist = itemNode.getAttribute('video');\n\t\t\t\t\t\t\tif (wishlist) {\n\t\t\t\t\t\t\t\titem.wishlist = this.eval(wishlist); // JSON.parse(wishlist.indexOf('\"') === -1 ? wishlist.split(/[^\\d\\W]+/g).join('\"') : wishlist);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t});\n\t\t\t\t\tscope.$root.gallery = {\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\titems,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t\t// event.preventDefault();\n\t\t\t// event.stopPropagation();\n\t\t};\n\t\tif (video) {\n\t\t\tvideo.addEventListener('play', onPlay);\n\t\t\tvideo.addEventListener('play', onPlayGtm);\n\t\t\tvideo.addEventListener('pause', onPause);\n\t\t\tvideo.addEventListener('ended', onEnded);\n\t\t\tvideo.addEventListener('timeupdate', onTimeUpdate);\n\t\t}\n\t\tscope.$on('$destroy', () => {\n\t\t\tif (video) {\n\t\t\t\t// console.log('VideoDirective.$destroy');\n\t\t\t\tvideo.removeEventListener('play', onPlay);\n\t\t\t\tvideo.removeEventListener('play', onPlayGtm);\n\t\t\t\tvideo.removeEventListener('pause', onPause);\n\t\t\t\tvideo.removeEventListener('ended', onEnded);\n\t\t\t\tvideo.removeEventListener('timeupdate', onTimeUpdate);\n\t\t\t}\n\t\t});\n\t}\n\n\teval(string) {\n\t\treturn new Function(`() => {\n\t\t\treturn ${string};\n\t\t}`)();\n\t}\n\n\tstatic factory($timeout, WishlistService) {\n\t\treturn new VideoDirective($timeout, WishlistService);\n\t}\n\n}\n\nVideoDirective.factory.$inject = ['$timeout', 'WishlistService'];\n","import GtmService from '../gtm/gtm.service';\n\nexport default class VisibilityDirective {\n\n\tconstructor(\n\t\tDomService\n\t) {\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst subscription = this.domService.firstVisibility$(node).subscribe(visible => {\n\t\t\t// console.log('visibility', attributes.visibility, node.classList);\n\t\t\tconst gtmEvent = {\n\t\t\t\tevent: 'ElementVisibilityCustomEvent',\n\t\t\t\telement: attributes.visibility,\n\t\t\t\tclasses: node.getAttribute('class'),\n\t\t\t};\n\t\t\t// console.log(gtmEvent);\n\t\t\tGtmService.push(gtmEvent);\n\t\t});\n\t\tscope.$on('$destroy', () => {\n\t\t\tsubscription.unsubscribe();\n\t\t});\n\t}\n\n\tstatic factory(DomService) {\n\t\treturn new VisibilityDirective(DomService);\n\t}\n\n}\n\nVisibilityDirective.factory.$inject = ['DomService'];\n","export default class WishlistDirective {\n\n\tconstructor(\n\t\t$timeout,\n\t\tWishlistService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.wishlistService = WishlistService;\n\t\tthis.restrict = 'E';\n\t\tthis.scope = {\n\t\t\titem: '=',\n\t\t};\n\t\tthis.transclude = true;\n\t\tthis.template = `<div class=\"btn btn--wishlist\" ng-class=\"{ active: wishlistActive, activated: wishlistActivated, deactivated: wishlistDeactivated }\" ng-click=\"onClickWishlist($event)\">\n\t\t<svg class=\"icon icon--wishlist\" ng-if=\"!wishlistActive\"><use xlink:href=\"#wishlist\"></use></svg>\n\t\t<svg class=\"icon icon--wishlist\" ng-if=\"wishlistActive\"><use xlink:href=\"#wishlist-added\"></use></svg>\n\t\t<ng-transclude></ng-transclude>\n\t</div>`;\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tscope.item = scope.item || {};\n\t\tscope.$watch(() => {\n\t\t\treturn this.wishlistService.has(scope.item);\n\t\t}, (current, previous) => {\n\t\t\t// console.log(current, previous, node);\n\t\t\tif (scope.wishlistActive !== current) {\n\t\t\t\tscope.wishlistActive = current;\n\t\t\t\tif (current) {\n\t\t\t\t\tscope.wishlistActivated = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.wishlistActivated = false;\n\t\t\t\t\t}, 2000);\n\t\t\t\t} else {\n\t\t\t\t\tscope.wishlistDeactivated = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.wishlistDeactivated = false;\n\t\t\t\t\t}, 2000);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tscope.onClickWishlist = (event) => {\n\t\t\tthis.wishlistService.toggle(scope.item).then(\n\t\t\t\t(has) => {\n\t\t\t\t\tconsole.log('WishlistDirective.onClickWishlist', has);\n\t\t\t\t},\n\t\t\t\t(error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t}\n\t\t\t);\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t};\n\t\tscope.$on('$destroy', () => {});\n\t}\n\n\tstatic factory($timeout, WishlistService) {\n\t\treturn new WishlistDirective($timeout, WishlistService);\n\t}\n\n}\n\nWishlistDirective.factory.$inject = ['$timeout', 'WishlistService'];\n","// let INDEX = 0;\n\nexport default class WorldDirective {\n\n\t// src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" lazy lazy-src=\"\n\n\tconstructor(\n\t\t$timeout,\n\t\tDomService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\t\tconst img = node.querySelector('img');\n\t\tconst nodePoints = node.querySelector('.points');\n\t\tconst /*onEnter*/ onClick = (event) => {\n\t\t\tevent.stopImmediatePropagation();\n\t\t\t[...node.querySelectorAll('.world__point')].forEach(x => {\n\t\t\t\tif (x === event.currentTarget) {\n\t\t\t\t\tx.classList.add('active');\n\t\t\t\t} else {\n\t\t\t\t\tx.classList.remove('active');\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tconst onLeave = (event) => {\n\t\t\tevent.currentTarget.parentNode.classList.remove('active');\n\t\t};\n\t\timg.onload = () => {\n\t\t\tconst offices = window.offices;\n\t\t\tconst w = node.offsetWidth;\n\t\t\tconst h = node.offsetHeight;\n\t\t\tconst points = offices.forEach(x => {\n\t\t\t\tconst position = x.position;\n\t\t\t\tconst latitude = position.latitude;\n\t\t\t\tconst top = (h * 1.169) / 180 * (-latitude + 90);\n\t\t\t\tconst longitude = position.longitude;\n\t\t\t\tconst left = w / 360 * (longitude + 180) - 30;\n\t\t\t\tconst pointNode = this.makePoint(x);\n\t\t\t\tTweenMax.set(pointNode, { top: (top / h * 100) + '%', left: (left / w * 100) + '%' });\n\t\t\t\tnodePoints.appendChild(pointNode);\n\t\t\t\tnode.addEventListener('click', onClick);\n\t\t\t\tpointNode.addEventListener('click', onClick);\n\t\t\t\t//pointNode.addEventListener('mouseenter', onEnter);\n\t\t\t\t//const pointInfoNode = pointNode.querySelector('.world__info');\n\t\t\t\t//pointInfoNode.addEventListener('mouseleave', onLeave);\n\t\t\t});\n\t\t};\n\t\tscope.$on('$destroy', () => {\n\t\t\tnode.removeEventListener('click', onClick);\n\t\t\t[...node.querySelectorAll('.world__point')].forEach(node => {\n\t\t\t\tnode.removeEventListener('click', onClick);\n\t\t\t});\n\t\t\t//[...node.querySelectorAll('.world__point')].forEach(node => {\n\t\t\t//\tnode.removeEventListener('mouseenter', onEnter);\n\t\t\t//});\n\t\t\t//[...node.querySelectorAll('.world__point .world__info')].forEach(node => {\n\t\t\t//\tnode.removeEventListener('mouseleave', onLeave);\n\t\t\t//});\n\t\t});\n\t}\n\n\tmakePoint(point) {\n\t\tconst pointNode = document.createElement('div');\n\t\tpointNode.classList.add('world__point');\n\t\tif (point.headquarter) {\n\t\t\tpointNode.classList.add('world__point--headquarter');\n\t\t}\n\t\tlet cta = point.url ? `\n\t\t<div class=\"group group--cta\">\n\t\t\t<a href=\"${point.url}\" class=\"btn btn--link\"><span>${window.BOMLabels.More_info}</span></a>\n\t\t</div>\n\t\t` : '';\n\t\tpointNode.innerHTML = `\n\t\t<div class=\"world__info\">\n\t\t\t<div><span class=\"city\">${point.city}</span> <span class=\"country\">${point.country}</span></div>\n\t\t\t<div class=\"abstract\">${point.abstract}</div>\n\t\t\t${cta}\n\t\t</div>\n\t\t`;\n\t\treturn pointNode;\n\t}\n\n\tstatic factory($timeout, DomService) {\n\t\treturn new WorldDirective($timeout, DomService);\n\t}\n\n}\n\nWorldDirective.factory.$inject = ['$timeout', 'DomService'];\n","import Rect from '../shared/rect';\n\n// let INDEX = 0;\n\nexport default class ZoomableDirective {\n\n\t// src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" lazy lazy-src=\"\n\n\tconstructor(\n\t\t$timeout,\n\t\tDomService\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tlet triggers, rect;\n\t\tconst node = element[0];\n\t\tconst content = node.querySelector('.zoomable__content');\n\t\tconst onClose = () => {\n\t\t\tif (node.classList.contains('zoomed')) {\n\t\t\t\tthis.zoomOut(scope, node, content, rect);\n\t\t\t\tif (attributes.zoomed !== undefined) {\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.$root.gallery = null;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconst onOpen = () => {\n\t\t\tif (!node.classList.contains('zoomed')) {\n\t\t\t\trect = Rect.fromNode(node);\n\t\t\t\tthis.zoomIn(scope, node, content, rect);\n\t\t\t}\n\t\t};\n\t\tconst onClick = () => {\n\t\t\t// const slides = [...node.querySelectorAll('.swiper-slide')];\n\t\t\tif (node.classList.contains('zoomed')) {\n\t\t\t\tthis.zoomOut(scope, node, content, rect);\n\t\t\t\tif (attributes.zoomed !== undefined) {\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tscope.$root.gallery = null;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trect = Rect.fromNode(node);\n\t\t\t\tthis.zoomIn(scope, node, content, rect);\n\t\t\t}\n\t\t};\n\t\tconst addListeners = () => {\n\t\t\tconst close = node.querySelector('.zoomable__close');\n\t\t\tif (close) {\n\t\t\t\tclose.addEventListener('click', onClose);\n\t\t\t}\n\t\t\ttriggers = [...node.querySelectorAll('.zoomable__trigger')];\n\t\t\t// console.log('ZoomableDirective', node, content, triggers);\n\t\t\ttriggers.forEach(x => x.addEventListener('click', onClick));\n\t\t};\n\t\tconst removeListeners = () => {\n\t\t\tconst close = node.querySelector('.zoomable__close');\n\t\t\tif (close) {\n\t\t\t\tclose.removeEventListener('click', onClose);\n\t\t\t}\n\t\t\tif (triggers) {\n\t\t\t\ttriggers.forEach(x => x.removeEventListener('click', onClick));\n\t\t\t}\n\t\t};\n\t\tscope.$on('lastItem', ($scope, item) => {\n\t\t\t// console.log('lastItem');\n\t\t\tremoveListeners();\n\t\t\taddListeners();\n\t\t});\n\t\tthis.$timeout(() => {\n\t\t\taddListeners();\n\t\t});\n\t\tscope.$on('$destroy', () => {\n\t\t\ttriggers.forEach(x => x.removeEventListener('click', onClick));\n\t\t});\n\t\tconsole.log('ZoomableDirective', scope.$id);\n\t\tscope.onZoom = (item) => {\n\t\t\tconst rect = Rect.fromNode(content);\n\t\t\tconsole.log('ZoomableDirective.onZoom', scope.zoomed);\n\t\t\tTweenMax.set(node, { height: rect.height });\n\t\t\tthis.$timeout(() => {\n\t\t\t\tscope.zoomed = !scope.zoomed;\n\t\t\t});\n\t\t\t/*\n\t\t\tTweenMax.to(u, 0.50, {\n\t\t\t\tscaleX: 1,\n\t\t\t\ttransformOrigin: '0 50%',\n\t\t\t\tdelay: 0,\n\t\t\t\tease: Power3.easeInOut,\n\t\t\t\toverwrite: 'all',\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tTweenMax.set(u, { transformOrigin: '100% 50%', scaleX: 1 });\n\t\t\t\t\tTweenMax.to(u, 0.50, {\n\t\t\t\t\t\tscaleX: 0,\n\t\t\t\t\t\ttransformOrigin: '100% 50%',\n\t\t\t\t\t\tdelay: 1.0,\n\t\t\t\t\t\tease: Power3.easeInOut,\n\t\t\t\t\t\toverwrite: 'all',\n\t\t\t\t\t\tonComplete: () => {\n\t\t\t\t\t\t\tanimate();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\t*/\n\t\t};\n\t\tif (attributes.zoomed !== undefined) {\n\t\t\tonOpen();\n\t\t}\n\t}\n\n\tzoomIn(scope, node, content, rect) {\n\t\t// TweenMax.set(node, { height: rect.height });\n\t\t// TweenMax.set(content, { left: rect.left, top: rect.top, width: rect.width, height: rect.height });\n\t\tnode.classList.add('zoomed');\n\t\tscope.zoomed = true;\n\t\t// TweenMax.set(content, { left: 0, top: 0, width: '100%', height: '100%' });\n\t\tsetTimeout(() => {\n\t\t\tscope.$broadcast('onResize', scope.zoomed);\n\t\t}, 1);\n\t\t// scope.$emit('onDroppinIn', true);\n\t}\n\n\tzoomOut(scope, node, content, rect) {\n\t\t// TweenMax.set(node, { height: 'auto' });\n\t\t// TweenMax.set(content, { clearProps: 'all' });\n\t\tnode.classList.remove('zoomed');\n\t\tscope.zoomed = false;\n\t\tsetTimeout(() => {\n\t\t\tscope.$broadcast('onResize', scope.zoomed);\n\t\t}, 1);\n\t\t// scope.$emit('onDroppinIn', false);\n\t}\n\n\tzoomInAnimated(scope, node, content, rect) {\n\t\tTweenMax.set(node, { height: rect.height });\n\t\tTweenMax.set(content, { left: rect.left, top: rect.top, width: rect.width, height: rect.height });\n\t\tnode.classList.add('zoomed');\n\t\tscope.$emit('onDroppinIn', true);\n\t\tTweenMax.to(content, 0.3, {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: '100%',\n\t\t\theight: '100%',\n\t\t\tease: Expo.easeInOut,\n\t\t\t// ease: CustomEase.create('custom', 'M0,0,C0.596,0,0.346,1,1,1'),\n\t\t\tonUpdate: () => {\n\t\t\t\t// window.dispatchEvent(new Event('resize'));\n\t\t\t\t// slides.forEach(x => x.style.width = content.style.width);\n\t\t\t\tscope.$broadcast('onResize');\n\t\t\t},\n\t\t\tonComplete: () => {\n\t\t\t\t// scope.$broadcast('onResize');\n\t\t\t}\n\t\t});\n\t}\n\n\tzoomOutAnimated(scope, node, content, rect) {\n\t\tTweenMax.to(content, 0.3, {\n\t\t\tleft: rect.left,\n\t\t\ttop: rect.top,\n\t\t\twidth: rect.width,\n\t\t\theight: rect.height,\n\t\t\tease: Expo.easeInOut,\n\t\t\t// ease: CustomEase.create('custom', 'M0,0,C0.596,0,0.346,1,1,1'),\n\t\t\tonUpdate: () => {\n\t\t\t\tscope.$broadcast('onResize');\n\t\t\t},\n\t\t\tonComplete: () => {\n\t\t\t\tTweenMax.set(node, { height: 'auto' });\n\t\t\t\tTweenMax.set(content, { left: rect.left, top: rect.top, width: rect.width, height: rect.height });\n\t\t\t\tnode.classList.remove('zoomed');\n\t\t\t\tscope.$emit('onDroppinIn', false);\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic factory($timeout, DomService) {\n\t\treturn new ZoomableDirective($timeout, DomService);\n\t}\n\n}\n\nZoomableDirective.factory.$inject = ['$timeout', 'DomService'];\n","import GtmService from '../gtm/gtm.service';\n\nconst GTM_EVENT = 'ricerca-homepage';\n\nclass EffectsCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.collectionsUrl = window.collectionsUrl;\n\t\tthis.filters = window.filters || {};\n\t\tthis.collections = this.filters.collections || { options: [] };\n\t\tthis.looks = this.filters.looks || { options: [] };\n\t}\n\n\tsetFilter(item, filter) {\n\t\tfilter = filter || window.filters.collections;\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t\titem = item || filter.options[0];\n\t\tfilter.value = item.value;\n\n\t\tif (filter === this.looks) {\n\t\t\tthis.track('collections-_look-Effetto' + item.key);\n\t\t} else {\n\t\t\tif (filter === this.collections) {\n\t\t\t\tthis.track('collections-' + item.key + '-');\n\t\t\t}\n\t\t}\n\n\t\tthis.navToCollections();\n\t}\n\n\tnavToCollections() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[x] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\tconst serialized = this.locationService.serialize_('filters', filters);\n\t\twindow.location.href = this.collectionsUrl + '?q=' + serialized;\n\t}\n\n\ttrack(queryhp) {\n\t\tGtmService.push({\n\t\t\t\"queryhp\": queryhp,\n\t\t\t\"event\": GTM_EVENT\n\t\t});\n\t}\n}\n\nEffectsCtrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default EffectsCtrl;\n","import { fromEvent, Subject } from 'rxjs';\nimport { debounceTime, map, shareReplay, takeUntil } from 'rxjs/operators';\nimport GtmService from '../gtm/gtm.service';\n\nconst GTM_CAT = 'faq';\n\nclass FaqCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tDomService,\n\t\tApiService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.domService = DomService;\n\t\tthis.apiService = ApiService;\n\t\tthis.faqCategories = window.faqCategories || [];\n\t\tthis.faqCategories.forEach(x => {\n\t\t\tif (!x.items) x.items = [];\n\t\t});\n\t\t// eliminare!\n\t\t//this.faqCategories.forEach(x => x.items.forEach(i => Math.random() > 0.5 ? delete i.url : null));\n\t\t//\n\t\tthis.filteredFaqCategories = this.faqCategories.slice();\n\t\tthis.flags = {};\n\t\tthis.unsubscribe = new Subject();\n\t\t$scope.$watch('$viewContentLoaded', () => {\n\t\t\tthis.search$().pipe(\n\t\t\t\ttakeUntil(this.unsubscribe)\n\t\t\t).subscribe((filteredFaqCategories) => {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tthis.filteredFaqCategories = [];\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tthis.filteredFaqCategories = filteredFaqCategories;\n\t\t\t\t\t}, 50);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\t$scope.$on('destroy', () => {\n\t\t\t// console.log('destroy');\n\t\t\tthis.unsubscribe.next();\n\t\t\tthis.unsubscribe.complete();\n\t\t});\n\t}\n\n\tisOpen(id) {\n\t\treturn this.flags[id];\n\t}\n\n\ttoggle(id) {\n\t\tconst flag = !this.flags[id];\n\t\tconst node = document.querySelector(`#faq--${id} > .group--content`);\n\t\tif (flag) {\n\t\t\tTweenMax.set(node, { opacity: 0, maxHeight: 'none', display: 'block' });\n\t\t\tconst offsetHeight = node.offsetHeight + 20;\n\t\t\tTweenMax.set(node, { maxHeight: 0 });\n\t\t\tTweenMax.to(node, 0.35, {\n\t\t\t\topacity: 1,\n\t\t\t\tmaxHeight: offsetHeight,\n\t\t\t\toverwrite: 'all',\n\t\t\t\tonComplete: () => {}\n\t\t\t});\n\t\t} else {\n\t\t\tTweenMax.to(node, 0.35, {\n\t\t\t\topacity: 0,\n\t\t\t\tmaxHeight: 0,\n\t\t\t\toverwrite: 'all',\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tTweenMax.set(node, { display: 'none' });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.flags[id] = flag;\n\t}\n\n\tnavTo(category, event) {\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\t\tif (!category.slug) {\n\t\t\tthrow ('Missing category slug');\n\t\t\treturn;\n\t\t}\n\t\tconst node = document.querySelector(`#${category.slug}`);\n\t\tconst top = this.domService.scrollTop + node.getBoundingClientRect().top - 100;\n\t\twindow.scroll({\n\t\t\ttop: top,\n\t\t\tleft: 0,\n\t\t\tbehavior: 'smooth'\n\t\t});\n\t}\n\n\tsearch$() {\n\t\tconst node = document.querySelector('#faq-search');\n\t\treturn fromEvent(node, 'input').pipe(\n\t\t\tdebounceTime(1000),\n\t\t\tmap(function(event) {\n\t\t\t\treturn event.target.value.toLowerCase();\n\t\t\t}),\n\t\t\tmap(query => {\n\t\t\t\tthis.query = query;\n\t\t\t\tthis.faqCategories.forEach(x => x.items.forEach(i => i.opened = false));\n\t\t\t\tif (query !== '') {\n\n\t\t\t\t\tconst fakeFilter = {\n\t\t\t\t\t\t'': {\n\t\t\t\t\t\t\tvalue: query,\n\t\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvalue: query,\n\t\t\t\t\t\t\t\t\tkey: query\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tGtmService.pageViewFilters(GTM_CAT, fakeFilter);\n\n\t\t\t\t\tconst filteredFaqCategories = this.faqCategories.map(x => Object.assign({}, x)).filter(category => {\n\t\t\t\t\t\tlet has = false;\n\t\t\t\t\t\tlet items = category.items.filter(item => {\n\t\t\t\t\t\t\tconst hasTitle = item.title.toLowerCase().indexOf(query) !== -1;\n\t\t\t\t\t\t\tconst hasAbstract = item.abstract.toLowerCase().indexOf(query) !== -1;\n\t\t\t\t\t\t\titem.opened = hasAbstract;\n\t\t\t\t\t\t\tthis.flags[item.id] = item.opened;\n\t\t\t\t\t\t\thas = has || hasTitle || hasAbstract;\n\t\t\t\t\t\t\treturn hasTitle || hasAbstract;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (items.length) {\n\t\t\t\t\t\t\tcategory.items = items;\n\t\t\t\t\t\t} else if (category.title.toLowerCase().indexOf(query) !== -1) {\n\t\t\t\t\t\t\titems = category.items;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn items.length;\n\t\t\t\t\t});\n\t\t\t\t\t// console.log('FaqCtrl.search$', query, filteredFaqCategories);\n\t\t\t\t\t/*\n\t\t\t\t\tconst node = document.querySelector('.section--faq');\n\t\t\t\t\tconst top = node.getBoundingClientRect().top;\n\t\t\t\t\twindow.scrollTo(0, top);\n\t\t\t\t\t*/\n\t\t\t\t\treturn filteredFaqCategories;\n\t\t\t\t} else {\n\t\t\t\t\tthis.flags = {};\n\t\t\t\t\treturn this.faqCategories.slice();\n\t\t\t\t}\n\t\t\t}),\n\t\t\tshareReplay()\n\t\t);\n\t}\n\n}\n\nFaqCtrl.$inject = ['$scope', '$timeout', 'DomService', 'ApiService'];\n\nexport default FaqCtrl;\n","\n\n\nexport default class ControlMessagesDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'E';\n\t\tthis.templateUrl = 'templates/forms/messages.html';\n\t\tthis.transclude = {\n\t\t\t'message': '?messageItems',\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, model) {\n\n\t}\n\n\tstatic factory() {\n\t\treturn new ControlMessagesDirective();\n\t}\n\n}\n\nControlMessagesDirective.factory.$inject = [];\n","\n\n\nconst formatLabel = function(string = '', prepend = '', expression = undefined) {\n\tconst splitted = string.split(',');\n\tif (splitted.length > 1) {\n\t\tlet formatted = splitted.shift();\n\t\tsplitted.forEach((value, index) => {\n\t\t\tif (expression) {\n\t\t\t\tformatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\n\t\t\t} else {\n\t\t\t\tformatted = formatted.split('{' + index + '}').join(prepend + value);\n\t\t\t}\n\t\t});\n\t\tif (expression) {\n\t\t\treturn '\\'' + formatted + '\\'';\n\t\t} else {\n\t\t\treturn formatted;\n\t\t}\n\t} else {\n\t\treturn prepend + string;\n\t}\n};\n\nlet uniqueId = 0;\n\nlet errorElements = [],\n\tto;\n\nexport default class ControlDirective {\n\n\tconstructor(\n\t\t$parse,\n\t\tDomService\n\t) {\n\t\tthis.$parse = $parse;\n\t\tthis.domService = DomService;\n\t\tthis.restrict = 'A';\n\t\tthis.templateUrl = (element, attributes) => {\n\t\t\tvar template = 'templates/forms/text.html';\n\t\t\tswitch (attributes.control) {\n\t\t\t\tcase 'checkbox':\n\t\t\t\t\ttemplate = 'templates/forms/checkbox.html';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'password':\n\t\t\t\t\ttemplate = 'templates/forms/password.html';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'select':\n\t\t\t\t\ttemplate = 'templates/forms/select.html';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'textarea':\n\t\t\t\t\ttemplate = 'templates/forms/textarea.html';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn template;\n\t\t};\n\t\tthis.scope = {\n\t\t\tngModel: '=',\n\t\t\trequired: '=',\n\t\t\tform: '@',\n\t\t\ttitle: '@',\n\t\t\tplaceholder: '@',\n\t\t\tsource: '=?',\n\t\t\tkey: '@?',\n\t\t\tlabel: '@?',\n\t\t};\n\t\tthis.require = 'ngModel';\n\t\tthis.transclude = true;\n\t\tthis.link = {\n\t\t\tpre: (scope, element, attributes, controller, transclude) => {\n\t\t\t\tthis.linkMethod(scope, element, attributes, controller, transclude);\n\t\t\t}\n\t\t};\n\n\t}\n\n\tlinkMethod(scope, element, attributes, controller, transclude) {\n\t\tconst label = scope.label = (scope.label ? scope.label : 'name');\n\t\tconst key = scope.key = (scope.key ? scope.key : 'id');\n\t\tif (attributes.control === 'select') {\n\t\t\tconst filter = (attributes.filter ? '| ' + attributes.filter : '');\n\t\t\tconst optionLabel = formatLabel(label, 'item.', true);\n\t\t\tscope.getOptions = () => {\n\t\t\t\treturn attributes.number ?\n\t\t\t\t\t'item.' + key + ' as ' + optionLabel + ' disable when item.disabled for item in source ' + filter :\n\t\t\t\t\toptionLabel + ' disable when item.disabled for item in source ' + filter + ' track by item.' + key;\n\t\t\t};\n\t\t}\n\t\tconst type = scope.type = attributes.control;\n\t\tconst form = scope.form = scope.form || 'form';\n\t\tconst title = scope.title = scope.title || 'untitled';\n\t\tconst placeholder = scope.placeholder = scope.placeholder || title;\n\t\tconst field = scope.field = title.replace(/[^0-9a-zA-Z]/g, \"\").split(' ').join('') + (++uniqueId);\n\t\tscope.format = attributes.format || null;\n\t\tscope.precision = attributes.precision || null;\n\t\tscope.validate = attributes.validate || attributes.control;\n\t\tscope.minLength = attributes.minLength || 0;\n\t\tscope.maxLength = attributes.maxLength || Number.POSITIVE_INFINITY;\n\t\tscope.min = attributes.min || null;\n\t\tscope.max = attributes.max || null;\n\t\tscope.options = this.$parse(attributes.options)(scope) || {};\n\t\tscope.focus = false;\n\t\tscope.visible = false;\n\t\tscope.onChange = (model) => {\n\t\t\t// console.log('ControlDirective.onChange');\n\t\t\tthis.$parse(attributes.onChange)(scope.$parent);\n\t\t};\n\t\tscope.onFilter = (model) => {\n\t\t\tthis.$parse(attributes.onFilter)(scope.$parent);\n\t\t};\n\t\tscope.getType = () => {\n\t\t\tlet type = 'text';\n\t\t\tswitch (attributes.control) {\n\t\t\t\tcase 'password':\n\t\t\t\t\ttype = scope.visible ? 'text' : 'password';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\ttype = attributes.control;\n\t\t\t}\n\t\t\treturn type;\n\t\t};\n\t\tscope.onFocus = () => {\n\t\t\tscope.focus = true;\n\t\t\t// console.log('ControlDirective.onFocus', scope.focus);\n\t\t};\n\t\tscope.onBlur = () => {\n\t\t\tscope.focus = false;\n\t\t\t// console.log('ControlDirective.onBlur', scope.focus);\n\t\t\tthis.scrollToError();\n\t\t};\n\t\tscope.getClasses = () => {\n\t\t\tconst field = this.$parse(scope.form + '.' + scope.field)(scope.$parent);\n\t\t\tif (field) {\n\t\t\t\tconst focus = scope.focus;\n\t\t\t\tconst success = field.$valid;\n\t\t\t\tconst form = this.$parse(scope.form)(scope.$parent);\n\t\t\t\tconst error = field.$invalid && (form.$submitted || field.$touched);\n\t\t\t\tconst empty = !field.$viewValue;\n\t\t\t\tif (error) {\n\t\t\t\t\tthis.onError(element);\n\t\t\t\t\tif (scope.error !== error) {\n\t\t\t\t\t\tscope.error = error;\n\t\t\t\t\t\tthis.scrollToError();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tscope.error = false;\n\t\t\t\t}\n\t\t\t\treturn { focus, success, error, empty };\n\t\t\t}\n\t\t};\n\t\tscope.getMessages = () => {\n\t\t\tconst form = this.$parse(scope.form)(scope.$parent);\n\t\t\tconst field = this.$parse(scope.form + '.' + scope.field)(scope.$parent);\n\t\t\treturn (form.$submitted || field.$touched) && field.$error;\n\t\t};\n\t\tscope.toggleVisibility = () => {\n\t\t\tscope.visible = !scope.visible;\n\t\t};\n\t\tscope.$on('onInvalid', () => {\n\t\t\tthis.scrollToError();\n\t\t});\n\t}\n\n\tonError(element) {\n\t\tif (errorElements.indexOf(element) === -1) {\n\t\t\terrorElements.push(element);\n\t\t}\n\t}\n\n\tscrollToError() {\n\t\tif (errorElements.length) {\n\t\t\tif (to) {\n\t\t\t\tclearTimeout(to);\n\t\t\t}\n\t\t\tto = setTimeout(() => {\n\t\t\t\tconst top = errorElements.reduce((previous, current, index, array) => {\n\t\t\t\t\tconst node = current[0];\n\t\t\t\t\treturn Math.min(previous, node.getBoundingClientRect().top);\n\t\t\t\t}, Number.POSITIVE_INFINITY);\n\t\t\t\twindow.scroll({\n\t\t\t\t\ttop: this.domService.scrollTop + top - 100,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tbehavior: 'smooth'\n\t\t\t\t});\n\t\t\t\terrorElements = [];\n\t\t\t}, 100);\n\t\t}\n\t}\n\n\tlink(scope, element, attributes, controller) {}\n\n\tstatic factory($parse, DomService) {\n\t\treturn new ControlDirective($parse, DomService);\n\t}\n\n}\n\nControlDirective.factory.$inject = ['$parse', 'DomService'];\n","\n\n\nexport default class ValidateDirective {\n\n\tconstructor(\n\t\t$filter\n\t) {\n\t\tthis.$filter = $filter;\n\t\tthis.require = 'ngModel';\n\t}\n\n\tlink(scope, element, attributes, model) {\n\t\tconst type = attributes.validate;\n\t\tconst format = attributes.format || '';\n\t\tconst precision = attributes.precision || 2;\n\t\tlet focus = false;\n\t\t// console.log('validate', type);\n\t\tswitch (type) {\n\t\t\tcase 'date':\n\t\t\tcase 'datetime':\n\t\t\tcase 'datetime-local':\n\t\t\t\tmodel.$formatters.push(function(value) {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\treturn $filter('date')(value, format);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'number':\n\t\t\t\tmodel.$parsers.unshift(function(value) {\n\t\t\t\t\tlet valid = false;\n\t\t\t\t\tif (value !== undefined && value !== \"\") {\n\t\t\t\t\t\tvalid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); //\n\t\t\t\t\t\tvalue = Number(value);\n\t\t\t\t\t\tmodel.$setValidity('number', valid);\n\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\tmodel.$setValidity('positive', value >= 0.01);\n\t\t\t\t\t\t\tif (attributes.min !== undefined) {\n\t\t\t\t\t\t\t\tmodel.$setValidity('range', value >= Number(attributes.min));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (attributes.max !== undefined) {\n\t\t\t\t\t\t\t\tmodel.$setValidity('range', value <= Number(attributes.max));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalid = true;\n\t\t\t\t\t\tvalue = Number(value);\n\t\t\t\t\t\tmodel.$setValidity('number', true);\n\t\t\t\t\t\tmodel.$setValidity('positive', true);\n\t\t\t\t\t\tif (attributes.min !== undefined) {\n\t\t\t\t\t\t\tmodel.$setValidity('range', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (attributes.max !== undefined) {\n\t\t\t\t\t\t\tmodel.$setValidity('range', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tmodel.$formatters.push(function(value) {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\treturn $filter('number')(value, precision) + ' ' + format;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'anynumber':\n\t\t\t\tmodel.$parsers.unshift(function(value) {\n\t\t\t\t\tlet valid = false;\n\t\t\t\t\tif (value !== undefined && value !== \"\") {\n\t\t\t\t\t\tvalid = String(value).indexOf(Number(value).toString()) !== -1; // isFinite(value); //\n\t\t\t\t\t\tvalue = Number(value);\n\t\t\t\t\t\tmodel.$setValidity('number', valid);\n\t\t\t\t\t\tif (valid) {\n\t\t\t\t\t\t\tif (attributes.min !== undefined) {\n\t\t\t\t\t\t\t\tmodel.$setValidity('range', value >= Number(attributes.min));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (attributes.max !== undefined) {\n\t\t\t\t\t\t\t\tmodel.$setValidity('range', value <= Number(attributes.max));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalid = true;\n\t\t\t\t\t\tvalue = Number(value);\n\t\t\t\t\t\tmodel.$setValidity('number', true);\n\t\t\t\t\t\tif (attributes.min !== undefined) {\n\t\t\t\t\t\t\tmodel.$setValidity('range', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (attributes.max !== undefined) {\n\t\t\t\t\t\t\tmodel.$setValidity('range', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t\tmodel.$formatters.push(function(value) {\n\t\t\t\t\tif (value || value === 0) {\n\t\t\t\t\t\treturn $filter('number')(value, precision) + ' ' + format;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst onFocus = () => {\n\t\t\tfocus = true;\n\t\t\tif (format) {\n\t\t\t\telement[0].value = model.$modelValue || null;\n\t\t\t\tif (!model.$modelValue) {\n\t\t\t\t\tmodel.$setViewValue(null);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tconst doBlur = () => {\n\t\t\tif (format && !model.$invalid) {\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'date':\n\t\t\t\t\tcase 'datetime':\n\t\t\t\t\tcase 'datetime-local':\n\t\t\t\t\t\telement[0].value = model.$modelValue ? $filter('date')(model.$modelValue, format) : ' ';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\telement[0].value = model.$modelValue ? $filter('number')(model.$modelValue, precision) + ' ' + format : ' ';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tconst onBlur = () => {\n\t\t\tfocus = false;\n\t\t\tdoBlur();\n\t\t};\n\n\t\tconst addListeners = () => {\n\t\t\telement.on('focus', onFocus);\n\t\t\telement.on('blur', onBlur);\n\t\t};\n\n\t\tconst removeListeners = () => {\n\t\t\telement.off('focus', onFocus);\n\t\t\telement.off('blur', onBlur);\n\t\t};\n\n\t\tscope.$on('$destroy', function() {\n\t\t\tremoveListeners();\n\t\t});\n\n\t\taddListeners();\n\t}\n\n\tstatic factory($filter) {\n\t\treturn new ValidateDirective($filter);\n\t}\n\n}\n\nValidateDirective.factory.$inject = ['$filter'];\n","\n\nexport const ITEMS_PER_PAGE = 9;\n\nimport GtmService from '../gtm/gtm.service';\nconst GTM_CAT = 'gallerie';\n\nclass GalleriesCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.filters = window.filters || {};\n\t\tthis.galleries = window.galleries || [];\n\t\tthis.initialFilters = window.initialFilters || null;\n\t\tthis.filteredItems = [];\n\t\t// !!! FAKE\n\t\t//if (this.galleries.length > 0) {\n\t\t//\twhile (this.galleries.length < 100) {\n\t\t//\t\tthis.galleries = this.galleries.concat(this.galleries);\n\t\t//\t}\n\t\t//}\n\t\t// !!! FAKE\n\t\tthis.deserializeFilters(this.initialFilters);\n\t\tthis.applyFilters(false);\n\t}\n\n\tdeserializeFilters(initialFilter) {\n\t\tconst locationFilters = this.locationService.deserialize('filters') || initialFilter || {};\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tswitch (x) {\n\t\t\t\tcase 'collections': // probabilmente verrà aggiunto\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.id === value;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.features.indexOf(value) !== -1;\n\t\t\t\t\t};\n\t\t\t}\n\t\t\tfilter.options.unshift({\n\t\t\t\tlabel: filter.placeholder,\n\t\t\t\tvalue: null,\n\t\t\t});\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[x] || null)));\n\t\t\tfilter.value = selectedOption.value;\n\t\t\tfilter.placeholder = selectedOption.label;\n\t\t});\n\t\treturn filters;\n\t}\n\n\tserializeFilters() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[x] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\t// console.log('ReferenceCtrl.serializeFilters', filters);\n\t\tthis.locationService.serialize('filters', filters);\n\t\treturn filters;\n\t}\n\n\tapplyFilters(serialize) {\n\t\tif (serialize !== false) this.serializeFilters();\n\t\tconst { filteredItems } = this.getFilteredItems(this.galleries);\n\t\tthis.filteredItems = [];\n\t\tthis.visibleItems = [];\n\t\tthis.maxItems = ITEMS_PER_PAGE;\n\t\tthis.$timeout(() => {\n\t\t\tthis.filteredItems = filteredItems;\n\t\t\tthis.visibleItems = filteredItems.slice(0, this.maxItems);\n\t\t\tthis.updateFilterStates(this.galleries);\n\t\t\t// delayer for image update\n\t\t}, 50);\n\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\n\t}\n\n\tgetFilteredItems(items, skipFilter) {\n\t\tconst filters = Object.keys(this.filters).map((x) => this.filters[x]).filter(x => x.value !== null);\n\t\tlet filteredItems = items.slice();\n\t\tif (filters.length) {\n\t\t\tfilteredItems = filteredItems.filter(item => {\n\t\t\t\tlet has = true;\n\t\t\t\tfilters.forEach(filter => {\n\t\t\t\t\tif (filter !== skipFilter) {\n\t\t\t\t\t\thas = has && filter.doFilter(item, filter.value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn has;\n\t\t\t});\n\t\t}\n\t\treturn { filteredItems };\n\t}\n\n\tupdateFilterStates(items) {\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tconst { filteredItems } = this.getFilteredItems(items, filter);\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tlet has = false;\n\t\t\t\tif (option.value) {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\twhile (i < filteredItems.length && !has) {\n\t\t\t\t\t\tconst item = filteredItems[i];\n\t\t\t\t\t\thas = filter.doFilter(item, option.value);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thas = true;\n\t\t\t\t}\n\t\t\t\toption.disabled = !has;\n\t\t\t});\n\t\t});\n\t}\n\n\tsetFilter(item, filter) {\n\t\titem = item || filter.options[0];\n\t\tfilter.value = item.value;\n\t\tfilter.placeholder = item.label;\n\t\tthis.applyFilters();\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t}\n\n\tremoveFilter(filter) {\n\t\tthis.setFilter(null, filter);\n\t}\n\n\tonScroll(event) {\n\t\tif (event.rect.bottom < event.windowRect.bottom) {\n\t\t\t// console.log('more!');\n\t\t\tif (!this.busy && this.maxItems < this.filteredItems.length) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tthis.busy = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tthis.maxItems += ITEMS_PER_PAGE;\n\t\t\t\t\t\tthis.visibleItems = this.filteredItems.slice(0, this.maxItems);\n\t\t\t\t\t\tthis.busy = false;\n\t\t\t\t\t\t// console.log(this.visibleItems.length);\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\t}\n}\n\nGalleriesCtrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default GalleriesCtrl;\n","import GtmService from './gtm.service';\n\nexport default class GtmCollectionDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t\tthis.scope = {\n\t\t\titem: '=gtmCollection',\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\n\t\tconst onClick = () => {\n\t\t\tconst actionField = { list: scope.item.list };\n\t\t\tconst product = Object.assign({}, scope.item);\n\t\t\tdelete product.list;\n\n\t\t\tGtmService.push({\n\t\t\t\tevent: 'collectionClick',\n\t\t\t\tecommerce: {\n\t\t\t\t\tclick: {\n\t\t\t\t\t\tactionField,\n\t\t\t\t\t\tproducts: [product]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tnode.addEventListener('click', onClick);\n\n\t\tscope.$on('$destroy', () => node.removeEventListener('click', onClick));\n\t}\n\n\tstatic factory() {\n\t\treturn new GtmCollectionDirective();\n\t}\n\n}\n\nGtmCollectionDirective.factory.$inject = [];\n","import GtmService from './gtm.service';\n\nexport default class gtmDealerLocatorDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t\tthis.scope = {\n\t\t\tlabel: '=gtmDealerLocator'\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst node = element[0];\n\n\t\tconst onClick = () => {\n\t\t\tGtmService.push({\n\t\t\t\tevent: 'dealerlocator',\n\t\t\t\taction: 'sidebar-click',\n\t\t\t\tlabel: scope.label\n\t\t\t});\n\t\t}\n\n\t\tnode.addEventListener('click', onClick);\n\n\t\tscope.$on('$destroy', () => node.removeEventListener('click', onClick));\n\t}\n\n\tstatic factory() {\n\t\treturn new gtmDealerLocatorDirective();\n\t}\n\n}\n\ngtmDealerLocatorDirective.factory.$inject = [];\n","import GtmService from './gtm.service';\n\nexport default class GtmFormDirective {\n\n\tconstructor() {\n\t\tthis.restrict = 'A';\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tconst form_name = attributes[\"gtmFormName\"];\n\n\t\tif (form_name) {\n\t\t\tscope.$root.$on('formsubmit', () => {\n\t\t\t\tconst obj = {\n\t\t\t\t\tevent: 'formsubmit',\n\t\t\t\t\tform_name\n\t\t\t\t};\n\n\t\t\t\t// Task ID 34904 problema tracciamento form\n\t\t\t\tif (scope.c && scope.c.data && scope.c.model) {\n\t\t\t\t\tlet elem;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (scope.c.model.contactType) {\n\t\t\t\t\t\t\telem = scope.c.data.contactTypes.filter(_ => scope.c.model.contactType === _.id);\n\t\t\t\t\t\t\tif (elem.length)\n\t\t\t\t\t\t\t\tobj.contactType = elem[0].key;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (scope.c.model.contactReason) {\n\t\t\t\t\t\t\telem = scope.c.data.contactReasons.filter(_ => scope.c.model.contactReason === _.id);\n\t\t\t\t\t\t\tif (elem.length)\n\t\t\t\t\t\t\t\tobj.contactReason = elem[0].key;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (scope.c.model.qualification) {\n\t\t\t\t\t\t\telem = scope.c.data.qualification.filter(_ => scope.c.model.qualification === _.id);\n\t\t\t\t\t\t\tif (elem.length)\n\t\t\t\t\t\t\t\tobj.qualifica = elem[0].key;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\n\t\t\t\tGtmService.push(obj);\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic factory() {\n\t\treturn new GtmFormDirective();\n\t}\n\n}\n\nGtmFormDirective.factory.$inject = [];\n","import { animationFrameScheduler, combineLatest, fromEvent, interval, merge, Subject } from 'rxjs';\nimport { auditTime, distinctUntilChanged, filter, first, map, shareReplay, startWith, tap } from 'rxjs/operators';\nimport Rect from '../shared/rect';\n\nexport default class DomService {\n\n\tconstructor() {\n\t\tthis.secondaryScroll$_ = DomService.secondaryScroll$_;\n\t}\n\n\tget scrollTop() {\n\t\treturn DomService.getScrollTop(window);\n\t}\n\n\tget scrollLeft() {\n\t\treturn DomService.getScrollLeft(window);\n\t}\n\n\ttraverseUp(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tconst result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\treturn this.traverseUp(node.parentNode, callback, i + 1);\n\t}\n\n\ttraverseDown(node, callback, i = 0) {\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tlet result = callback(node, i);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tif (node.nodeType === 1) {\n\t\t\tlet j = 0,\n\t\t\t\tt = node.childNodes.length;\n\t\t\twhile (j < t && !result) {\n\t\t\t\tresult = this.traverseDown(node.childNodes[j], callback, i + 1);\n\t\t\t\tj++;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\thasWebglSupport() {\n\t\tif (this.isIE()) {\n\t\t\treturn false;\n\t\t}\n\t\tif (!this.hasWebgl()) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tisIE() {\n\t\tconst ua = window.navigator.userAgent;\n\t\tconst msie = ua.indexOf('MSIE ');\n\t\tif (msie > 0) {\n\t\t\t// IE 10 or older => return version number\n\t\t\treturn parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n\t\t}\n\t\tconst trident = ua.indexOf('Trident/');\n\t\tif (trident > 0) {\n\t\t\t// IE 11 => return version number\n\t\t\tconst rv = ua.indexOf('rv:');\n\t\t\treturn 'msie' + parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n\t\t}\n\t\tconst edge = ua.indexOf('Edge/');\n\t\tif (edge > 0) {\n\t\t\t// Edge (IE 12+) => return version number\n\t\t\treturn parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n\t\t}\n\t\t// other browser\n\t\treturn false;\n\t}\n\n\thasWebgl() {\n\t\treturn false;\n\t\tlet gl, debugInfo, vendor, renderer, has = false;\n\t\ttry {\n\t\t\tconst canvas = document.createElement('canvas');\n\t\t\tif (!!window.WebGLRenderingContext) {\n\t\t\t\tgl = canvas.getContext('webgl', {\n\t\t\t\t\t\tfailIfMajorPerformanceCaveat: true\n\t\t\t\t\t}) ||\n\t\t\t\t\tcanvas.getContext('experimental-webgl', {\n\t\t\t\t\t\tfailIfMajorPerformanceCaveat: true\n\t\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.log('no webgl');\n\t\t}\n\t\tif (gl) {\n\t\t\tdebugInfo = gl.getExtension('WEBGL_debug_renderer_info');\n\t\t\tvendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);\n\t\t\trenderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);\n\t\t\thas = true;\n\t\t}\n\t\tconsole.log(`WebGLCapabilities debugInfo: ${debugInfo} vendor: ${vendor} renderer: ${renderer} `);\n\t\treturn has;\n\t}\n\n\tgetOuterHeight(node) {\n\t\tlet height = node.clientHeight;\n\t\tconst computedStyle = window.getComputedStyle(node);\n\t\theight += parseInt(computedStyle.marginTop, 10);\n\t\theight += parseInt(computedStyle.marginBottom, 10);\n\t\theight += parseInt(computedStyle.borderTopWidth, 10);\n\t\theight += parseInt(computedStyle.borderBottomWidth, 10);\n\t\treturn height;\n\t}\n\n\tgetOuterWidth(node) {\n\t\tlet width = node.clientWidth;\n\t\tconst computedStyle = window.getComputedStyle(node);\n\t\twidth += parseInt(computedStyle.marginLeft, 10);\n\t\twidth += parseInt(computedStyle.marginRight, 10);\n\t\twidth += parseInt(computedStyle.borderLeftWidth, 10);\n\t\twidth += parseInt(computedStyle.borderRightWidth, 10);\n\t\treturn width;\n\t}\n\n\traf$() {\n\t\treturn DomService.raf$;\n\t}\n\n\twindowRect$() {\n\t\treturn DomService.windowRect$;\n\t}\n\n\trafAndRect$() {\n\t\treturn DomService.rafAndRect$;\n\t}\n\n\tscroll$() {\n\t\treturn DomService.scroll$;\n\t}\n\n\tsecondaryScroll$(target) {\n\t\treturn DomService.secondaryScroll$(target);\n\t}\n\n\tscrollAndRect$() {\n\t\treturn DomService.scrollAndRect$;\n\t}\n\n\tsmoothScroll$(selector, friction = 20) {\n\t\tconst body = document.querySelector('body');\n\t\tconst node = document.querySelector(selector);\n\t\t// const outerHeight = this.getOuterHeight(node);\n\t\tlet down = false;\n\t\t/*\n\t\tconst onWheel = (event) => {\n\t\t\tdown = true;\n\t\t}\n\t\tconst onDown = () => {\n\t\t\tdown = true;\n\t\t}\n\t\tconst onUp = () => {\n\t\t\tdown = false;\n\t\t}\n\t\tdocument.addEventListener('wheel', onWheel);\n\t\tdocument.addEventListener('touchstart', onDown);\n\t\tdocument.addEventListener('touchend', onUp);\n\t\t*/\n\t\t/*\n\t\tdocument.addEventListener('touchstart', () => {\n\t\t\tconsole.log('touchstart');\n\t\t\tbody.classList.add('down');\n\t\t\tdown = true;\n\t\t}, {passive:true});\n\t\tdocument.addEventListener('touchend', () => {\n\t\t\tbody.classList.remove('down');\n\t\t\tdown = false;\n\t\t});\n\t\tconsole.log(window);\n\t\t*/\n\t\treturn this.raf$().pipe(\n\t\t\tmap(() => {\n\t\t\t\tconst outerHeight = this.getOuterHeight(node);\n\t\t\t\t// console.log(window.DocumentTouch);\n\t\t\t\t// console.log(document instanceof DocumentTouch);\n\t\t\t\t// console.log(navigator.msMaxTouchPoints);\n\t\t\t\tif (body.offsetHeight !== outerHeight) {\n\t\t\t\t\t// margin ?\n\t\t\t\t\tbody.style = `height: ${outerHeight}px`;\n\t\t\t\t}\n\t\t\t\tconst nodeTop = node.top || 0;\n\t\t\t\tconst top = down ? -this.scrollTop : Math.round((nodeTop + (-this.scrollTop - nodeTop) / friction) * 100) / 100;\n\t\t\t\tif (node.top !== top) {\n\t\t\t\t\tnode.top = top;\n\t\t\t\t\tnode.style = `position: fixed; width: 100%; transform: translateY(${top}px)`;\n\t\t\t\t\treturn top;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}),\n\t\t\tfilter(x => x !== null),\n\t\t\tshareReplay()\n\t\t);\n\t}\n\n\t/*\n\t// trackpad\n\twindow.onwheel = function(e) {\n\t  e.preventDefault();\n\t  if (e.ctrlKey) {\n\t    zoom += e.deltaY;\n\t  } else {\n\t    offsetX += e.deltaX * 2;\n\t    offsetY -= e.deltaY * 2;\n\t  }\n\t};\n\t*/\n\n\trafIntersection$(node) {\n\t\treturn this.rafAndRect$().pipe(\n\t\t\tmap(datas => {\n\t\t\t\t// const scrollTop = datas[0];\n\t\t\t\tconst windowRect = datas[1];\n\t\t\t\tconst rect = Rect.fromNode(node);\n\t\t\t\tif (rect.height) {\n\t\t\t\t\tconst intersection = rect.intersection(windowRect);\n\t\t\t\t\tconst response = DomService.rafIntersection_;\n\t\t\t\t\tresponse.scroll = datas[0];\n\t\t\t\t\tresponse.windowRect = datas[1];\n\t\t\t\t\tresponse.rect = rect;\n\t\t\t\t\tresponse.intersection = intersection;\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t}),\n\t\t\tfilter(response => response !== undefined)\n\t\t);\n\t}\n\n\tscrollIntersection$(node) {\n\t\tconst o = this.scrollAndRect$().pipe(\n\t\t\tmap(datas => {\n\t\t\t\t// const scrollTop = datas[0];\n\t\t\t\tconst windowRect = datas[1];\n\t\t\t\tconst rect = Rect.fromNode(node);\n\t\t\t\tif (rect.height) {\n\t\t\t\t\tconst intersection = rect.intersection(windowRect);\n\t\t\t\t\tconst response = DomService.scrollIntersection_;\n\t\t\t\t\tresponse.scroll = datas[0];\n\t\t\t\t\tresponse.windowRect = datas[1];\n\t\t\t\t\tresponse.rect = rect;\n\t\t\t\t\tresponse.intersection = intersection;\n\t\t\t\t\treturn response;\n\t\t\t\t}\n\t\t\t}),\n\t\t\tfilter(response => response !== undefined)\n\t\t);\n\t\tDomService.secondaryScroll$_.next({ target: window });\n\t\treturn o;\n\t}\n\n\tappear$(node, value = 0.0) { // -0.5\n\t\treturn this.scrollIntersection$(node).pipe(\n\t\t\tfilter(x => x.intersection.y > value),\n\t\t\tfirst()\n\t\t);\n\t}\n\n\tvisibility$(node, value = 0.5) {\n\t\treturn this.scrollIntersection$(node).pipe(\n\t\t\tmap(x => x.intersection.y > value),\n\t\t\tdistinctUntilChanged()\n\t\t);\n\t}\n\n\tfirstVisibility$(node, value = 0.5) {\n\t\treturn this.visibility$(node, value).pipe(\n\t\t\tfilter(visible => visible),\n\t\t\tfirst()\n\t\t);\n\t}\n\n\taddCustomRules() {\n\t\tconst sheet = this.addCustomSheet();\n\t\tconst body = document.querySelector('body');\n\t\tconst scrollBarWidth = window.innerWidth - body.clientWidth;\n\t\tlet rule = `body.droppin-in { padding-right: ${scrollBarWidth}px; }`;\n\t\tsheet.insertRule(rule, 0);\n\t\trule = `body.droppin-in header { width: calc(100% - ${scrollBarWidth}px); }`;\n\t\tsheet.insertRule(rule, 1);\n\t\trule = `body.droppin-in menu--product { width: calc(100% - ${scrollBarWidth}px); }`;\n\t\tsheet.insertRule(rule, 2);\n\t}\n\n\taddCustomSheet() {\n\t\tconst style = document.createElement('style');\n\t\tstyle.appendChild(document.createTextNode(''));\n\t\tdocument.head.appendChild(style);\n\t\treturn style.sheet;\n\t}\n\n\tstatic factory() {\n\t\treturn new DomService();\n\t}\n\n\tstatic getScrollTop(node) {\n\t\tif (node === document || node === window) {\n\t\t\treturn this.getScrollTop(document.scrollingElement || document.documentElement || document.body);\n\t\t}\n\t\treturn node.pageYOffset || node.scrollY || node.scrollTop || 0;\n\t}\n\n\tstatic getScrollLeft(node) {\n\t\tif (node === document || node === window) {\n\t\t\treturn this.getScrollLeft(document.scrollingElement || document.documentElement || document.body);\n\t\t}\n\t\treturn node.pageXOffset || node.scrollX || node.scrollLeft || 0;\n\t}\n\n\tstatic secondaryScroll$(target) {\n\t\treturn fromEvent(target, 'scroll').pipe(\n\t\t\ttap(event => DomService.secondaryScroll$_.next(event))\n\t\t);\n\t}\n\n}\n\nDomService.factory.$inject = [];\nDomService.rafIntersection_ = {};\nDomService.scrollIntersection_ = {};\nDomService.raf$ = interval(0, animationFrameScheduler);\nDomService.windowRect$ = function() {\n\tconst windowRect = new Rect({\n\t\twidth: window.innerWidth,\n\t\theight: window.innerHeight\n\t});\n\treturn fromEvent(window, 'resize').pipe(\n\t\tmap(originalEvent => {\n\t\t\twindowRect.width = window.innerWidth;\n\t\t\twindowRect.height = window.innerHeight;\n\t\t\treturn windowRect;\n\t\t}),\n\t\tstartWith(windowRect),\n\t\tshareReplay()\n\t);\n}();\nDomService.rafAndRect$ = combineLatest(DomService.raf$, DomService.windowRect$).pipe(\n\tshareReplay()\n);\nDomService.mainScroll$ = function() {\n\tconst target = window;\n\treturn fromEvent(target, 'scroll').pipe(\n\t\tshareReplay()\n\t);\n}();\nDomService.secondaryScroll$_ = new Subject();\nDomService.scroll$ = function() {\n\tconst target = window;\n\tlet previousTop = DomService.getScrollTop(target);\n\tconst event = {\n\t\tscrollTop: previousTop,\n\t\tscrollLeft: DomService.getScrollLeft(target),\n\t\tdirection: 0,\n\t\toriginalEvent: null,\n\t};\n\treturn merge(DomService.mainScroll$, DomService.secondaryScroll$_).pipe(\n\t\tauditTime(1000 / 60),\n\t\tmap((originalEvent) => {\n\t\t\tevent.scrollTop = DomService.getScrollTop(originalEvent.target);\n\t\t\tevent.scrollLeft = DomService.getScrollLeft(originalEvent.target);\n\t\t\tconst diff = event.scrollTop - previousTop;\n\t\t\tevent.direction = diff ? diff / Math.abs(diff) : 0;\n\t\t\tpreviousTop = event.scrollTop;\n\t\t\tevent.originalEvent = originalEvent;\n\t\t\treturn event;\n\t\t}),\n\t\tstartWith(event),\n\t\tshareReplay()\n\t);\n}();\nDomService.scrollAndRect$ = combineLatest(DomService.scroll$, DomService.windowRect$).pipe(\n\tshareReplay()\n);\n","import Highway from '@dogstudio/highway';\nimport GtmService from '../gtm/gtm.service';\n\nlet first = true;\n\nexport default class CustomRenderer extends Highway.Renderer {\n\n\tupdate() {\n\t\tthis.updateMeta();\n\t\tthis.updateGTMData();\n\t\tthis.pageView();\n\t\tthis.updateBrand();\n\t\tthis.updateSearchQuery();\n\t\tthis.updateMarketsAndLanguages();\n\t}\n\n\tupdateMeta() {\n\t\tconst page = this.properties.page;\n\t\tdocument.title = page.title;\n\t}\n\n\tupdateBrand() {\n\t\tconst page = this.properties.page;\n\t\tconst body = page.querySelector('body');\n\t\tlet brand = /([\"'])(\\\\?.)*?\\1/.exec(body.getAttribute('ng-init') || '');\n\t\tbrand = brand ? brand[0].replace(/\\'/g, '') : 'atlas-concorde';\n\t\t// console.log(brand);\n\t\tCustomRenderer.$timeout(() => {\n\t\t\tconst scope = CustomRenderer.scope;\n\t\t\tscope.root.brand = brand;\n\t\t\t// console.log('CustomRenderer.update', scope);\n\t\t});\n\t}\n\n\tupdateSearchQuery() {\n\t\tconst page = this.properties.page;\n\t\tconst dataSearch = [...page.querySelectorAll('[data-search]')];\n\t\tif (dataSearch.length) {\n\t\t\tconst pageDataSearch = [...document.querySelectorAll('[data-search]')];\n\t\t\tpageDataSearch.forEach(node => {\n\t\t\t\tnode.setAttribute('data-search', dataSearch[0].getAttribute('data-search'));\n\t\t\t});\n\t\t}\n\t}\n\n\tupdateMarketsAndLanguages() {\n\t\tconst page = this.properties.page;\n\t\tconst marketSelector = page.getElementById('market-selector');\n\t\tif (marketSelector != null) {\n\t\t\ttry {\n\t\t\t\tconst marketUrls = angular.fromJson(marketSelector.getAttribute('data-markets'));\n\t\t\t\tCustomRenderer.scope.root.marketUrls = marketUrls;\n\t\t\t} catch (e) {}\n\t\t}\n\t\t/*\n\t\tconst marketsAndLanguages = [...page.querySelectorAll('.nav--markets__secondary > li > a')];\n\t\tconst anchors = [...document.querySelectorAll('.nav--markets__secondary > li > a')];\n\t\tanchors.forEach(a => {\n\t\t\tconst marketAndLanguage = marketsAndLanguages.find(x => x.id === a.id);\n\t\t\tif (marketAndLanguage) {\n\t\t\t\ta.href = marketAndLanguage.href;\n\t\t\t\tconsole.log('updateMarketsAndLanguages', marketAndLanguage.id, marketAndLanguage.href);\n\t\t\t}\n\t\t});\n\t\t*/\n\t}\n\n\tpageView() {\n\t\tconst page = this.properties.page;\n\t\tif (!page.getElementById(GtmService.FILTERS_SCRIPT_ID)) {\n\t\t\tGtmService.pageView();\n\t\t}\n\t}\n\n\tupdateGTMData() {\n\t\tconst page = this.properties.page;\n\t\tconst script = page.getElementById(\"gtm-page-data\");\n\t\tif (script && script.text) {\n\t\t\ttry {\n\t\t\t\tnew Function(script.text)();\n\t\t\t} catch (error) {}\n\t\t}\n\t}\n\n\t// This method in the renderer is run when the data-router-view is added to the DOM Tree.\n\tonEnter() {\n\t\t// console.log('onEnter');\n\t\tif (!first) {\n\t\t\tCustomRenderer.$timeout(() => {\n\t\t\t\tconst $compile = CustomRenderer.$compile;\n\t\t\t\tconst view = [...document.querySelectorAll('.view')].pop();\n\t\t\t\t// console.log(view.childNodes);\n\t\t\t\tconst element = angular.element(view.childNodes);\n\t\t\t\tconst $scope = CustomRenderer.scope;\n\t\t\t\t$scope.root.menuOpened = false;\n\t\t\t\t$scope.root.menuProductOpened = false;\n\t\t\t\tconst $newScope = $scope.$new();\n\t\t\t\tconst content = $compile(element)($newScope);\n\t\t\t\tCustomRenderer.$newScope = $newScope;\n\t\t\t\tCustomRenderer.content = content;\n\t\t\t\t/*\n\t\t\t\tscope.$on('$destroy', (event) => {\n\t\t\t\t\tconsole.log('.view -> $destroy', event);\n\t\t\t\t});\n\t\t\t\t*/\n\t\t\t\t// element.append(content);\n\t\t\t});\n\t\t}\n\t}\n\n\t// This method in the renderer is run when transition to hide the data-router-view is called.\n\tonLeave() {\n\t\t// console.log('onLeave', first);\n\t\tif (first) {\n\t\t\tfirst = false;\n\t\t\tconst view = [...document.querySelectorAll('.view')].shift();\n\t\t\tconst element = angular.element(view.childNodes);\n\t\t\t/*\n\t\t\tscope.$on('$destroy', (event) => {\n\t\t\t\tconsole.log('.view -> $destroy', event);\n\t\t\t});\n\t\t\t*/\n\t\t}\n\t}\n\n\t// This method in the renderer is run when the transition to display the data-router-view is done.\n\tonEnterCompleted() {\n\t\t// console.log('onEnterCompleted');\n\t\t/*\n\t\tif (first) {\n\t\t\tfirst = false;\n\t\t}\n\t\t*/\n\t}\n\n\t// This method in the renderer is run when the data-router-view is removed from the DOM Tree.\n\tonLeaveCompleted() {\n\t\t// console.log('onLeaveCompleted');\n\t}\n\n\tstatic $destroy(from) {\n\t\t// console.log('CustomRenderer.destroy', this.content, this.$newScope);\n\t\tif (CustomRenderer.scope && CustomRenderer.scope.$root && CustomRenderer.scope.$root.first) {\n\t\t\tCustomRenderer.$timeout(() => {\n\t\t\t\tCustomRenderer.scope.$root.first = null;\n\t\t\t});\n\t\t} else {\n\t\t\tif (this.content) {\n\t\t\t\tthis.content.remove();\n\t\t\t\tthis.content = null;\n\t\t\t}\n\t\t\tif (this.$newScope) {\n\t\t\t\tthis.$newScope.$destroy();\n\t\t\t\tthis.$newScope = null;\n\t\t\t}\n\t\t\tfrom.remove();\n\t\t}\n\t}\n\n\tstatic collectScopes(scope, scopes) {\n\t\tscopes = scopes || [];\n\t\tif (scope) {\n\t\t\tlet child = scope && scope.$$childHead;\n\t\t\twhile (child) {\n\t\t\t\tscopes.push(child);\n\t\t\t\tscopes = this.collectScopes(child, scopes);\n\t\t\t\tchild = child.$$nextSibling;\n\t\t\t}\n\t\t\t// console.log(scopes);\n\t\t}\n\t\treturn scopes;\n\t}\n\n}\n","\n\nimport Highway from '@dogstudio/highway';\nimport DomService from '../services/dom.service';\nimport Rect from '../shared/rect';\nimport CustomRenderer from './custom-renderer';\n\nexport default class PageTransition extends Highway.Transition {\n\n\tin ({ from, to, done }) {\n\t\t// console.log('PageTransition.in');\n\t\tconst loader = document.querySelector('.loader--cube');\n\t\tTweenMax.to(loader, 0.45, {\n\t\t\topacity: 0,\n\t\t\tease: Power2.easeInOut,\n\t\t\tonComplete: () => {\n\t\t\t\tTweenMax.set(loader, { display: 'none' });\n\t\t\t}\n\t\t});\n\t\tTweenMax.set(to, { opacity: 0, minHeight: from.offsetHeight });\n\n\t\tCustomRenderer.$destroy(from);\n\t\tif (PageTransition.origin) {\n\t\t\tconst left = PageTransition.origin.x / window.innerWidth * 100;\n\t\t\tconst top = PageTransition.origin.y;\n\t\t\tTweenMax.set(to, { scale: 1.1, transformOrigin: `${left}% ${top}px` });\n\t\t}\n\n\t\t// console.log(PageTransition.origin);\n\t\tTweenMax.to(to, 0.6, {\n\t\t\tscale: 1,\n\t\t\topacity: 1,\n\t\t\tdelay: 0.1, // 0.250,\n\t\t\t// overwrite: 'all',\n\t\t\tease: Power2.easeInOut,\n\t\t\tonComplete: () => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tTweenMax.set(to, { clearProps: 'all' });\n\t\t\t\t\tTweenMax.set(to, { minHeight: 0, opacity: 1 });\n\t\t\t\t}, 50);\n\t\t\t\t// ci sono estensioni che bloccano questo genere di script\n\t\t\t\tif (addthis.layers && addthis.layers.refresh) {\n\t\t\t\t\taddthis.layers.refresh();\n\t\t\t\t}\n\t\t\t\tdone();\n\t\t\t}\n\t\t});\n\t}\n\n\tout({ from, trigger, done }) {\n\t\t// console.log('PageTransition.out');\n\t\tconst loader = document.querySelector('.loader--cube');\n\t\tTweenMax.set(loader, { opacity: 0, display: 'block' });\n\t\tTweenMax.to(loader, 0.45, {\n\t\t\topacity: 1,\n\t\t\tease: Power2.easeInOut,\n\t\t});\n\t\tconst headerMenu = document.querySelector('.header__menu');\n\t\tif (headerMenu) {\n\t\t\theaderMenu.classList.remove('opened');\n\t\t\t/*\n\t\t\tTweenMax.to(headerMenu, 0.3, {\n\t\t\t\tmaxHeight: 0,\n\t\t\t\tdelay: 0,\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tTweenMax.set(headerMenu, { clearProps: 'all' });\n\t\t\t\t\t// headerMenu.classList.remove('opened');\n\t\t\t\t}\n\t\t\t});\n\t\t\t*/\n\t\t}\n\t\tlet left = 50;\n\t\tlet top = DomService.getScrollTop(window);\n\t\tif (trigger instanceof HTMLElement) {\n\t\t\tconst rect = Rect.fromNode(trigger);\n\t\t\tPageTransition.origin = rect.center;\n\t\t\ttop += rect.center.y;\n\t\t\tleft = rect.center.x / window.innerWidth * 100;\n\t\t}\n\t\tTweenMax.set(from, { transformOrigin: `${left}% ${top}px` });\n\t\tTweenMax.to(from, 0.6, {\n\t\t\tscale: 1.1,\n\t\t\topacity: 0,\n\t\t\tdelay: 0, // 0.150,\n\t\t\t// overwrite: 'all',\n\t\t\tease: Power2.easeInOut,\n\t\t\tonComplete: () => {\n\t\t\t\tsetTimeout(done, 500);\n\t\t\t}\n\t\t});\n\t}\n}\n","import Highway from '@dogstudio/highway';\nimport { Subject } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\nimport GtmService from '../gtm/gtm.service';\nimport DomService from '../services/dom.service';\nimport CustomRenderer from './custom-renderer';\nimport PageTransition from './page-transition';\n// import PageNoTransition from './page-no-transition';\n\n// Import Quicklink\n// See: https://github.com/GoogleChromeLabs/quicklink\n// import Quicklink from 'quicklink/dist/quicklink.mjs';\n\nexport default class HighwayDirective {\n\n\tconstructor(\n\t\t$compile,\n\t\t$timeout\n\t) {\n\t\tthis.$compile = $compile;\n\t\tthis.$timeout = $timeout;\n\t\tthis.restrict = 'A';\n\t\tthis.link$ = new Subject();\n\t}\n\n\tonLink$() {\n\t\treturn this.link$.pipe(\n\t\t\tdebounceTime(50)\n\t\t);\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tthis.$timeout(() => {\n\t\t\tthis.init(scope, element, attributes, controller);\n\t\t});\n\t}\n\n\tinit(scope, element, attributes, controller) {\n\t\tCustomRenderer.$compile = this.$compile;\n\t\tCustomRenderer.$timeout = this.$timeout;\n\t\tCustomRenderer.scope = scope;\n\n\t\tlet wasProduct = false;\n\n\t\tconst onProductMenu = () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tlet top = 0;\n\t\t\t\tconst sectionProduct = element[0].querySelector('.section--product');\n\t\t\t\tif (wasProduct && sectionProduct && window.innerWidth > 860) {\n\t\t\t\t\tconst anchors = [...sectionProduct.querySelectorAll('a')];\n\t\t\t\t\tlet selectedAnchor = anchors.find(x => window.location.href.lastIndexOf(x.href) === window.location.href.length - x.href.length);\n\t\t\t\t\t// console.log(anchors, selectedAnchor);\n\t\t\t\t\tif (selectedAnchor && anchors.indexOf(selectedAnchor) !== 0) {\n\t\t\t\t\t\tconst sectionProductTop = sectionProduct.getBoundingClientRect().top;\n\t\t\t\t\t\ttop = sectionProductTop + DomService.getScrollTop(window);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\twindow.scrollTo(0, top);\n\t\t\t\t// console.log('wasProduct', wasProduct);\n\t\t\t\t// console.log(wasProduct, sectionProduct);\n\t\t\t\twasProduct = Boolean(sectionProduct);\n\t\t\t\t// console.log('isProduct', wasProduct);\n\t\t\t}, 100);\n\t\t}\n\n\t\t/*\n\t\tHighway.Core.prototype.pushState_ = Highway.Core.prototype.pushState;\n\t\tHighway.Core.prototype.pushState = () => {};\n\t\t*/\n\t\tconst H = new Highway.Core({\n\t\t\trenderers: {\n\t\t\t\tview: CustomRenderer,\n\t\t\t},\n\t\t\ttransitions: {\n\t\t\t\tview: PageTransition,\n\t\t\t}\n\t\t});\n\t\tthis.H = H;\n\t\tCustomRenderer.H = H;\n\t\tscope.$on('onHrefNode', ($scope, node) => {\n\t\t\tthis.link$.next();\n\t\t});\n\t\tconst subscription = this.onLink$().subscribe(x => {\n\t\t\t// console.log('onLinks$');\n\t\t\tH.detach(H.links);\n\t\t\tconst links = document.querySelectorAll('a:not([target]):not([data-router-disabled])');\n\t\t\tH.links = links;\n\t\t\tH.attach(links);\n\t\t\t/*\n\t\t\tlinks.forEach(x => {\n\t\t\t\tx.classList.remove('active');\n\t\t\t\tif (x.href === location.href) {\n\t\t\t\t\tx.classList.add('active');\n\t\t\t\t}\n\t\t\t});\n\t\t\t*/\n\t\t});\n\t\tconst properties = H.cache.get(H.location.href);\n\t\tproperties.view = scope.$root.firstView;\n\t\tH.cache.set(H.location.href, properties);\n\t\tH.on('NAVIGATE_OUT', ({ to, trigger, location }) => {\n\t\t\tscope.$broadcast('onNavigateOut', location);\n\t\t});\n\t\tH.on('NAVIGATE_IN', ({ to, trigger, location }) => {\n\t\t\t// console.log('NAVIGATE_IN');\n\t\t\tH.detach(H.links);\n\t\t\tonProductMenu();\n\t\t});\n\t\t/*\n\t\tH.on('NAVIGATE_END', ({ to, trigger, location }) => {\n\t\t\tconsole.log('NAVIGATE_END', document.title);\n\t\t\t// H.pushState_();\n\t\t});\n\t\t*/\n\t\tscope.$on('$destroy', () => {\n\t\t\t// H.destroy();\n\t\t\tsubscription.unsubscribe();\n\t\t});\n\t\t/*\n\t\tconst pushState = history.pushState;\n\t\thistory.pushState = (...args) => {\n\t\t\tconsole.log('pushState', args, document.title);\n\t\t\treturn pushState.apply(history, args);\n\t\t};\n\t\t*/\n\n\t\tsetTimeout(onProductMenu, 1000);\n\n\t\tif (!H.properties.page.getElementById(GtmService.FILTERS_SCRIPT_ID)) {\n\t\t\tGtmService.pageView();\n\t\t}\n\t}\n\n\tstatic factory($compile, $timeout) {\n\t\treturn new HighwayDirective($compile, $timeout);\n\t}\n\n}\n\nHighwayDirective.factory.$inject = ['$compile', '$timeout'];\n","﻿\n\n\nexport const ITEMS_PER_PAGE = 9;\n\nclass MagazineCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.magazine = window.magazine || [];\n\t\t// !!! FAKE\n\t\t//while (this.magazine.length < 100) {\n\t\t//\tthis.magazine = this.magazine.concat(this.magazine);\n\t\t//}\n\t\t// !!! FAKE\n\t\tthis.maxItems = 0;\n\t\tthis.visibleItems = [];\n\t}\n\n\tonScroll(event) {\n\t\tif (event.rect.bottom < event.windowRect.bottom) {\n\t\t\t// console.log('more!');\n\t\t\tif (!this.busy && this.maxItems < this.magazine.length) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tthis.busy = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tthis.maxItems += ITEMS_PER_PAGE;\n\t\t\t\t\t\tthis.visibleItems = this.magazine.slice(0, this.maxItems);\n\t\t\t\t\t\tthis.busy = false;\n\t\t\t\t\t\t// console.log(this.visibleItems.length);\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\t}\n}\n\nMagazineCtrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default MagazineCtrl;\n","export default class MoodboardDropdownDirective {\n\n\tconstructor(\n\t\t$compile\n\t) {\n\t\tthis.$compile = $compile;\n\t\tthis.restrict = 'A';\n\t\tthis.template = `\n<span has-dropdown=\".moodboard__value\">\n\t<span class=\"dropdown\">\n\t\t<ul class=\"nav nav--select\">\n\t\t\t<li ng-repeat=\"item in filter.options track by $index\" ng-class=\"{ active: filter.value == item.value, disabled: item.disabled }\">\n\t\t\t\t<span class=\"option\" ng-class=\"{ 'option--picture': item.image }\" ng-click=\"setFilter(item, filter)\">\n\t\t\t\t\t<img ng-src=\"{{item.image}}\" ng-if=\"item.image\" />\n\t\t\t\t\t<span ng-bind=\"item.label\"></span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</span>\n\t<span class=\"moodboard__value\" ng-class=\"{ active: filter.value }\">\n\t\t<span class=\"moodboard__underline\"></span>\n\t\t<span class=\"moodboard__text\">{{filter.placeholder}}</span>\n\t</span>\n</span>\n`;\n\t\t// this.require = 'ngModel';\n\t\tthis.scope = {\n\t\t\tfilter: '=?moodboardDropdown',\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\t// console.log('MoodboardDropdownDirective', this.filter);\n\t\tconst filter = scope.filter;\n\t\tif (filter.value) {\n\t\t\tfilter.placeholder = filter.options.find(x => x.value === filter.value).label;\n\t\t}\n\t\tscope.setFilter = (item, filter) => {\n\t\t\titem = item || filter.options[0];\n\t\t\tfilter.value = item.value;\n\t\t\tfilter.placeholder = item.label;\n\t\t\tif (typeof filter.doFilter === 'function') {\n\t\t\t\tfilter.doFilter(item, item.value);\n\t\t\t}\n\t\t\tscope.$broadcast('onCloseDropdown');\n\t\t};\n\t\tscope.removeFilter = (filter) => {\n\t\t\tthis.setFilter(null, filter);\n\t\t};\n\t\tscope.$on('$destroy', () => {});\n\t}\n\n\tstatic factory($compile) {\n\t\treturn new MoodboardDropdownDirective($compile);\n\t}\n\n}\n\nMoodboardDropdownDirective.factory.$inject = ['$compile'];\n","export default class MoodboardSearchDirective {\n\n\tconstructor(\n\t\t$compile\n\t) {\n\t\tthis.$compile = $compile;\n\t\tthis.restrict = 'A';\n\t\tthis.scope = {\n\t\t\tfilters: '=moodboardSearch',\n\t\t\tmodel: '=model',\n\t\t};\n\t}\n\n\tlink(scope, element, attributes, controller) {\n\t\tscope.filters = scope.filters || {};\n\t\tconst node = element[0];\n\t\tlet html = node.innerText;\n\t\tconst keys = Object.keys(scope.filters);\n\t\tkeys.forEach(x => {\n\t\t\t// console.log(x);\n\t\t\thtml = html.replace(`$${x}$`, `<span class=\"moodboard__dropdown ${x}\" moodboard-dropdown=\"filters.${x}\" ng-click=\"animateOff()\"></span>`);\n\t\t});\n\t\t// console.log('MoodboardSearchDirective', html);\n\t\tnode.innerHTML = html;\n\t\tthis.$compile(element.contents())(scope);\n\t\tconst hasFilter = Object.keys(scope.filters).map(x => scope.filters[x]).find(x => x.value !== null) !== undefined;\n\t\tif (!hasFilter) {\n\t\t\tthis.animateUnderlines(node);\n\t\t}\n\t\tscope.animateOff = () => {\n\t\t\tthis.animateOff(node);\n\t\t};\n\t\tscope.$on('$destroy', () => {});\n\t}\n\n\tanimateUnderlines(node) {\n\t\tthis.animated = true;\n\t\tconst values = [...node.querySelectorAll('.moodboard__underline')];\n\t\tvalues.forEach(x => {\n\t\t\tTweenMax.set(x, { transformOrigin: '0 50%', scaleX: 0 });\n\t\t});\n\t\tlet i = -1;\n\t\tconst animate = () => {\n\t\t\ti++;\n\t\t\ti = i % values.length;\n\t\t\tconst u = values[i];\n\t\t\tTweenMax.set(u, { transformOrigin: '0 50%', scaleX: 0 });\n\t\t\tTweenMax.to(u, 0.50, {\n\t\t\t\tscaleX: 1,\n\t\t\t\ttransformOrigin: '0 50%',\n\t\t\t\tdelay: 0,\n\t\t\t\tease: Power3.easeInOut,\n\t\t\t\toverwrite: 'all',\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tTweenMax.set(u, { transformOrigin: '100% 50%', scaleX: 1 });\n\t\t\t\t\tTweenMax.to(u, 0.50, {\n\t\t\t\t\t\tscaleX: 0,\n\t\t\t\t\t\ttransformOrigin: '100% 50%',\n\t\t\t\t\t\tdelay: 1.0,\n\t\t\t\t\t\tease: Power3.easeInOut,\n\t\t\t\t\t\toverwrite: 'all',\n\t\t\t\t\t\tonComplete: () => {\n\t\t\t\t\t\t\tanimate();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\tanimate();\n\t}\n\n\tanimateOff(node) {\n\t\tif (this.animated) {\n\t\t\tthis.animated = false;\n\t\t\t// console.log('animateOff');\n\t\t\t// TweenMax.killAll();\n\t\t\tconst values = [...node.querySelectorAll('.moodboard__underline')];\n\t\t\tTweenMax.set(values, { transformOrigin: '0 50%', scaleX: 0 });\n\t\t\tTweenMax.to(values, 0.50, {\n\t\t\t\tscaleX: 1,\n\t\t\t\ttransformOrigin: '0 50%',\n\t\t\t\tdelay: 0,\n\t\t\t\tease: Power3.easeInOut,\n\t\t\t\toverwrite: 'all',\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic factory($compile) {\n\t\treturn new MoodboardSearchDirective($compile);\n\t}\n\n}\n\nMoodboardSearchDirective.factory.$inject = ['$compile'];\n","\n\n\nclass MoodboardSectionCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService,\n\t\tApiService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.apiService = ApiService;\n\t\tthis.filters = window.filters || {};\n\t\tObject.keys(this.filters).forEach(key => {\n\t\t\tconst filter = this.filters[key];\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tconst value = {};\n\t\t\t\tvalue[key] = option.value;\n\t\t\t\tconst q = this.locationService.getSerialization('filters', value);\n\t\t\t\toption.query = `?q=${q}`;\n\t\t\t\t// console.log(option.query, option.value);\n\t\t\t});\n\t\t});\n\t}\n\n}\n\nMoodboardSectionCtrl.$inject = ['$scope', '$timeout', 'LocationService', 'ApiService'];\n\nexport default MoodboardSectionCtrl;\n","import { first } from 'rxjs/operators';\r\nimport GtmService from '../gtm/gtm.service';\r\nconst GTM_CAT = 'moodboard';\r\n\r\nexport const MOOD_TYPES = Object.freeze({\r\n\tTile: 1,\r\n\tHorizontal: 2,\r\n\tVertical: 3,\r\n\tCard: 4,\r\n\tDecor: 5\r\n});\r\n\r\nexport const ITEMS_PER_PAGE = 20;\r\n\r\nclass MoodboardCtrl {\r\n\r\n\tconstructor(\r\n\t\t$scope,\r\n\t\t$timeout,\r\n\t\tLocationService,\r\n\t\tApiService\r\n\t) {\r\n\t\tthis.$scope = $scope;\r\n\t\tthis.$timeout = $timeout;\r\n\t\tthis.locationService = LocationService;\r\n\t\tthis.apiService = ApiService;\r\n\t\tthis.filters = window.filters || {};\r\n\t\tthis.filteredItems = [];\r\n\t\tthis.initialFilters = window.initialFilters || null;\r\n\t\tthis.moodTypes = MOOD_TYPES;\r\n\t\tthis.deserializeFilters(this.initialFilters);\r\n\t\tthis.applyFilters(false);\r\n\t}\r\n\r\n\tdeserializeFilters() {\r\n\t\tconst locationFilters = this.locationService.deserialize('filters') || this.initialFilters || {};\r\n\t\t// console.log('MoodboardCtrl.deserializeFilters', filters);\r\n\t\tObject.keys(this.filters).forEach(x => {\r\n\t\t\tconst filter = this.filters[x];\r\n\t\t\tswitch (x) {\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tfilter.doFilter = (item, value) => {\r\n\t\t\t\t\t\t// console.log(item, value);\r\n\t\t\t\t\t\tthis.applyFilters(item, value);\r\n\t\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tfilter.options.unshift({\r\n\t\t\t\tlabel: filter.placeholder,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[x] || null)));\r\n\t\t\tfilter.value = selectedOption.value;\r\n\t\t\tfilter.placeholder = selectedOption.label;\r\n\t\t\t// console.log(x, filters[x], filter.value);\r\n\t\t});\r\n\t\treturn filters;\r\n\t}\r\n\r\n\tserializeFilters() {\r\n\t\tlet filters = {};\r\n\t\tlet any = false;\r\n\t\tObject.keys(this.filters).forEach(x => {\r\n\t\t\tconst filter = this.filters[x];\r\n\t\t\tif (filter.value !== null) {\r\n\t\t\t\tfilters[x] = filter.value;\r\n\t\t\t\tany = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!any) {\r\n\t\t\tfilters = this.initialFilters ? {} : null;\r\n\t\t}\r\n\t\t// console.log('MoodboardCtrl.serializeFilters', filters);\r\n\t\tthis.locationService.serialize('filters', filters);\r\n\t\treturn filters;\r\n\t}\r\n\r\n\tapplyFilters(serialize) {\r\n\t\t// console.log('MoodboardCtrl.applyFilters', this.filters);\r\n\t\tif (serialize !== false) this.serializeFilters();\r\n\t\tvar me = this;\r\n\t\tconst filters = {};\r\n\t\tlet anyFilter = false;\r\n\t\tObject.keys(this.filters).map(key => {\r\n\t\t\tconst v = me.filters[key].value;\r\n\t\t\tif (v !== null) {\r\n\t\t\t\tfilters[key] = v;\r\n\t\t\t\tanyFilter = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (anyFilter) {\r\n\t\t\tthis.apiService.moodboard.filter(filters).pipe(\r\n\t\t\t\tfirst()\r\n\t\t\t).subscribe(\r\n\t\t\t\tsuccess => {\r\n\t\t\t\t\tlet items = success.data;\r\n\t\t\t\t\tthis.filteredItems = [];\r\n\t\t\t\t\tthis.visibleItems = [];\r\n\t\t\t\t\tthis.maxItems = ITEMS_PER_PAGE;\r\n\t\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t\tthis.filteredItems = items;\r\n\t\t\t\t\t\tthis.visibleItems = items.slice(0, this.maxItems);\r\n\t\t\t\t\t}, 50);\r\n\t\t\t\t},\r\n\t\t\t\terror => console.log('MoodboardCtrl.applyFilters.error', error)\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\r\n\t}\r\n\r\n\tonScroll(event) {\r\n\t\tif (event.rect.bottom < event.windowRect.bottom) {\r\n\t\t\t// console.log('more!');\r\n\t\t\tif (!this.busy && this.maxItems < this.filteredItems.length) {\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\tthis.busy = true;\r\n\t\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t\tthis.maxItems += ITEMS_PER_PAGE;\r\n\t\t\t\t\t\tthis.visibleItems = this.filteredItems.slice(0, this.maxItems);\r\n\t\t\t\t\t\tthis.busy = false;\r\n\t\t\t\t\t\t// console.log(this.visibleItems.length);\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t}, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nMoodboardCtrl.$inject = ['$scope', '$timeout', 'LocationService', 'ApiService'];\r\n\r\nexport default MoodboardCtrl;\r\n","\n\nexport const ITEMS_PER_PAGE = 9;\n\nimport GtmService from '../gtm/gtm.service';\nconst GTM_CAT = 'news';\n\nclass NewsCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.filters = window.filters || {};\n\t\tthis.news = window.news || [];\n\t\tthis.initialFilters = window.initialFilters || null;\n\t\tthis.filteredItems = [];\n\t\t//// !!! FAKE\n\t\t//while (this.news.length < 100) {\n\t\t//\tthis.news = this.news.concat(this.news);\n\t\t//}\n\t\t//// !!! FAKE\n\t\tthis.deserializeFilters(this.initialFilters);\n\t\tthis.applyFilters(false);\n\t}\n\n\tdeserializeFilters(initialFilter) {\n\t\tconst locationFilters = this.locationService.deserialize('filters') || initialFilter || {};\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tswitch (x) {\n\t\t\t\tcase 'categories':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.categoryId === value;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'years':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.year === value;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tfilter.options.unshift({\n\t\t\t\tlabel: this.filters[x].placeholder,\n\t\t\t\tvalue: null,\n\t\t\t});\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[x] || null)));\n\t\t\tfilter.value = selectedOption.value;\n\t\t\tfilter.placeholder = selectedOption.label;\n\t\t});\n\t\treturn filters;\n\t}\n\n\tserializeFilters() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[x] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\t// console.log('ReferenceCtrl.serializeFilters', filters);\n\t\tthis.locationService.serialize('filters', filters);\n\t\treturn filters;\n\t}\n\n\tapplyFilters(serialize) {\n\t\tif (serialize !== false) this.serializeFilters();\n\t\tconst { filteredItems } = this.getFilteredItems(this.news);\n\t\t// console.log(filteredItems, filters);\n\t\tthis.filteredItems = [];\n\t\tthis.visibleItems = [];\n\t\tthis.maxItems = ITEMS_PER_PAGE;\n\t\tthis.$timeout(() => {\n\t\t\tthis.filteredItems = filteredItems;\n\t\t\tthis.visibleItems = filteredItems.slice(0, this.maxItems);\n\t\t\tthis.updateFilterStates(this.news);\n\t\t\t// delayer for image update\n\t\t}, 50);\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\n\t}\n\n\tgetFilteredItems(items, skipFilter) {\n\t\tconst filters = Object.keys(this.filters).map((x) => this.filters[x]).filter(x => x.value !== null);\n\t\tlet filteredItems = items.slice();\n\t\tif (filters.length) {\n\t\t\tfilteredItems = filteredItems.filter(item => {\n\t\t\t\tlet has = true;\n\t\t\t\tfilters.forEach(filter => {\n\t\t\t\t\tif (filter !== skipFilter) {\n\t\t\t\t\t\thas = has && filter.doFilter(item, filter.value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn has;\n\t\t\t});\n\t\t}\n\t\treturn { filteredItems };\n\t}\n\n\tupdateFilterStates(items) {\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tconst { filteredItems } = this.getFilteredItems(items, filter);\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tlet has = false;\n\t\t\t\tif (option.value) {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\twhile (i < filteredItems.length && !has) {\n\t\t\t\t\t\tconst item = filteredItems[i];\n\t\t\t\t\t\thas = filter.doFilter(item, option.value);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thas = true;\n\t\t\t\t}\n\t\t\t\toption.disabled = !has;\n\t\t\t});\n\t\t});\n\t}\n\n\tsetFilter(item, filter) {\n\t\titem = item || filter.options[0];\n\t\tfilter.value = item.value;\n\t\tfilter.placeholder = item.label;\n\t\tthis.applyFilters();\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t}\n\n\tremoveFilter(filter) {\n\t\tthis.setFilter(null, filter);\n\t}\n\n\tonScroll(event) {\n\t\tif (event.rect.bottom < event.windowRect.bottom) {\n\t\t\t// console.log('more!');\n\t\t\tif (!this.busy && this.maxItems < this.filteredItems.length) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tthis.busy = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tthis.maxItems += ITEMS_PER_PAGE;\n\t\t\t\t\t\tthis.visibleItems = this.filteredItems.slice(0, this.maxItems);\n\t\t\t\t\t\tthis.busy = false;\n\t\t\t\t\t\t// console.log(this.visibleItems.length);\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\t}\n}\n\nNewsCtrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default NewsCtrl;\n","\n\nimport GtmService from '../gtm/gtm.service';\nconst GTM_CAT = 'references';\n\nclass ReferencesCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.filters = window.filters || {};\n\t\tthis.references = window.references || [];\n\t\tthis.initialFilters = window.initialFilters || null;\n\t\tthis.deserializeFilters(this.initialFilters);\n\t\tthis.applyFilters(false);\n\t}\n\n\tdeserializeFilters(initialFilter) {\n\t\tconst locationFilters = this.locationService.deserialize('filters') || initialFilter || {};\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tswitch (x) {\n\t\t\t\tcase 'collections':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.collections.indexOf(value) !== -1;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'countries':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.countryId === value;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.features.indexOf(value) !== -1;\n\t\t\t\t\t};\n\t\t\t}\n\t\t\tfilter.options.unshift({\n\t\t\t\tlabel: this.filters[x].placeholder,\n\t\t\t\tvalue: null,\n\t\t\t});\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[x] || null)));\n\t\t\tfilter.value = selectedOption.value;\n\t\t\tfilter.placeholder = selectedOption.label;\n\t\t});\n\t\treturn filters;\n\t}\n\n\tserializeFilters() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[x] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\t// console.log('ReferenceCtrl.serializeFilters', filters);\n\t\tthis.locationService.serialize('filters', filters);\n\t\treturn filters;\n\t}\n\n\tapplyFilters(serialize) {\n\t\tif (serialize !== false) this.serializeFilters();\n\t\tconst { filteredItems } = this.getFilteredItems(this.references);\n\t\tthis.filteredReferences = [];\n\t\tthis.$timeout(() => {\n\t\t\tthis.filteredReferences = filteredItems;\n\t\t\tthis.updateFilterStates(this.references, filteredItems);\n\t\t\t// delayer for image update\n\t\t}, 50);\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\n\t}\n\n\tgetFilteredItems(items, skipFilter) {\n\t\tconst filters = Object.keys(this.filters).map((x) => this.filters[x]).filter(x => x.value !== null);\n\t\tlet filteredItems = items.slice();\n\t\tif (filters.length) {\n\t\t\tfilteredItems = filteredItems.filter(item => {\n\t\t\t\tlet has = true;\n\t\t\t\tfilters.forEach(filter => {\n\t\t\t\t\tif (filter !== skipFilter) {\n\t\t\t\t\t\thas = has && filter.doFilter(item, filter.value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn has;\n\t\t\t});\n\t\t}\n\t\treturn { filteredItems };\n\t}\n\n\tupdateFilterStates(items) {\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tconst { filteredItems } = this.getFilteredItems(items, filter);\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tlet has = false;\n\t\t\t\tif (option.value) {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\twhile (i < filteredItems.length && !has) {\n\t\t\t\t\t\tconst item = filteredItems[i];\n\t\t\t\t\t\thas = filter.doFilter(item, option.value);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thas = true;\n\t\t\t\t}\n\t\t\t\toption.disabled = !has;\n\t\t\t});\n\t\t});\n\t}\n\n\tsetFilter(item, filter) {\n\t\titem = item || filter.options[0];\n\t\tfilter.value = item.value;\n\t\tfilter.placeholder = item.label;\n\t\tthis.applyFilters();\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t}\n\n\tremoveFilter(filter) {\n\t\tthis.setFilter(null, filter);\n\t}\n\n}\n\nReferencesCtrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default ReferencesCtrl;\n","import { Subject } from \"rxjs\";\nimport { takeUntil } from \"rxjs/operators\";\n\nclass RootCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tDomService,\n\t\tApiService,\n\t\tWishlistService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.domService = DomService;\n\t\tthis.apiService = ApiService;\n\t\tthis.wishlistService = WishlistService;\n\t\tthis.unsubscribe = new Subject();\n\t\tthis.wishlistService.count$.pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(count => {\n\t\t\tthis.wishlistCount = count;\n\t\t});\n\t\t$scope.$on('onMuuri', () => {\n\t\t\tthis.domService.secondaryScroll$_.next({ target: window });\n\t\t});\n\t\t$scope.$on('destroy', () => {\n\t\t\t// console.log('destroy');\n\t\t\tthis.unsubscribe.next();\n\t\t\tthis.unsubscribe.complete();\n\t\t});\n\t}\n\n\tonSearch(query) {\n\t\t// console.log('onSearch', query);\n\t\tthis.searchOpened = false;\n\t\tconst url = document.querySelector('[data-search]').getAttribute('data-search');\n\t\twindow.location.href = url.replace('##query##', query);\n\t}\n\n\tonScroll(event) {\n\t\tconst scrolled = event.scroll.scrollTop > 40;\n\t\tconst direction = event.scroll.direction;\n\t\tif (this.droppedIn) {\n\t\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t\t}\n\t\tif (event.scroll.direction) {\n\t\t\tif (direction && (this.direction !== direction || this.scrolled !== scrolled)) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tthis.scrolled = scrolled;\n\t\t\t\t\tthis.direction = direction;\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tonInit(brand) {\n\t\tthis.brand = brand;\n\t\tthis.webglEnabled = false; // this.domService.hasWebglSupport();\n\t\tthis.domService.addCustomRules();\n\t\t/*\n\t\tthis.domService.smoothScroll$('.page').subscribe((top) => {\n\t\t\t// console.log(top);\n\t\t});\n\t\t*/\n\t\tthis.$timeout(() => {\n\t\t\tthis.init = true;\n\t\t\tconst view = document.querySelector('.view');\n\t\t\tTweenMax.to(view, 0.6, {\n\t\t\t\topacity: 1,\n\t\t\t\tdelay: 0,\n\t\t\t\toverwrite: 'all'\n\t\t\t});\n\t\t}, 1000);\n\t\tthis.$scope.$on('onDroppinIn', (scope, droppinIn) => {\n\t\t\t// console.log('onDroppinIn', droppinIn);\n\t\t\tthis.$timeout(() => {\n\t\t\t\tthis.droppinIn = droppinIn;\n\t\t\t});\n\t\t});\n\t}\n\n\tgetClasses() {\n\t\tconst classes = {};\n\t\tclasses[this.brand] = true;\n\t\tif (this.init) {\n\t\t\tclasses.init = true;\n\t\t}\n\t\tif (this.direction === -1) {\n\t\t\tclasses['scrolled-up'] = true;\n\t\t}\n\t\tif (this.direction === 1) {\n\t\t\tclasses['scrolled-down'] = true;\n\t\t}\n\t\tif (this.droppinIn || this.menuOpened || this.menuProductOpened) {\n\t\t\tclasses['droppin-in'] = true;\n\t\t}\n\t\tif (this.domService.isIE()) {\n\t\t\tclasses[this.domService.isIE()] = true;\n\t\t}\n\t\treturn classes;\n\t}\n\n\tcloseNav() {\n\t\tconst node = document.querySelector(`.section--submenu.active`);\n\t\treturn this.onDroppedOut(node);\n\t}\n\n\topenNav(nav) {\n\t\tconst node = document.querySelector(`#nav-${nav} .section--submenu`);\n\t\treturn this.onDroppedIn(node);\n\t}\n\n\ttoggleNav(id) {\n\t\tthis.nav = (this.nav === id ? null : id);\n\t\tthis.closeNav().then(() => {\n\t\t\tif (this.nav) {\n\t\t\t\tthis.openNav(this.nav);\n\t\t\t}\n\t\t});\n\t}\n\n\tonDroppedOut(node) {\n\t\t// console.log('onDroppedOut', node);\n\t\tif (node) {\n\t\t\tthis.droppedIn = false;\n\t\t\tif (this.droppinIn) {\n\t\t\t\tTweenMax.set(node, { height: 0 });\n\t\t\t\treturn Promise.resolve();\n\t\t\t} else {\n\t\t\t\tTweenMax.set(node, { overflow: 'hidden' });\n\t\t\t\tTweenMax.to(node, 0.6, {\n\t\t\t\t\theight: 0,\n\t\t\t\t\tease: Expo.easeOut,\n\t\t\t\t\toverwrite: 'all',\n\t\t\t\t\tonComplete: () => {\n\t\t\t\t\t\tdelete node.style.overflow;\n\t\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\t/*\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (node) {\n\t\t\t\tconst items = [].slice.call(node.querySelectorAll('.submenu__item'));\n\t\t\t\tTweenMax.staggerTo(items.reverse(), 0.25, {\n\t\t\t\t\topacity: 0,\n\t\t\t\t\tstagger: 0.05,\n\t\t\t\t\tdelay: 0.0,\n\t\t\t\t\tonComplete: () => {\n\t\t\t\t\t\tTweenMax.to(node, 0.2, {\n\t\t\t\t\t\t\tmaxHeight: 0,\n\t\t\t\t\t\t\tease: Expo.easeOut,\n\t\t\t\t\t\t\tdelay: 0.0,\n\t\t\t\t\t\t\tonComplete: () => {\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t\t*/\n\t}\n\n\tonDroppedIn(node) {\n\t\t// console.log('onDroppedIn', node);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.droppedIn = true;\n\t\t\tthis.droppinIn = true;\n\t\t\tconst items = [].slice.call(node.querySelectorAll('.submenu__item'));\n\t\t\tTweenMax.set(items, { opacity: 0 });\n\t\t\tTweenMax.set(node, { height: 'auto' });\n\t\t\tconst mh = node.offsetHeight;\n\t\t\tTweenMax.set(node, { height: 0, overflow: 'hidden' });\n\t\t\tTweenMax.to(node, 0.8, {\n\t\t\t\theight: mh,\n\t\t\t\tease: Expo.easeOut,\n\t\t\t\tdelay: 0.0,\n\t\t\t\toverwrite: 'all',\n\t\t\t\tonComplete: () => {\n\t\t\t\t\tdelete node.style.overflow;\n\t\t\t\t\tTweenMax.set(node, { height: 'auto' });\n\t\t\t\t\t// TweenMax.set(node, { clearProps: 'all' });\n\t\t\t\t\tif (items.length === 0) {\n\t\t\t\t\t\tthis.droppinIn = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (items.length) {\n\t\t\t\tTweenMax.staggerTo(items, 0.35, {\n\t\t\t\t\topacity: 1,\n\t\t\t\t\tstagger: 0.07,\n\t\t\t\t\tdelay: 0.5,\n\t\t\t\t\tonComplete: () => {\n\t\t\t\t\t\tthis.droppinIn = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleBrand(event) {\n\t\tconst brands = ['atlas-concorde', 'atlas-concorde-solution', 'atlas-concorde-usa', 'atlas-concorde-russia'];\n\t\tconst i = (brands.indexOf(this.brand) + 1) % brands.length;\n\t\tthis.brand = brands[i];\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\t}\n\n\ttoggleMenuProduct() {\n\t\tthis.menuProductOpened = !this.menuProductOpened;\n\t\tif (!this.menuProductOpened) {\n\t\t\tconst results = document.querySelector('.section--filters');\n\t\t\tconst bottom = this.domService.scrollTop + results.getBoundingClientRect().bottom;\n\t\t\tsetTimeout(() => {\n\t\t\t\twindow.scroll(0, bottom - 80);\n\t\t\t\t// console.log('toggleMenuProduct', results, bottom, this.domService.scrollTop);\n\t\t\t}, 500);\n\t\t}\n\t}\n\n\tpad(index) {\n\t\treturn index < 10 ? '0' + index : index;\n\t}\n\n\thasHash(hash) {\n\t\treturn window.location.hash.indexOf(hash) !== -1;\n\t}\n\n}\n\nRootCtrl.$inject = ['$scope', '$timeout', 'DomService', 'ApiService', 'WishlistService'];\n\nexport default RootCtrl;\n","\n\nimport { from } from 'rxjs';\n\nexport const API_DEV = window.location.port === '6001' || window.location.host === 'actarian.github.io';\nexport const API_HREF = API_DEV ? 'https://atlasconcorde.wslabs.it' : '';\n\nexport default class ApiService {\n\n\tconstructor($http) {\n\t\tthis.http = $http;\n\t\tconst api = {\n\t\t\tadvancedSearch: {\n\t\t\t\tget: () => {\n\t\t\t\t\treturn from($http.get('data/advanced-search.json'));\n\t\t\t\t\t// return from($http.get(API_HREF + '/api/advanced-search/json'));\n\t\t\t\t},\n\t\t\t},\n\t\t\twishlist: {\n\t\t\t\tget: () => {\n\t\t\t\t\tif (!API_DEV) {\n\t\t\t\t\t\treturn from(this.$http.post('', this.wishlist));\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn from(this.$http.get('data/moodboard.json').then(success => {\n\t\t\t\t\t\t\tif (success.data) {\n\t\t\t\t\t\t\t\treturn success.data;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttoggle: (item) => {\n\t\t\t\t\titem.added = !item.added;\n\t\t\t\t\treturn Promise.resolve(item);\n\t\t\t\t},\n\t\t\t\tclearAll: () => {\n\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t},\n\t\t\t},\n\t\t\tmoodboard: {\n\t\t\t\tfilter: (filters) => {\n\t\t\t\t\tif (!API_DEV) {\n\t\t\t\t\t\treturn from($http.post('', filters));\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn from($http.get('data/moodboard.json'));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tstoreLocator: {\n\t\t\t\tall: () => {\n\t\t\t\t\tif (!API_DEV) {\n\t\t\t\t\t\treturn $http.get(API_HREF + '/api/store/json');\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn $http.get('data/store-locator.json');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tObject.assign(this, api);\n\t}\n\n\tstatic factory($http) {\n\t\treturn new ApiService($http);\n\t}\n\n}\n\nApiService.factory.$inject = ['$http'];\n\nApiService.API_DEV = API_DEV;\n","\n\nimport { BehaviorSubject, from } from \"rxjs\";\nimport GtmService from '../gtm/gtm.service';\nimport { API_DEV } from './api.service';\n\nexport default class WishlistService {\n\n\tconstructor(\n\t\t$http,\n\t\tPromiseService,\n\t\tStorageService,\n\t\tApiService\n\t) {\n\t\tthis.$http = $http;\n\t\tthis.promise = PromiseService;\n\t\tthis.storage = StorageService;\n\t\tthis.api = ApiService;\n\t\tthis.count$ = WishlistService.count$;\n\t\tconst count = this.wishlist.length;\n\t\t// console.log('WishlistService', this.storage);\n\t}\n\n\tget wishlist() {\n\t\tif (!this.wishlist_) {\n\t\t\tconst wishlist = this.storage.get('wishlist');\n\t\t\tthis.wishlist_ = wishlist || [];\n\t\t\tWishlistService.count$.next(this.wishlist_.length);\n\t\t}\n\t\treturn this.wishlist_;\n\t}\n\n\tset wishlist(wishlist) {\n\t\tthis.wishlist_ = wishlist || [];\n\t\tthis.storage.set('wishlist', this.wishlist_);\n\t\tWishlistService.count$.next(this.wishlist_.length);\n\t}\n\n\tindexOf(item) {\n\t\tif (item) {\n\t\t\tconst index = this.wishlist.reduce((p, c, i) => {\n\t\t\t\tif (p === -1) {\n\t\t\t\t\treturn c.id === item.id && c.coId === item.coId ? i : p;\n\t\t\t\t} else {\n\t\t\t\t\treturn p;\n\t\t\t\t}\n\t\t\t}, -1);\n\t\t\treturn index;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\thas(item) {\n\t\treturn this.indexOf(item) !== -1;\n\t}\n\n\tadd(item) {\n\t\treturn this.promise.make((promise) => {\n\t\t\tconst wishlist = this.wishlist;\n\n\t\t\tGtmService.push({\n\t\t\t\tevent: 'addWishlist',\n\t\t\t\twish_name: item.name || item.coId,\n\t\t\t\twish_type: item.typeName || item.type\n\t\t\t});\n\n\t\t\twishlist.push({ id: item.id, coId: item.coId, type: item.type, typeName: item.typeName, name: item.name });\n\t\t\tthis.wishlist = wishlist;\n\t\t\tpromise.resolve(true);\n\t\t});\n\t}\n\n\tremove(item) {\n\t\treturn this.promise.make((promise) => {\n\t\t\tconst index = this.indexOf(item);\n\t\t\tconst wishlist = this.wishlist;\n\n\t\t\tGtmService.push({\n\t\t\t\tevent: 'removeWishlist',\n\t\t\t\twish_name: wishlist[index].name || wishlist[index].coId,\n\t\t\t\twish_type: wishlist[index].typeName || wishlist[index].type\n\t\t\t});\n\n\t\t\twishlist.splice(index, 1);\n\t\t\tthis.wishlist = wishlist;\n\t\t\tpromise.resolve(false);\n\t\t});\n\t}\n\n\ttoggle(item) {\n\t\tif (this.has(item)) {\n\t\t\treturn this.remove(item);\n\t\t} else {\n\t\t\treturn this.add(item);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\treturn from(this.promise.make((promise) => {\n\t\t\tconst wishlist = [];\n\t\t\tthis.wishlist = wishlist;\n\t\t\tpromise.resolve(wishlist);\n\t\t}));\n\t}\n\n\tget() {\n\t\tif (!API_DEV) {\n\t\t\treturn from(this.$http.post('', this.wishlist).then(success => {\n\t\t\t\treturn success;\n\t\t\t}));\n\t\t} else {\n\t\t\treturn from(this.$http.get('data/moodboard.json').then(success => {\n\t\t\t\tif (success.data) {\n\t\t\t\t\tthis.wishlist = success.data;\n\t\t\t\t}\n\t\t\t\treturn success;\n\t\t\t}));\n\t\t}\n\t}\n\n\tstatic factory($http, PromiseService, StorageService, ApiService) {\n\t\treturn new WishlistService($http, PromiseService, StorageService, ApiService);\n\t}\n\n}\n\nWishlistService.count$ = new BehaviorSubject(0);\n\nWishlistService.factory.$inject = ['$http', 'PromiseService', 'LocalStorageService', 'ApiService'];\n","export default class LocationService {\n\n\tconstructor(\n\t\t$location\n\t) {\n\t\tthis.$location = $location;\n\t}\n\n\tget(key) {\n\t\treturn this.$location.search()[key];\n\t}\n\n\tset(keyOrValue, value) {\n\t\tif (typeof keyOrValue === 'string') {\n\t\t\tthis.$location.search(keyOrValue, value).replace();\n\t\t} else {\n\t\t\tthis.$location.search(keyOrValue).replace();\n\t\t}\n\t}\n\n\tdeserialize_(key, serialized) {\n\t\tlet value = null;\n\t\t// console.log(serialized);\n\t\tif (serialized) {\n\t\t\tconst json = window.atob(serialized);\n\t\t\tvalue = JSON.parse(json);\n\t\t}\n\t\t// console.log(value);\n\t\tif (key && value) {\n\t\t\tvalue = value[key];\n\t\t}\n\t\treturn value || null;\n\t}\n\n\tserialize_(keyOrValue, value, q) {\n\t\tq = q || {};\n\t\tlet serialized = null;\n\t\tif (typeof keyOrValue === 'string') {\n\t\t\tq[keyOrValue] = value;\n\t\t} else {\n\t\t\tq = keyOrValue;\n\t\t}\n\t\tconst json = JSON.stringify(q);\n\t\tserialized = window.btoa(json);\n\t\treturn serialized;\n\t}\n\n\tdeserialize(key) {\n\t\tconst serialized = this.get('q');\n\t\treturn this.deserialize_(key, serialized);\n\t}\n\n\tserialize(keyOrValue, value) {\n\t\tconst q = this.deserialize();\n\t\tconst serialized = this.serialize_(keyOrValue, value, q);\n\t\tthis.set('q', serialized);\n\t}\n\n\tgetSerialization(keyOrValue, value) {\n\t\tlet serialized = null;\n\t\tlet q = {};\n\t\tif (typeof keyOrValue === 'string') {\n\t\t\tq[keyOrValue] = value;\n\t\t} else {\n\t\t\tq = keyOrValue;\n\t\t}\n\t\tconst json = JSON.stringify(q);\n\t\tserialized = window.btoa(json);\n\t\treturn serialized;\n\t}\n\n\tstatic factory($location) {\n\t\treturn new LocationService($location);\n\t}\n\n}\n\nLocationService.factory.$inject = ['$location'];\n","export default class PromiseService {\n\n\tconstructor(\n\t\t$q\n\t) {\n\t\tthis.$q = $q;\n\t}\n\n\tmake(callback) {\n\t\tif (typeof callback !== 'function') {\n\t\t\tthrow ('promise resolve callback missing');\n\t\t}\n\t\tconst deferred = this.$q.defer();\n\t\tcallback(deferred);\n\t\treturn deferred.promise;\n\t}\n\n\tall(promises) {\n\t\treturn this.$q.all(promises);\n\t}\n\n\tstatic factory($q) {\n\t\treturn new PromiseService($q);\n\t}\n\n}\n\nPromiseService.factory.$inject = ['$q'];\n","\n\n\nconst DELAY = 3000;\n\nexport class State {\n\n\tconstructor(\n\t\t$timeout,\n\t\t$rootScope\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.$rootScope = $rootScope;\n\t\tthis.idle();\n\t}\n\n\tidle() {\n\t\tthis.isBusy = false;\n\t\tthis.isError = false;\n\t\tthis.isErroring = false;\n\t\tthis.isSuccess = false;\n\t\tthis.isSuccessing = false;\n\t\tthis.button = null;\n\t\tthis.errors = [];\n\t}\n\n\tbusy() {\n\t\tif (!this.isBusy) {\n\t\t\tthis.isBusy = true;\n\t\t\tthis.isError = false;\n\t\t\tthis.isErroring = false;\n\t\t\tthis.isSuccess = false;\n\t\t\tthis.isSuccessing = false;\n\t\t\tthis.errors = [];\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tclasses(addons) {\n\t\tconst classes = {\n\t\t\tready: this.isReady,\n\t\t\tbusy: this.isBusy,\n\t\t\tsuccessing: this.isSuccessing,\n\t\t\tsuccess: this.isSuccess,\n\t\t\terrorring: this.isErroring,\n\t\t\terror: this.isError,\n\t\t};\n\t\tif (addons) {\n\t\t\tObject.keys(addons).forEach((key) => {\n\t\t\t\tclasses[addons[key]] = classes[key];\n\t\t\t});\n\t\t}\n\t\treturn classes;\n\t}\n\n\tenabled() {\n\t\treturn !this.isBusy && !this.isErroring && !this.isSuccessing;\n\t}\n\n\terror(error) {\n\t\tconsole.log('State.error', error);\n\t\tthis.isBusy = false;\n\t\tthis.isError = true;\n\t\tthis.isErroring = true;\n\t\tthis.isSuccess = false;\n\t\tthis.isSuccessing = false;\n\t\tthis.errors.push(error);\n\t\tthis.$timeout(() => {\n\t\t\tthis.isErroring = false;\n\t\t}, DELAY);\n\t}\n\n\terrorMessage() {\n\t\treturn this.isError ? this.errors[this.errors.length - 1] : null;\n\t}\n\n\tlabels(addons) {\n\t\tconst defaults = {\n\t\t\tready: 'submit',\n\t\t\tbusy: 'sending',\n\t\t\terror: 'error',\n\t\t\tsuccess: 'success',\n\t\t};\n\t\tif (addons) {\n\t\t\tangular.extend(defaults, addons);\n\t\t}\n\t\tlet label = defaults.ready;\n\t\tif (this.isBusy) {\n\t\t\tlabel = defaults.busy;\n\t\t} else if (this.isSuccess) {\n\t\t\tlabel = defaults.success;\n\t\t} else if (this.isError) {\n\t\t\tlabel = defaults.error;\n\t\t}\n\t\treturn label;\n\t}\n\n\tready() {\n\t\tthis.idle();\n\t\tthis.isReady = true;\n\t\tthis.$rootScope.$broadcast('$thisReady', this);\n\t}\n\n\tsubmitClass() {\n\t\treturn {\n\t\t\tbusy: this.isBusy,\n\t\t\tready: this.isReady,\n\t\t\tsuccessing: this.isSuccessing,\n\t\t\tsuccess: this.isSuccess,\n\t\t\terrorring: this.isErroring,\n\t\t\terror: this.isError,\n\t\t};\n\t}\n\n\tsuccess() {\n\t\tthis.isBusy = false;\n\t\tthis.isError = false;\n\t\tthis.isErroring = false;\n\t\tthis.isSuccess = true;\n\t\tthis.isSuccessing = true;\n\t\tthis.errors = [];\n\t\tthis.$timeout(() => {\n\t\t\tthis.isSuccessing = false;\n\t\t}, DELAY);\n\t}\n\n}\n\nexport default class StateService {\n\n\tconstructor(\n\t\t$timeout,\n\t\t$rootScope\n\t) {\n\t\tthis.$timeout = $timeout;\n\t\tthis.$rootScope = $rootScope;\n\t}\n\n\tgetState() {\n\t\treturn new State(this.$timeout, this.$rootScope);\n\t}\n\n\tstatic factory($timeout, $rootScope) {\n\t\treturn new StateService($timeout, $rootScope);\n\t}\n\n}\n\nStateService.factory.$inject = ['$timeout', '$rootScope'];\n","const TIMEOUT = 5 * 60 * 1000; // five minutes\n\nexport class CookieService {\n\n\tconstructor(\n\t\tPromiseService\n\t) {\n\t\tthis.promise = PromiseService;\n\t}\n\n\tdelete(name) {\n\t\tsetter(name, '', -1);\n\t}\n\n\texist(name) {\n\t\treturn document.cookie.indexOf(';' + name + '=') !== -1 || document.cookie.indexOf(name + '=') === 0;\n\t}\n\n\tget(name) {\n\t\tconst cookieName = name + \"=\";\n\t\tconst ca = document.cookie.split(';');\n\t\tfor (let i = 0; i < ca.length; i++) {\n\t\t\tlet c = ca[i];\n\t\t\twhile (c.charAt(0) == ' ') {\n\t\t\t\tc = c.substring(1, c.length);\n\t\t\t}\n\t\t\tif (c.indexOf(cookieName) === 0) {\n\t\t\t\tconst value = c.substring(cookieName.length, c.length);\n\t\t\t\tlet model = null;\n\t\t\t\ttry {\n\t\t\t\t\tmodel = JSON.parse(decodeURIComponent(atob(value)));\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log('CookieService.get.error parsing', key, e);\n\t\t\t\t}\n\t\t\t\treturn model;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\ton(name) {\n\t\treturn this.promise.make((promise) => {\n\t\t\tlet i, interval = 1000,\n\t\t\t\telapsed = 0,\n\t\t\t\ttimeout = TIMEOUT;\n\n\t\t\tconst checkCookie = () => {\n\t\t\t\tif (elapsed > timeout) {\n\t\t\t\t\tpromise.reject('timeout');\n\t\t\t\t} else {\n\t\t\t\t\tconst c = this.get(name);\n\t\t\t\t\tif (c) {\n\t\t\t\t\t\tpromise.resolve(c);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telapsed += interval;\n\t\t\t\t\t\ti = setTimeout(checkCookie, interval);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tcheckCookie();\n\t\t});\n\t}\n\n\tset(name, value, days) {\n\t\ttry {\n\t\t\tconst cache = [];\n\t\t\tconst json = JSON.stringify(value, function(key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\tthis.setter(name, btoa(encodeURIComponent(json)), days);\n\t\t} catch (e) {\n\t\t\tconsole.log('CookieService.error serializing', name, value, e);\n\t\t}\n\t}\n\n\tsetter(name, value, days) {\n\t\tlet expires;\n\t\tif (days) {\n\t\t\tconst date = new Date();\n\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n\t\t\texpires = '; expires=' + date.toGMTString();\n\t\t} else {\n\t\t\texpires = '';\n\t\t}\n\t\tdocument.cookie = name + '=' + value + expires + '; path=/';\n\t}\n\n\tstatic factory(PromiseService) {\n\t\treturn new CookieService(PromiseService);\n\t}\n\n}\nCookieService.factory.$inject = ['PromiseService'];\n\nexport class LocalStorageService {\n\n\tconstructor(\n\t\tPromiseService\n\t) {\n\t\tthis.promise = PromiseService;\n\t}\n\n\tdelete(name) {\n\t\twindow.localStorage.removeItem(name);\n\t}\n\n\texist(name) {\n\t\treturn window.localStorage[name] !== undefined;\n\t}\n\n\tget(name) {\n\t\tlet value = null;\n\t\tif (window.localStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('LocalStorageService.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tset(name, value) {\n\t\ttry {\n\t\t\tconst cache = [];\n\t\t\tconst json = JSON.stringify(value, function(key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\twindow.localStorage.setItem(name, json);\n\t\t} catch (e) {\n\t\t\tconsole.log('LocalStorageService.set.error serializing', name, value, e);\n\t\t}\n\t}\n\n\ton(name) {\n\t\treturn this.promise.make((promise) => {\n\t\t\tlet i, interval = 1000,\n\t\t\t\telapsed = 0,\n\t\t\t\ttimeout = TIMEOUT;\n\n\t\t\tconst storageEvent = (e) => {\n\t\t\t\tif (i) {\n\t\t\t\t\tclearTimeout(i);\n\t\t\t\t}\n\t\t\t\tif (e.originalEvent.key == name) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('LocalStorageService.on.error parsing', name, error);\n\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\ti = setTimeout(function() {\n\t\t\t\tpromise.reject('timeout');\n\t\t\t}, timeout);\n\t\t});\n\t}\n\n\tstatic isLocalStorageSupported() {\n\t\tlet supported = false;\n\t\ttry {\n\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\n\t\t\tif (supported) {\n\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t} else {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tsupported = false;\n\t\t}\n\t\treturn supported;\n\t}\n\n\tstatic factory(PromiseService) {\n\t\tif (LocalStorageService.isLocalStorageSupported()) {\n\t\t\treturn new LocalStorageService(PromiseService);\n\t\t} else {\n\t\t\treturn new CookieService(PromiseService);\n\t\t}\n\t}\n\n}\nLocalStorageService.factory.$inject = ['PromiseService'];\n\nexport class SessionStorageService {\n\n\tconstructor(\n\t\tPromiseService\n\t) {\n\t\tthis.promise = PromiseService;\n\t}\n\n\tdelete(name) {\n\t\twindow.sessionStorage.removeItem(name);\n\t}\n\n\texist(name) {\n\t\treturn window.sessionStorage[name] !== undefined;\n\t}\n\n\tget(name) {\n\t\tlet value = null;\n\t\tif (window.sessionStorage[name] !== undefined) {\n\t\t\ttry {\n\t\t\t\tvalue = JSON.parse(window.sessionStorage[name]);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log('SessionStorageService.get.error parsing', name, e);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n\tset(name, value) {\n\t\ttry {\n\t\t\tconst cache = [];\n\t\t\tconst json = JSON.stringify(value, function(key, value) {\n\t\t\t\tif (key === 'pool') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (typeof value === 'object' && value !== null) {\n\t\t\t\t\tif (cache.indexOf(value) !== -1) {\n\t\t\t\t\t\t// Circular reference found, discard key\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcache.push(value);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t});\n\t\t\twindow.sessionStorage.setItem(name, json);\n\t\t} catch (e) {\n\t\t\tconsole.log('SessionStorageService.set.error serializing', name, value, e);\n\t\t}\n\t}\n\n\ton(name) {\n\t\treturn this.promise.make((promise) => {\n\t\t\tlet i, interval = 1000,\n\t\t\t\telapsed = 0,\n\t\t\t\ttimeout = TIMEOUT;\n\n\t\t\tconst storageEvent = (e) => {\n\t\t\t\tif (i) {\n\t\t\t\t\tclearTimeout(i);\n\t\t\t\t}\n\t\t\t\tif (e.originalEvent.key == name) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst value = JSON.parse(e.originalEvent.newValue); // , e.originalEvent.oldValue\n\t\t\t\t\t\tpromise.resolve(value);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('SessionStorageService.on.error parsing', name, error);\n\t\t\t\t\t\tpromise.reject('error parsing ' + name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tangular.element(window).on('storage', storageEvent);\n\t\t\ti = setTimeout(function() {\n\t\t\t\tpromise.reject('timeout');\n\t\t\t}, timeout);\n\t\t});\n\t}\n\n\tstatic isSessionStorageSupported() {\n\t\tlet supported = false;\n\t\ttry {\n\t\t\tsupported = 'sessionStorage' in window && window.sessionStorage !== null;\n\t\t\tif (supported) {\n\t\t\t\twindow.sessionStorage.setItem('test', '1');\n\t\t\t\twindow.localsessionStorageStorage.removeItem('test');\n\t\t\t} else {\n\t\t\t\tsupported = false;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tsupported = false;\n\t\t}\n\t\treturn supported;\n\t}\n\n\tstatic factory(PromiseService) {\n\t\tif (SessionStorageService.isSessionStorageSupported()) {\n\t\t\treturn new SessionStorageService(PromiseService);\n\t\t} else {\n\t\t\treturn new CookieService(PromiseService);\n\t\t}\n\t}\n\n}\nSessionStorageService.factory.$inject = ['PromiseService'];\n","import { Subject } from 'rxjs';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\nimport GtmService from '../gtm/gtm.service';\n\nconst GTM_CAT = 'store-locator';\nconst ZOOM_LEVEL = 13;\nconst SHOW_INFO_WINDOW = false;\nconst MAX_DISTANCE = 100;\nlet GOOGLE_MAPS = null;\n\nclass StoreLocatorCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tDomService,\n\t\tApiService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.domService = DomService;\n\t\tthis.apiService = ApiService;\n\t\tthis.model = {};\n\t\tthis.apiKey = window.apiKey || 'AIzaSyC9ZjpjjpaaDRZYkK5sjeyJahSUzKckgOM';\n\t\tthis.busyFind = false;\n\t\tthis.busyLocation = false;\n\t\tthis.visibleStores = [];\n\t\tthis.mapBoundsChanged$ = new Subject();\n\t\t//\n\t\t// When the window has finished loading create our google map below\n\t\tif (GOOGLE_MAPS !== null) {\n\t\t\tthis.initMap();\n\t\t} else {\n\t\t\twindow.onGoogleMapsLoaded = () => {\n\t\t\t\tGOOGLE_MAPS = google.maps;\n\t\t\t\tthis.initMap();\n\t\t\t};\n\t\t\tconst script = document.createElement('script');\n\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\tscript.setAttribute('src', `https://maps.googleapis.com/maps/api/js?key=${this.apiKey}&libraries=geometry&callback=onGoogleMapsLoaded`);\n\t\t\t(document.getElementsByTagName('head')[0] || document.documentElement).appendChild(script);\n\t\t\t/*\n\t\t\tgoogle.maps.event.addDomListener(window, 'load', () => {\n\t\t\t\tGOOGLE_MAPS = google.maps;\n\t\t\t\tthis.initMap();\n\t\t\t});\n\t\t\t*/\n\t\t}\n\t\t//\n\t\tthis.unsubscribe = new Subject();\n\t\tthis.mapBoundsChanged$.pipe(\n\t\t\tdebounceTime(1000),\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(bounds => {\n\t\t\tthis.findNearStores(this.stores, bounds.getCenter(), bounds);\n\t\t});\n\t\tthis.domService.secondaryScroll$(document.querySelector('.section--stores')).pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe((event) => {});\n\t\t$scope.$on('destroy', () => {\n\t\t\t// console.log('destroy');\n\t\t\tthis.unsubscribe.next();\n\t\t\tthis.unsubscribe.complete();\n\t\t});\n\t}\n\n\tinitMap() {\n\t\t// Basic options for a simple Google Map\n\t\t// For more options see: https://developers.google.com/maps/documentation/javascript/reference#MapOptions\n\t\tvar mapOptions = {\n\t\t\t// How zoomed in you want the map to start at (always required)\n\t\t\tzoom: 7,\n\t\t\t// The latitude and longitude to center the map (always required)\n\t\t\tcenter: new google.maps.LatLng(41.4632232, 14.3898072), // New York\n\t\t\t// How you would like to style the map.\n\t\t\t// This is where you would paste any style found on Snazzy Maps.\n\t\t\tstyles: [{ \"featureType\": \"administrative\", \"elementType\": \"geometry.fill\", \"stylers\": [{ \"visibility\": \"on\" }] }, { \"featureType\": \"administrative\", \"elementType\": \"labels.text.fill\", \"stylers\": [{ \"color\": \"#444444\" }] }, { \"featureType\": \"landscape\", \"elementType\": \"all\", \"stylers\": [{ \"color\": \"#f2f2f2\" }] }, { \"featureType\": \"poi\", \"elementType\": \"all\", \"stylers\": [{ \"visibility\": \"off\" }] }, { \"featureType\": \"road\", \"elementType\": \"all\", \"stylers\": [{ \"saturation\": -100 }, { \"lightness\": 45 }] }, { \"featureType\": \"road.highway\", \"elementType\": \"all\", \"stylers\": [{ \"visibility\": \"simplified\" }] }, { \"featureType\": \"road.arterial\", \"elementType\": \"labels.icon\", \"stylers\": [{ \"visibility\": \"off\" }] }, { \"featureType\": \"transit\", \"elementType\": \"all\", \"stylers\": [{ \"visibility\": \"off\" }] }, { \"featureType\": \"water\", \"elementType\": \"all\", \"stylers\": [{ \"color\": \"#ffffff\" }, { \"visibility\": \"on\" }] }]\n\t\t};\n\t\t// Get the HTML DOM element that will contain your map\n\t\t// We are using a div with id=\"map\" seen below in the <body>\n\t\tvar mapElement = document.getElementById('map');\n\t\tif (!mapElement) {\n\t\t\treturn;\n\t\t}\n\t\t// Create the Google Map using our element and options defined above\n\t\tvar map = new google.maps.Map(mapElement, mapOptions);\n\t\tmap.addListener('bounds_changed', () => {\n\t\t\tthis.mapBoundsChanged$.next(map.getBounds());\n\t\t});\n\t\tthis.$timeout(() => {\n\t\t\tthis.map = map;\n\t\t});\n\t\t// console.log('timeout');\n\t}\n\n\tcalculateDistance(lat1, lon1, lat2, lon2, unit) {\n\t\tif ((lat1 == lat2) && (lon1 == lon2)) {\n\t\t\treturn 0;\n\t\t} else {\n\t\t\tconst radlat1 = Math.PI * lat1 / 180;\n\t\t\tconst radlat2 = Math.PI * lat2 / 180;\n\t\t\tconst theta = lon1 - lon2;\n\t\t\tconst radtheta = Math.PI * theta / 180;\n\t\t\tlet dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\n\t\t\tif (dist > 1) {\n\t\t\t\tdist = 1;\n\t\t\t}\n\t\t\tdist = Math.acos(dist);\n\t\t\tdist = dist * 180 / Math.PI;\n\t\t\tdist = dist * 60 * 1.1515;\n\t\t\tif (unit == \"K\") {\n\t\t\t\tdist = dist * 1.609344;\n\t\t\t}\n\t\t\tif (unit == \"N\") {\n\t\t\t\tdist = dist * 0.8684;\n\t\t\t}\n\t\t\treturn dist;\n\t\t}\n\t}\n\n\taddMarkers(stores) {\n\t\tconst markers = stores.map((store) => {\n\t\t\tconst position = new google.maps.LatLng(store.latitude, store.longitude);\n\t\t\tlet content = `<div class=\"marker__content\">\n\t\t\t\t<div class=\"title\"><span>${store.name}</span></div>\n\t\t\t\t<div class=\"group group--info\">\n\t\t\t\t\t<div class=\"address\">\n\t\t\t\t\t\t${store.address}<br>\n\t\t\t\t\t\t${store.zip} ${store.citta} ${store.cod_provincia} ${store.stato}<br>\n\t\t\t\t\t\t<!--store.tel-->\n\t\t\t\t\t\t<!--store.email-->\n\t\t\t\t\t\t<!--store.webSite-->\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"distance\">${window.BOMLabels.store_locator_approx} <b>${Math.floor(store.distance)} km</b></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"group group--cta\">\n\t\t\t\t\t<!--store.pageurl-->\n\t\t\t\t\t<a id=\"locator-marker\" href=\"https://www.google.it/maps/dir/${this.position.lat()},${this.position.lng()}/${store.name}/@${store.latitude},${store.longitude}/\" target=\"_blank\" class=\"btn btn--link\"><span>${window.BOMLabels.store_locator_reach_store}</span></a>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\n\t\t\tif (store.tel)\n\t\t\t\tcontent = content.replace('<!--store.tel-->', `<span>${store.tel}<br></span>`);\n\t\t\tif (store.email)\n\t\t\t\tcontent = content.replace('<!--store.email-->', `<span><a href=\"/atlas/mailto:${store.email}\">${store.email}</a><br></span>`);\n\t\t\tif (store.webSite)\n\t\t\t\tcontent = content.replace('<!--store.webSite-->', `<span><a target=\"_blank\" href=\"${store.webSite}\">${store.webSite}</a></span>`);\n\t\t\tif (store.pageurl)\n\t\t\t\tcontent = content.replace('<!--store.pageurl-->', `<a id=\"locator-marker\" href=\"${store.pageurl}\" target=\"_blank\" class=\"btn btn--link\"><span>${window.BOMLabels.More_info}</span></a>`);\n\n\t\t\tconst marker = new google.maps.Marker({\n\t\t\t\tposition: position,\n\t\t\t\t// map: this.map,\n\t\t\t\ticon: store.importante ? '/img/store-locator/store-primary.png' : '/img/store-locator/store-secondary.png',\n\t\t\t\ttitle: store.name,\n\t\t\t\tstore: store,\n\t\t\t\tcontent: content,\n\t\t\t});\n\t\t\tmarker.addListener('click', () => {\n\t\t\t\tthis.setMarkerWindow(marker.position, content);\n\t\t\t\tthis.scrollToStore(store);\n\n\t\t\t\tGtmService.push({\n\t\t\t\t\tevent: 'dealerlocator',\n\t\t\t\t\taction: 'marker-click',\n\t\t\t\t\tlabel: store.name\n\t\t\t\t});\n\t\t\t});\n\t\t\tstore.marker = marker;\n\t\t\t/*\n\t\t\tmarker.addListener('mouseout', () => {\n\t\t\t\tthis.setMarkerWindow(null);\n\t\t\t});\n\t\t\t*/\n\t\t\treturn marker;\n\t\t\t/*\n\t\t\tfunction panTo(e) {\n\t\t\t\tif (current !== marker) {\n\t\t\t\t\tcurrent = marker;\n\t\t\t\t\tvar ll = new google.maps.LatLng(latlng[0], latlng[1]);\n\t\t\t\t\tmap.panTo(ll);\n\t\t\t\t\tonMarkerDidSelect();\n\t\t\t\t}\n\t\t\t}\n\t\t\tnode.addEventListener('click', panTo);\n\t\t\tnode.addEventListener('mouseover', panTo);\n\t\t\t*/\n\t\t});\n\n\t\tconst markerCluster = new MarkerClusterer(this.map, markers, {\n\t\t\timagePath: '/img/store-locator/cluster-',\n\t\t});\n\t\tconst styles = markerCluster.getStyles();\n\t\tstyles.forEach(style => style.textColor = '#ffffff');\n\t\tmarkerCluster.setStyles(styles);\n\t\t// console.log('StoreLocatorCtrl.searchPosition', position, stores);\n\t\tthis.markers = markers;\n\t\tthis.markerCluster = markerCluster;\n\t}\n\n\tgetGeolocation(map) {\n\t\tthis.error = null;\n\t\tthis.busyLocation = true;\n\t\tlet position = this.map.getCenter();\n\t\t// Try HTML5 geolocation.\n\t\tif (navigator.geolocation) {\n\t\t\tnavigator.geolocation.getCurrentPosition((location) => {\n\t\t\t\t// console.log(location.coords);\n\t\t\t\tposition = new google.maps.LatLng(location.coords.latitude, location.coords.longitude);\n\t\t\t\tthis.setInfoWindow(position, 1);\n\t\t\t\tthis.searchPosition(position).finally(() => this.busyLocation = false);\n\t\t\t\tthis.map.setCenter(position);\n\t\t\t\tthis.map.setZoom(ZOOM_LEVEL);\n\t\t\t}, () => {\n\t\t\t\tthis.setInfoWindow(position, 2);\n\t\t\t\tthis.searchPosition(position).finally(() => this.busyLocation = false);\n\t\t\t});\n\t\t} else {\n\t\t\t// Browser doesn't support Geolocation\n\t\t\tthis.setInfoWindow(position, 3);\n\t\t\tthis.searchPosition(position).finally(() => this.busyLocation = false);\n\t\t}\n\t}\n\n\tloadStoresByPosition(position) {\n\t\treturn this.apiService.storeLocator.position(position).then(success => {\n\t\t\tconst stores = success.data;\n\t\t\tthis.stores = stores;\n\t\t\t// console.log('StoreLocatorCtrl.loadStoresByPosition', position, stores);\n\t\t\tthis.addMarkers(stores);\n\t\t});\n\t}\n\n\tloadAllStores() {\n\t\tif (this.stores) {\n\t\t\treturn Promise.resolve(this.stores);\n\t\t}\n\t\treturn this.apiService.storeLocator.all().then(success => {\n\t\t\tconst stores = success.data;\n\t\t\tstores.forEach(store => store.distance = this.calculateDistance(store.latitude, store.longitude, this.position.lat(), this.position.lng(), 'K'));\n\t\t\tthis.addMarkers(stores);\n\t\t\tthis.stores = stores;\n\t\t\treturn stores;\n\t\t});\n\t}\n\n\tfitBounds(stores) {\n\t\tif (stores.length) {\n\t\t\tconst bounds = new google.maps.LatLngBounds();\n\t\t\tstores.forEach((store) => {\n\t\t\t\tconst position = new google.maps.LatLng(store.latitude, store.longitude);\n\t\t\t\tbounds.extend(position);\n\t\t\t});\n\t\t\tthis.map.fitBounds(bounds);\n\t\t\t// console.log('fitBounds');\n\t\t}\n\t}\n\n\tfindNearStores(stores, position, bounds) {\n\t\tlet distance = MAX_DISTANCE; /* Km */\n\t\tif (bounds) {\n\t\t\tconst northEast = bounds.getNorthEast();\n\t\t\tconst meters = google.maps.geometry.spherical.computeDistanceBetween(position, northEast);\n\t\t\tdistance = Math.max(distance, meters / 1000);\n\t\t\tconsole.log('distance', distance);\n\t\t}\n\t\tif (stores) {\n\t\t\tstores.forEach((store) => {\n\t\t\t\tstore.distance = this.calculateDistance(store.latitude, store.longitude, position.lat(), position.lng(), 'K');\n\t\t\t\t// store.visible = (store.cod_stato == window.userCountry || !window.userCountry) && store.distance <= distance;\n\t\t\t\tstore.visible = store.distance <= distance;\n\t\t\t\tif (store.visible) {\n\t\t\t\t\tif (store.removed) this.markerCluster.addMarker(store.marker);\n\t\t\t\t\tdelete store.removed;\n\t\t\t\t} else {\n\t\t\t\t\tthis.markerCluster.removeMarker(store.marker);\n\t\t\t\t\tstore.removed = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tstores = stores.slice();\n\t\t\tstores.sort((a, b) => {\n\t\t\t\treturn a.distance * (a.importante ? 0.5 : 1) - b.distance * (b.importante ? 0.5 : 1);\n\t\t\t});\n\t\t\tconst visibleStores = stores.filter(store => store.visible).slice(0, 50);\n\t\t\tthis.$timeout(() => {\n\t\t\t\tthis.visibleStores = visibleStores;\n\t\t\t}, 1);\n\t\t\t// console.log('findNearStores', visibleStores);\n\t\t\treturn visibleStores;\n\t\t}\n\t}\n\n\tsearchPosition(position, bounds) {\n\t\tlet distance = 0;\n\t\tthis.position = position;\n\t\tif (bounds) {\n\t\t\t// this.map.setCenter(bounds.getCenter(), this.map.getBoundsZoomLevel(bounds)); // getBoundsZoomLevel old api\n\t\t\tthis.map.fitBounds(bounds);\n\t\t} else {\n\t\t\tthis.map.setCenter(position);\n\t\t\tthis.map.setZoom(ZOOM_LEVEL);\n\t\t}\n\t\tthis.setInfoWindow(position, 1);\n\t\treturn this.loadAllStores().then(stores => {\n\t\t\tconst visibleStores = this.findNearStores(stores, position, bounds);\n\t\t\t/*\n\t\t\tif (visibleStores) {\n\t\t\t\tthis.fitBounds(visibleStores);\n\t\t\t}\n\t\t\t*/\n\t\t});\n\t}\n\n\tpanTo(store) {\n\t\tconst position = new google.maps.LatLng(store.latitude, store.longitude);\n\t\tthis.map.setZoom(ZOOM_LEVEL);\n\t\tthis.map.panTo(position);\n\t\tconst marker = this.markers.find(x => x.store === store);\n\t\tthis.setMarkerWindow(marker.position, marker.content);\n\t}\n\n\tonSubmit() {\n\t\tthis.error = null;\n\t\tthis.busyFind = true;\n\t\tconst fakeFilter = {\n\t\t\t'': {\n\t\t\t\tvalue: this.model.address,\n\t\t\t\toptions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: this.model.address,\n\t\t\t\t\t\tkey: this.model.address\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t\tGtmService.pageViewFilters(GTM_CAT, fakeFilter);\n\t\tconst geocoder = this.geocoder || new google.maps.Geocoder();\n\t\tthis.geocoder = geocoder;\n\t\tgeocoder.geocode({ address: this.model.address }, (results, status) => {\n\t\t\tthis.model = {};\n\t\t\tif (status == 'OK') {\n\t\t\t\tconst viewport = results[0].geometry.viewport;\n\t\t\t\t// const position = results[0].geometry.location;\n\t\t\t\tthis.searchPosition(viewport.getCenter(), viewport).finally(() => this.busyFind = false);\n\t\t\t} else {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tconst message = 'Geocode was not successful for the following reason: ' + status;\n\t\t\t\t\t// console.log('StoreLocatorCtrl.onSubmit.error', message);\n\t\t\t\t\tthis.error = { message };\n\t\t\t\t\tthis.busyFind = false;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tsetInfoWindow(position, mode) {\n\t\tif (SHOW_INFO_WINDOW) {\n\t\t\tconst infoWindow = this.infoWindow || new google.maps.InfoWindow();\n\t\t\tthis.infoWindow = infoWindow;\n\t\t\tinfoWindow.setPosition(position);\n\t\t\tswitch (mode) {\n\t\t\t\tcase 1:\n\t\t\t\t\tinfoWindow.setContent('Current location');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tinfoWindow.setContent('Error: The Geolocation service failed.');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tinfoWindow.setContent('Error: Your browser doesn\\'t support geolocation.');\n\t\t\t}\n\t\t\tinfoWindow.open(this.map);\n\t\t}\n\t}\n\n\tsetMarkerWindow(position, content) {\n\t\tif (position) {\n\t\t\tconst markerWindow = this.markerWindow || new google.maps.InfoWindow({\n\t\t\t\tpixelOffset: new google.maps.Size(0, -35)\n\t\t\t});\n\t\t\tthis.markerWindow = markerWindow;\n\t\t\tmarkerWindow.setPosition(position);\n\t\t\tmarkerWindow.setContent(content);\n\t\t\tmarkerWindow.open(this.map);\n\t\t} else {\n\t\t\tif (this.markerWindow) {\n\t\t\t\tthis.markerWindow.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tscrollToStore(store) {\n\t\tconst storesNode = document.querySelector('.section--stores');\n\t\tconst storeNode = document.querySelector(`#store-${store.id_SF}`);\n\t\t// console.log(storesNode, storeNode);\n\t\tstoresNode.scrollTo(0, storeNode.offsetTop);\n\t}\n\n}\n\nStoreLocatorCtrl.$inject = ['$scope', '$timeout', 'DomService', 'ApiService'];\n\nexport default StoreLocatorCtrl;\n","\n\nimport GtmService from '../gtm/gtm.service';\nconst GTM_CAT = 'stores';\n\nclass StoresCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tLocationService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.locationService = LocationService;\n\t\tthis.filters = window.filters || {};\n\t\tthis.stores = window.stores || [];\n\t\tthis.initialFilters = window.initialFilters || null;\n\t\tthis.deserializeFilters(this.initialFilters);\n\t\tthis.applyFilters(false);\n\t}\n\n\tdeserializeFilters(initialFilter) {\n\t\tconst locationFilters = this.locationService.deserialize('filters') || initialFilter || {};\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tswitch (x) {\n\t\t\t\tcase 'collections':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.collections.indexOf(value) !== -1;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'countries':\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.stato === value;\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tfilter.doFilter = (item, value) => {\n\t\t\t\t\t\treturn item.features.indexOf(value) !== -1;\n\t\t\t\t\t};\n\t\t\t}\n\t\t\tfilter.options.unshift({\n\t\t\t\tlabel: this.filters[x].placeholder,\n\t\t\t\tvalue: null,\n\t\t\t});\n\t\t\tconst selectedOption = filter.options.find(o => Boolean(o.value === (locationFilters[x] || null)));\n\t\t\tfilter.value = selectedOption.value;\n\t\t\tfilter.placeholder = selectedOption.label;\n\t\t});\n\t\treturn filters;\n\t}\n\n\tserializeFilters() {\n\t\tlet filters = {};\n\t\tlet any = false;\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tif (filter.value !== null) {\n\t\t\t\tfilters[x] = filter.value;\n\t\t\t\tany = true;\n\t\t\t}\n\t\t});\n\t\tif (!any) {\n\t\t\tfilters = this.initialFilters ? {} : null;\n\t\t}\n\t\t// console.log('StoresCtrl.serializeFilters', filters);\n\t\tthis.locationService.serialize('filters', filters);\n\t\treturn filters;\n\t}\n\n\tapplyFilters(serialize) {\n\t\tif (serialize !== false) this.serializeFilters();\n\t\tconst filters = Object.keys(this.filters).map((x) => this.filters[x]).filter(x => x.value !== null);\n\t\tlet filteredStores = this.stores.slice();\n\t\t// console.log(filteredStores);\n\t\tif (filters.length) {\n\t\t\tfilteredStores = filteredStores.filter(store => {\n\t\t\t\tlet has = true;\n\t\t\t\tfilters.forEach(filter => {\n\t\t\t\t\thas = has && filter.doFilter(store, filter.value);\n\t\t\t\t});\n\t\t\t\treturn has;\n\t\t\t});\n\t\t}\n\t\t// console.log(filteredStores, filters);\n\t\tthis.filteredStores = [];\n\t\tthis.$timeout(() => {\n\t\t\tthis.filteredStores = filteredStores;\n\t\t\tthis.updateFilterStates(filteredStores);\n\t\t\t// delayer for image update\n\t\t}, 50);\n\n\t\tGtmService.pageViewFilters(GTM_CAT, this.filters);\n\t}\n\n\tupdateFilterStates(stores) {\n\t\t// console.log('updateFilterStores', stores);\n\t\tObject.keys(this.filters).forEach(x => {\n\t\t\tconst filter = this.filters[x];\n\t\t\tfilter.options.forEach(option => {\n\t\t\t\tlet has = false;\n\t\t\t\tif (option.value) {\n\t\t\t\t\tlet i = 0;\n\t\t\t\t\twhile (i < stores.length && !has) {\n\t\t\t\t\t\tconst store = stores[i];\n\t\t\t\t\t\thas = filter.doFilter(store, option.value);\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\thas = true;\n\t\t\t\t}\n\t\t\t\toption.disabled = !has;\n\t\t\t});\n\t\t\t// console.log(filter.options);\n\t\t});\n\t}\n\n\tsetFilter(item, filter) {\n\t\titem = item || filter.options[0];\n\t\tfilter.value = item.value;\n\t\tfilter.placeholder = item.label;\n\t\tthis.applyFilters();\n\t\tthis.$scope.$broadcast('onCloseDropdown');\n\t}\n\n\tremoveFilter(filter) {\n\t\tthis.setFilter(null, filter);\n\t}\n\n}\n\nStoresCtrl.$inject = ['$scope', '$timeout', 'LocationService'];\n\nexport default StoresCtrl;\n","\n\nimport { Subject } from \"rxjs\";\nimport { takeUntil } from \"rxjs/operators\";\n\nexport const MOOD_TYPES = Object.freeze({\n\tTile: 1,\n\tHorizontal: 2,\n\tVertical: 3,\n\tCard: 4,\n\tDecor: 5,\n});\n\nexport const ITEMS_PER_PAGE = 20;\n\nclass WishlistCtrl {\n\n\tconstructor(\n\t\t$scope,\n\t\t$timeout,\n\t\tWishlistService\n\t) {\n\t\tthis.$scope = $scope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.wishlistService = WishlistService;\n\t\tthis.items = [];\n\t\tthis.moodTypes = MOOD_TYPES;\n\t\tthis.unsubscribe = new Subject();\n\t\tthis.wishlistService.count$.pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(count => this.count = count);\n\t\t$scope.$on('destroy', () => {\n\t\t\t// console.log('destroy');\n\t\t\tthis.unsubscribe.next();\n\t\t\tthis.unsubscribe.complete();\n\t\t});\n\t\tthis.load();\n\t}\n\n\tload() {\n\t\tthis.wishlistService.get().pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(\n\t\t\tsuccess => {\n\t\t\t\t// console.log('WishlistCtrl.load', success);\n\t\t\t\tif (success) {\n\t\t\t\t\tlet items = success.data.slice();\n\t\t\t\t\tlet wishlist = this.wishlistService.wishlist;\n\n\t\t\t\t\titems.forEach(item => {\n\t\t\t\t\t\tconst index = this.wishlistService.indexOf(item);\n\n\t\t\t\t\t\tif (index >= 0) {\n\t\t\t\t\t\t\titem.name = wishlist[index].name;\n\t\t\t\t\t\t\titem.typeName = wishlist[index].typeName;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t/* FAKE */\n\t\t\t\t\t/*\n\t\t\t\t\twhile (items.length < 200) {\n\t\t\t\t\t\titems = items.concat(items);\n\t\t\t\t\t}\n\t\t\t\t\titems.sort((a, b) => Math.random() > 0.5 ? 1 : -1);\n\t\t\t\t\t*/\n\t\t\t\t\t/* FAKE */\n\t\t\t\t\tthis.items = [];\n\t\t\t\t\tthis.visibleItems = [];\n\t\t\t\t\tthis.maxItems = ITEMS_PER_PAGE;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tthis.items = items;\n\t\t\t\t\t\tthis.visibleItems = items.slice(0, this.maxItems);\n\t\t\t\t\t}, 50);\n\t\t\t\t}\n\t\t\t},\n\t\t\terror => console.log('WishlistCtrl.load.error', error)\n\t\t);\n\t}\n\n\tclearAll() {\n\t\tthis.wishlistService.clearAll().pipe(\n\t\t\ttakeUntil(this.unsubscribe)\n\t\t).subscribe(\n\t\t\tsuccess => {\n\t\t\t\tthis.items = [];\n\t\t\t\tthis.visibleItems = [];\n\t\t\t\tthis.maxItems = ITEMS_PER_PAGE;\n\t\t\t},\n\t\t\terror => console.log('WishlistCtrl.clearAll.error', error)\n\t\t);\n\t}\n\n\tonScroll(event) {\n\t\tif (event.rect.bottom < event.windowRect.bottom) {\n\t\t\t// console.log('more!');\n\t\t\tif (!this.busy && this.maxItems < this.items.length) {\n\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\tthis.busy = true;\n\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\tthis.maxItems += ITEMS_PER_PAGE;\n\t\t\t\t\t\tthis.visibleItems = this.items.slice(0, this.maxItems);\n\t\t\t\t\t\tthis.busy = false;\n\t\t\t\t\t\t// console.log(this.visibleItems.length);\n\t\t\t\t\t}, 1000);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\tprint() {\n\t\treturn window.print();\n\t\t/*\n\t\tconst iframe = document.createElement('iframe');\n\t\tiframe.onload = function() {\n\t\t\tconsole.log('onload');\n\t\t\tthis.contentWindow.print();\n\t\t\tiframe.parentNode.removeChild(iframe);\n\t\t};\n\t\tiframe.style.width = '768px';\n\t\tiframe.src = window.location.href + '?printable';\n\t\tdocument.body.appendChild(iframe);\n\t\t*/\n\t}\n\n}\n\nWishlistCtrl.$inject = ['$scope', '$timeout', 'WishlistService'];\n\nexport default WishlistCtrl;\n","import AdvancedSearchCtrl from './advanced-search/advanced-search.controller';\nimport Collections01Ctrl from './collections/collections-01.controller';\nimport CollectionsCtrl from './collections/collections.controller';\nimport ContactsCtrl from './contacts/contacts.controller';\nimport AppearDirective from './directives/appear.directive';\nimport AutocompleteDirective from './directives/autocomplete.directive';\nimport CookiesDirective from './directives/cookies.directive';\nimport GlslCanvasDirective from './directives/glsl-canvas.directive';\nimport HasDropdownDirective from './directives/has-dropdown.directive';\nimport HilightDirective from './directives/hilight.directive';\nimport HrefDirective from './directives/href.directive';\nimport { LastItemDirective } from './directives/last-item.directive';\nimport LazyScriptDirective from './directives/lazy-script.directive';\nimport LazyDirective from './directives/lazy.directive';\nimport MediaDirective from './directives/media.directive';\nimport { MuuriDirective } from './directives/muuri.directive';\nimport ObjectFitDirective from './directives/object-fit.directive';\nimport OverOnDirective from './directives/over-on.directive';\nimport ParallaxDirective from './directives/parallax.directive';\nimport ScrollToDirective from './directives/scroll-to.directive';\nimport ScrollDirective from './directives/scroll.directive';\nimport StickyDirective from './directives/sticky.directive';\nimport { SwiperFocusDirective, SwiperGalleryDirective, SwiperHeroDirective, SwiperProjectsDirective, SwiperReferencesDirective, SwiperTileDirective, SwiperTimelineDirective } from './directives/swiper.directive';\nimport ThronDirective from './directives/thron.directive';\n// import TransitionDirective from './directives/transition.directive';\nimport VideoDirective from './directives/video.directive';\nimport VisibilityDirective from './directives/visibility.directive';\nimport WishlistDirective from './directives/wishlist.directive';\nimport WorldDirective from './directives/world.directive';\nimport ZoomableDirective from './directives/zoomable.directive';\nimport EffectsCtrl from './effects/effects.controller';\nimport FaqCtrl from './faq/faq.controller';\nimport { ImageWithFeatures } from './filters/image-with-features.filter';\nimport { NotInFilter } from './filters/notIn.filter';\nimport { TrustedFilter } from './filters/trusted.filter';\nimport ControlMessagesDirective from './forms/control-messages.directive';\nimport ControlDirective from './forms/control.directive';\nimport ValidateDirective from './forms/validate.directive';\nimport GalleriesCtrl from './galleries/galleries.controller';\nimport GtmCollectionDirective from './gtm/gtm-collection.directive';\nimport gtmDealerLocatorDirective from './gtm/gtm-dealerlocator.directive';\nimport GtmFormDirective from './gtm/gtm-form.directive';\nimport HighwayDirective from './highway/highway.directive';\nimport MagazineCtrl from './magazine/magazine.controller';\nimport MoodboardDropdownDirective from './moodboard/moodboard-dropdown.directive';\nimport MoodboardSearchDirective from './moodboard/moodboard-search.directive';\nimport MoodboardSectionCtrl from './moodboard/moodboard-section.controller';\nimport MoodboardCtrl from './moodboard/moodboard.controller';\nimport NewsCtrl from './news/news.controller';\nimport ReferencesCtrl from './references/references.controller';\nimport RootCtrl from './root.controller';\nimport ApiService from './services/api.service';\nimport DomService from './services/dom.service';\nimport WishlistService from './services/wishlist.service';\nimport LocationService from './shared/location.service';\nimport PromiseService from './shared/promise.service';\nimport StateService from './shared/state.service';\nimport { CookieService, LocalStorageService, SessionStorageService } from './shared/storage.service';\nimport StoreLocatorCtrl from './store-locator/store-locator.controller';\nimport StoresCtrl from './store-locator/stores.controller';\nimport WishlistCtrl from './wishlist/wishlist.controller';\n\nconst MODULE_NAME = 'app';\n\nconst app = angular.module(MODULE_NAME, ['ngSanitize', 'jsonFormatter']);\n\napp.config(['$locationProvider', function($locationProvider) {\n\t$locationProvider.html5Mode(true).hashPrefix('*');\n}]).config(['$compileProvider', function($compileProvider) {\n\t$compileProvider.debugInfoEnabled(false);\n}]);\n\napp.factory('ApiService', ApiService.factory)\n\t.factory('DomService', DomService.factory)\n\t.factory('LocationService', LocationService.factory)\n\t.factory('PromiseService', PromiseService.factory)\n\t.factory('StateService', StateService.factory)\n\t.factory('CookieService', CookieService.factory)\n\t.factory('LocalStorageService', LocalStorageService.factory)\n\t.factory('SessionStorageService', SessionStorageService.factory)\n\t.factory('WishlistService', WishlistService.factory);\n\napp.directive('appear', AppearDirective.factory)\n\t.directive('control', ControlDirective.factory)\n\t.directive('controlMessages', ControlMessagesDirective.factory)\n\t.directive('cookies', CookiesDirective.factory)\n\t.directive('glslCanvas', GlslCanvasDirective.factory)\n\t.directive('gtmCollection', GtmCollectionDirective.factory)\n\t.directive('gtmDealerLocator', gtmDealerLocatorDirective.factory)\n\t.directive('gtmForm', GtmFormDirective.factory)\n\t.directive('hasDropdown', HasDropdownDirective.factory)\n\t.directive('highway', HighwayDirective.factory)\n\t.directive('hilight', HilightDirective.factory)\n\t.directive('href', HrefDirective.factory)\n\t.directive('lastItem', LastItemDirective.factory)\n\t.directive('lazy', LazyDirective.factory)\n\t.directive('lazyScript', LazyScriptDirective.factory)\n\t.directive('thron', ThronDirective.factory)\n\t.directive('media', MediaDirective.factory)\n\t.directive('moodboardDropdown', MoodboardDropdownDirective.factory)\n\t.directive('moodboardSearch', MoodboardSearchDirective.factory)\n\t.directive('muuri', MuuriDirective.factory)\n\t.directive('parallax', ParallaxDirective.factory)\n\t.directive('objectFit', ObjectFitDirective.factory)\n\t.directive('overOn', OverOnDirective.factory)\n\t.directive('scroll', ScrollDirective.factory)\n\t.directive('scrollTo', ScrollToDirective.factory)\n\t.directive('selectWithAutocomplete', AutocompleteDirective.factory)\n\t.directive('sticky', StickyDirective.factory)\n\t.directive('swiperGallery', SwiperGalleryDirective.factory)\n\t.directive('swiperHero', SwiperHeroDirective.factory)\n\t.directive('swiperFocus', SwiperFocusDirective.factory)\n\t.directive('swiperProjects', SwiperProjectsDirective.factory)\n\t.directive('swiperReferences', SwiperReferencesDirective.factory)\n\t.directive('swiperTile', SwiperTileDirective.factory)\n\t.directive('swiperTimeline', SwiperTimelineDirective.factory)\n\n\t// .directive('transition', TransitionDirective.factory)\n\t.directive('validate', ValidateDirective.factory)\n\t.directive('video', VideoDirective.factory)\n\t.directive('visibility', VisibilityDirective.factory)\n\t.directive('wishlist', WishlistDirective.factory)\n\t.directive('world', WorldDirective.factory)\n\t.directive('zoomable', ZoomableDirective.factory);\n\napp.controller('RootCtrl', RootCtrl)\n\t.controller('AdvancedSearchCtrl', AdvancedSearchCtrl)\n\t.controller('CollectionsCtrl', CollectionsCtrl)\n\t.controller('Collections01Ctrl', Collections01Ctrl)\n\t.controller('EffectsCtrl', EffectsCtrl)\n\t.controller('ContactsCtrl', ContactsCtrl)\n\t.controller('FaqCtrl', FaqCtrl)\n\t.controller('GalleriesCtrl', GalleriesCtrl)\n\t.controller('MagazineCtrl', MagazineCtrl)\n\t.controller('MoodboardCtrl', MoodboardCtrl)\n\t.controller('MoodboardSectionCtrl', MoodboardSectionCtrl)\n\t.controller('NewsCtrl', NewsCtrl)\n\t.controller('ReferencesCtrl', ReferencesCtrl)\n\t.controller('StoreLocatorCtrl', StoreLocatorCtrl)\n\t.controller('StoresCtrl', StoresCtrl)\n\t.controller('WishlistCtrl', WishlistCtrl);\n\napp.filter('imageWithFeatures', [ImageWithFeatures])\n\t.filter('notIn', ['$filter', NotInFilter])\n\t.filter('trusted', ['$sce', TrustedFilter]);\n\n// app.run(['$compile', '$timeout', '$rootScope', function($compile, $timeout, $rootScope) {}]);\n\napp.run(['$compile', '$timeout', '$rootScope', function($compile, $timeout, $rootScope) {\n\t$rootScope.first = true;\n\t$rootScope.firstView = document.querySelector('.view').cloneNode(true);\n\t// console.log('$rootScope.firstView', $rootScope.firstView);\n}]);\n\nexport default MODULE_NAME;\n","\n\n\nexport function ImageWithFeatures() {\n\treturn (images, features) => {\n\t\tif (!images) {\n\t\t\treturn null;\n\t\t}\n\t\tif (!images.length) {\n\t\t\treturn null;\n\t\t}\n\t\tif (images.length === 1 || !features || features[0] === null) {\n\t\t\treturn images[0].url;\n\t\t}\n\t\tconst image = images.find(image => {\n\t\t\tlet has = true;\n\t\t\tfeatures.forEach(f => has = has && image.features.indexOf(f) !== -1);\n\t\t\treturn has;\n\t\t});\n\t\tif (image) {\n\t\t\treturn image.url;\n\t\t} else {\n\t\t\treturn images[0].url;\n\t\t}\n\t};\n}\n","\n\n\nexport function NotInFilter($filter) {\n\treturn (array, filters, element) => {\n\t\tif (filters) {\n\t\t\treturn $filter('filter')(array, (item) => {\n\t\t\t\tfor (var i = 0; i < filters.length; i++) {\n\t\t\t\t\tif (filters[i][element] === item[element]) return false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\t};\n}\n","\n\n\nexport function TrustedFilter($sce) {\n\treturn (url) => {\n\t\treturn $sce.trustAsResourceUrl(url);\n\t};\n}\n","import { default as AppModule } from './app.module.js';\n\n// console.log('bootstrap', document);\n\nangular.bootstrap(document, [AppModule]);\n"]}